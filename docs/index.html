<!doctype html>
<html>

<!-- This tool is licenced under the MIT licence on GitHub:
https://github.com/peterraf/online-xsd-viewer

Copyright (c) 2017-2018 by Peter Raffelsberger (peter@raffelsberger.net)

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
-->

<head>
<TITLE>XML Schema Viewer</TITLE>
<META content="text/html; charset=windows-1252" http-equiv=Content-Type/>
<META name=author content="Peter Raffelsberger"/>
<META name=description content=""/>
<META name=keywords content=""/>
</head>

<style type="text/css">

body {
  font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  font-size: 14px; /*14px*/
  /*line-height: 1.42857143;*/
  background-color: #EDEDED;
  /*color: #C8C8C8;
  background-color: #4c5252;
  height: 100%;
  */
  float1: center;
  margin: 0px; /*10px;*/
  text-align: left; /*center;*/
}

a, p {
  text-align: left;
}

canvas {
  background-color: #FFFFFF;
}

/* Dropdown Content (Hidden by Default) */
div.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f9f9f9;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
}

div.node-details {
  display: none;
  position: absolute;
  background-color: #FFFFFF;
  /*min-width: 160px;*/
  box-shadow: 1px 1px 5px 5px rgba(0,0,0,0.4);  /* oben, rechts, unten, links */
  /*box-shadow: 1px 1px 6px 6px rgba(0,0,0,0.4);  /* oben, rechts, unten, links */
}

INPUT {
  FONT-FAMILY: Verdana,Arial,Helv,Helvetica;
  border-style: solid;
  border-width: 1px;
  border-color: #808080;
  border-radius: 5px;

  height: 22px;
  color: #404040;
  margin: 2px 2px 2px 2px;
  padding: 0px 5px 0px 5px;  /* oben, rechts, unten, links */
  outline-size: 0px;
}

INPUT:hover {
  border-color: #303030;
  color: #000000;
}

INPUT:focus {
  border-color: #303030;
  color: #000000;
  outline-style: none;
}

INPUT.button, a.button {
  border-style: solid;
  border-width: 1px;
  border-color: #808080;

  height: 24px;
  text-decoration: none;
  padding: 5px 15px 5px 15px;  /* oben, rechts, unten, links */
  color: #000000;

  background-color: #FFFFFF;
}

INPUT.button:hover {
  bor-der-color: #303030;
  co-lor: #000000;
  background: linear-gradient(to top, #EDEDED, #C0C0C0);
}

a.button {
  background-color: #FFFF70; /* #EDEDED; */
  cursor: pointer;
  font-weight: bold;
}

a.button:hover {
  background-color: #FFFF20; /* #EDEDED; */
}

p.XSD {
  padding: 0px 12px 4px 12px;  /* oben, rechts, unten, links */
}

textarea {
  font-size: 12px; /*14px*/
}

/*
.inner {
  height: 100%;
}
*/

table {
  border: 0px;
  border-spacing: 0px;
}

table.subtable {
  height: 100%;
}

table.node-details {
  background-color: #FFFFFF;
  border: 2px solid #606060; /*2px solid #606060; #707070;*/
  border-collapse: collapse;
}

tr {
  /*
  font-size: 1px;
  line-height: 1px;
  */
}

tr.horline {
  background-image: url("horline.png");
}

tr.before-node {
  height: 44%;
}

tr.after-node {
  height: 56%;
}

td {
  margin: 0px;
  padding: 0px; /*6px 2px 6px 2px;  /* oben, rechts, unten, links */
  spacing: 0px;
  text-align: left;
  vertical-align: middle;
  /*
  white-space: nowrap;
  background-color: #A0A0A0;
  font-size: 1px;
  line-height: 1px;
  text-align: center;
  */
}

td.nd-column {
  background-color: #808080; /*#808080;*/
  border: 1px solid #B0B0B0;
  color: #E0E0E0;
  font-size: 10px;
  font-weight: bold;
  padding: 1px 4px 1px 3px;  /* oben, rechts, unten, links */
  text-align: center;
  vertical-align: middle;
}

td.nd-name {
  background-color: #FFFF80;
  border: 1px solid #B0B0B0;
  color: #000000; /*#404040;#000090;*/
  font-size: 11pt;
  font-weight: bold;
  padding: 1px 10px 1px 6px;  /* oben, rechts, unten, links */
  text-align: left;
  vertical-align: top;
  /*width: 80%;*/
}

td.nd-count {
  background-color: #FFFF80;
  border: 1px solid #B0B0B0;
  color: #303030; /*#404040;#000090;*/
  font-size: 11pt;
  font-weight: bold;
  padding: 1px 8px 1px 6px;  /* oben, rechts, unten, links */
  text-align: right;
  vertical-align: top;
  /*width: 10%;*/
}

td.nd-attr {
  background-color: #FFFF80;
  border: 1px solid #B0B0B0;
  color: #303030; /*#606060;*/
  font-size: 12px; /*9pt;*/
  /*line-height: 8pt;*/
  padding: 3px 10px 2px 6px;  /* oben, rechts, unten, links */
  text-align: left;
  vertical-align: top;
}

td.nd-type {
  background-color: #FFFFFF;
  border: 1px solid #B0B0B0;
  color: #282828; /*#202020;#000000;*/
  font-size: 11px; /*8pt;*/
  font-weight: bold;
  padding: 3px 10px 2px 6px;  /* oben, rechts, unten, links */
  text-align: left;
  vertical-align: top;
}

td.nd-pattern {
  background-color: #FFFFFF;
  border: 1px solid #B0B0B0;
  color: #282828; /*#202020;#000000;*/
  font-size: 11px; /*8pt;*/
  font-weight: bold;
  padding: 3px 10px 2px 6px;  /* oben, rechts, unten, links */
  text-align: left;
  vertical-align: top;
}

td.nd-anno {
  background-color: #FFFFFF;
  border: 1px solid #B0B0B0;
  color: #006000; /*#282828;#202020;#000000;*/
  font-size: 12px; /*11px;*/
  /*font-style: italic;*/
  font-weight: bold;
  line-height: 14px; /*13px;*/
  padding: 4px 10px 3px 6px;  /* oben, rechts, unten, links */
  text-align: left;
  vertical-align: top;
}

td.nd-enum {
  background-color: #FFFFFF;
  border: 1px solid #B0B0B0;
  color: #383838; /*#202020;#000000;*/
  font-size: 11px; /*8pt;*/
  font-weight: bold;
  line-height: 13px;
  padding: 4px 10px 3px 6px;  /* oben, rechts, unten, links */
  text-align: left;
  vertical-align: top;
}

td.nd-xpath {
  background-color: #E0E0E0; /*#E4E4E4;#EDEDED;*/
  border: 1px solid #B0B0B0;
  color: #282828; /*#202020;#000000;*/
  font-size: 11px; /*8pt;*/
  font-weight: bold;
  max-width: 300px;
  padding: 3px 10px 2px 6px;  /* oben, rechts, unten, links */
  text-align: left;
  overflow: hidden;
  vertical-align: top;
}

td.nd-xpath:hover {
  overflow: visible;
}

td.node {
  /*
  font-size: 10pt;
  line-height: 1px;
  */
  width: 1%;
}

td.hor-line-old {
  font-size: 1px;
  line-height: 1px;
  width: 40%;
}

td.image {
  border-spacing: 0;
  height: 1px;
  font-size: 1px;
  line-height: 1px;
  max-height: 1px;
  margin: 0;
  padding: 0;
}

td.horline {
  /*background-image: url("horline.png");*/
  min-width: 14px;
  width1: 40%;
}

td.leftline {
  background-image: url("leftline.png");
}

td.text {
  font-size: 10pt;
  line-height: 12pt;
}

td.subtable {
  /*display: block;*/
  height: 100%;
}

div.node-mand {
  border-style: solid;
  border-width: 1px;
  border-color: #000000;

  color: #000000;
  /*height: 23px;*/
  font-size: 9pt;
  font-weight: bold;
  padding: 3px 6px 1px 5px;  /* oben, rechts, unten, links */
  text-decoration: none;
  width1: 5%;

  background-color: #EDEDED;
}

select.version {
  margin: 3px 16px 3px 16px;  /* oben, rechts, unten, links */
  padding: 5px 8px 4px 8px;  /* oben, rechts, unten, links */
}

option.version {
  /*height: 60px;*/
  /*line-height: 200%;*/
  margin: 4px 6px 3px 5px;  /* oben, rechts, unten, links */
  padding: 4px 6px 3px 5px;  /* oben, rechts, unten, links */
}

/*
#multiple option {
  padding: 80px;
}
*/

p.bottom-line {
  background-color: #404040; /*#606060;*/
  color: #808080; /*#A0A0A0;*/
  font-size: 9pt;
  font-weight: bold;
  margin: 0px;
  padding: 4px 8px 3px 8px;  /* oben, rechts, unten, links */
}

a.bottom-line {
  /*background-color: #404040; /*#606060;*/
  color: #808080; /*#A0A0A0;*/
  text-decoration: none;
  font-size: 9pt;
  font-weight: bold;
  margin: 0px;
  padding: 4px 8px 3px 8px;  /* oben, rechts, unten, links */
}

a.bottom-line:hover {
  color: #D0D0D0; /*#A0A0A0;*/
}

fieldset {
  background-color: #606060; /*#404040;*/
  border: 0px;
  margin: 0px;
  padding: 1px 5px 0px 5px;  /* oben, rechts, unten, links */
}

label {
  /*background-color: #606060; /*#404040;*/
  color: #E0E0E0; /*#E0E0E0;*/
  cursor: pointer;
  /*height: 25px;*/
  /*min-height: 25px;*/
  margin: 1px;
  padding: 3px 15px 3px 15px;  /* oben, rechts, unten, links */
  vertical-align: middle;
}

label.search {
  cursor: text;
  /*vertical-align: bottom;*/
}

input {
  background-color: #EDEDED;
  color: #000000;
  cursor: pointer;
  margin: 2px;
}

input[type="checkbox"] {
  background-color: #FFFFFF;
  vertical-align: bottom;
}

input.search-text {
  cursor: text;
  margin: 2px 1px 2px 2px;  /* oben, rechts, unten, links */
}

input.search-button {
  background-color: #C0C0C0;
  color: #000000;
  font-size: 8pt;
  /*font-weight: bold;*/
  text-align: center;
}

a.search-button {
  background-color: #C0C0C0;
  border-color: #808080;
  border-radius: 5px;
  color: #404040;
  font-size: 8pt;
  font-weight: bolder;
  height: 22px;
  margin: 2px;
  padding: 5px 9px 5px 9px;  /* oben, rechts, unten, links */
  text-align: center;
  text-decoration: none;
  vertical-align: middle;
}

a.search-button:hover {
  background-color: #C0C0C0;
  border-color: #000000;
  color: #202020;
}

div.search-result {
  background-color: #484848; /*#606060; /*#404040;*/
  border: 0px;
  display: none;
  margin: 0px;
  padding: 4px 4px 4px 4px;  /* oben, rechts, unten, links */
}

table.search-result {
  color: #C0C0C0; /*#B8B8B8;*/
  font-size: 10pt;
  line-height: 13pt;
  /*color: #B0B0B0;
  font-size: 13px; /*10pt;* /
  font-weight: bold;
  line-height: 12pt; /*13pt;*/
  width: 100%;
}

tr.search-result {
  background-color: #606060; /*#E4E4E4;#EDEDED;*/
  cursor: pointer;
  /*padding: 3px 10px 2px 6px;  /* oben, rechts, unten, links */
}

tr.search-result:nth-child(even) {background: #606060; }
tr.search-result:nth-child(odd) {background: #545454; } /*#686868;*/

tr.search-result:hover {
  background-color: #484848; /*#505050;*/
  color: #F0F0C0; /*#C0C0C0;*/
}

td.xpath {
  padding: 0px 5px 0px 5px;  /* oben, rechts, unten, links */
}

</style>


<body onload="SampleSchema(); LoadSchema();">

  <p class="XSD" id="LoadSchemaParagraph">
    <b>XML Schema Definition:</b><br>
    <textarea id="schema-text" name="xml-schema" rows="50" cols="200"></textarea>
    <br>
    <a class="button" href1="" id="LoadSchemaButton" onclick="LoadSchema();">View Schema</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <a class="button" href1="" id="SampleSchema" onclick="SampleSchema();">BG.SAF-T.Schema.xsd</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <code id="Status" style="display: none;"></code>
  </p>

  <fieldset id="SchemaOptions" style="display: none;">
    <label><input type="checkbox" id="cbAnnotations" onclick="AnnotationChanged();" value="1" checked> Annotations</label>
    <label><input type="checkbox" id="cbTypeInfo" onclick="TypeInfoChanged();" value="1" checked> Type Info</label>
    &nbsp;&nbsp;&nbsp;
    <label class="search">
      <input class="search-text" id="SearchText" value=""><input class="search-button" id="SearchButton" onclick="SearchButtonPressed();" value="SEARCH" size="5" readonly><input class="search-button" id="SearchReset" onclick="SearchResetPressed();" value="RESET" size="4" readonly>
    </label>
  </fieldset>

  <div class="search-result" id="SearchResultDiv" style="height: 152px; overflow: scroll;">
    <table class="search-result">
      <tr class="search-result" onclick="SearchResultClicked(0);"><td class="xpath" id="SearchResult1">XPath-1</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(1);"><td class="xpath" id="SearchResult2">XPath-2</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(2);"><td class="xpath" id="SearchResult3">XPath-3</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(3);"><td class="xpath" id="SearchResult4">XPath-4</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(4);"><td class="xpath" id="SearchResult5">XPath-5</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(5);"><td class="xpath" id="SearchResult6">XPath-6</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(6);"><td class="xpath" id="SearchResult7">XPath-7</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(7);"><td class="xpath" id="SearchResult8">XPath-8</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(8);"><td class="xpath" id="SearchResult9">XPath-9</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(9);"><td class="xpath" id="SearchResult10">XPath-10</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(10);"><td class="xpath" id="SearchResult11">XPath-11</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(11);"><td class="xpath" id="SearchResult12">XPath-12</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(12);"><td class="xpath" id="SearchResult13">XPath-13</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(13);"><td class="xpath" id="SearchResult14">XPath-14</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(14);"><td class="xpath" id="SearchResult15">XPath-15</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(15);"><td class="xpath" id="SearchResult16">XPath-16</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(16);"><td class="xpath" id="SearchResult17">XPath-17</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(17);"><td class="xpath" id="SearchResult18">XPath-18</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(18);"><td class="xpath" id="SearchResult19">XPath-19</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(19);"><td class="xpath" id="SearchResult20">XPath-20</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(20);"><td class="xpath" id="SearchResult21">XPath-21</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(21);"><td class="xpath" id="SearchResult22">XPath-22</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(22);"><td class="xpath" id="SearchResult23">XPath-23</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(23);"><td class="xpath" id="SearchResult24">XPath-24</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(24);"><td class="xpath" id="SearchResult25">XPath-25</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(25);"><td class="xpath" id="SearchResult26">XPath-26</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(26);"><td class="xpath" id="SearchResult27">XPath-27</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(27);"><td class="xpath" id="SearchResult28">XPath-28</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(28);"><td class="xpath" id="SearchResult29">XPath-29</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(29);"><td class="xpath" id="SearchResult30">XPath-30</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(30);"><td class="xpath" id="SearchResult31">XPath-31</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(31);"><td class="xpath" id="SearchResult32">XPath-32</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(32);"><td class="xpath" id="SearchResult33">XPath-33</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(33);"><td class="xpath" id="SearchResult34">XPath-34</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(34);"><td class="xpath" id="SearchResult35">XPath-35</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(35);"><td class="xpath" id="SearchResult36">XPath-36</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(36);"><td class="xpath" id="SearchResult37">XPath-37</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(37);"><td class="xpath" id="SearchResult38">XPath-38</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(38);"><td class="xpath" id="SearchResult39">XPath-39</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(39);"><td class="xpath" id="SearchResult40">XPath-40</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(40);"><td class="xpath" id="SearchResult41">XPath-41</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(41);"><td class="xpath" id="SearchResult42">XPath-42</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(42);"><td class="xpath" id="SearchResult43">XPath-43</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(43);"><td class="xpath" id="SearchResult44">XPath-44</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(44);"><td class="xpath" id="SearchResult45">XPath-45</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(45);"><td class="xpath" id="SearchResult46">XPath-46</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(46);"><td class="xpath" id="SearchResult47">XPath-47</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(47);"><td class="xpath" id="SearchResult48">XPath-48</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(48);"><td class="xpath" id="SearchResult49">XPath-49</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(49);"><td class="xpath" id="SearchResult50">XPath-50</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(50);"><td class="xpath" id="SearchResult51">XPath-51</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(51);"><td class="xpath" id="SearchResult52">XPath-52</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(52);"><td class="xpath" id="SearchResult53">XPath-53</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(53);"><td class="xpath" id="SearchResult54">XPath-54</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(54);"><td class="xpath" id="SearchResult55">XPath-55</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(55);"><td class="xpath" id="SearchResult56">XPath-56</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(56);"><td class="xpath" id="SearchResult57">XPath-57</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(57);"><td class="xpath" id="SearchResult58">XPath-58</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(58);"><td class="xpath" id="SearchResult59">XPath-59</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(59);"><td class="xpath" id="SearchResult60">XPath-60</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(60);"><td class="xpath" id="SearchResult61">XPath-61</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(61);"><td class="xpath" id="SearchResult62">XPath-62</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(62);"><td class="xpath" id="SearchResult63">XPath-63</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(63);"><td class="xpath" id="SearchResult64">XPath-64</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(64);"><td class="xpath" id="SearchResult65">XPath-65</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(65);"><td class="xpath" id="SearchResult66">XPath-66</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(66);"><td class="xpath" id="SearchResult67">XPath-67</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(67);"><td class="xpath" id="SearchResult68">XPath-68</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(68);"><td class="xpath" id="SearchResult69">XPath-69</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(69);"><td class="xpath" id="SearchResult70">XPath-70</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(70);"><td class="xpath" id="SearchResult71">XPath-71</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(71);"><td class="xpath" id="SearchResult72">XPath-72</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(72);"><td class="xpath" id="SearchResult73">XPath-73</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(73);"><td class="xpath" id="SearchResult74">XPath-74</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(74);"><td class="xpath" id="SearchResult75">XPath-75</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(75);"><td class="xpath" id="SearchResult76">XPath-76</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(76);"><td class="xpath" id="SearchResult77">XPath-77</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(77);"><td class="xpath" id="SearchResult78">XPath-78</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(78);"><td class="xpath" id="SearchResult79">XPath-79</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(79);"><td class="xpath" id="SearchResult80">XPath-80</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(80);"><td class="xpath" id="SearchResult81">XPath-81</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(81);"><td class="xpath" id="SearchResult82">XPath-82</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(82);"><td class="xpath" id="SearchResult83">XPath-83</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(83);"><td class="xpath" id="SearchResult84">XPath-84</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(84);"><td class="xpath" id="SearchResult85">XPath-85</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(85);"><td class="xpath" id="SearchResult86">XPath-86</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(86);"><td class="xpath" id="SearchResult87">XPath-87</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(87);"><td class="xpath" id="SearchResult88">XPath-88</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(88);"><td class="xpath" id="SearchResult89">XPath-89</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(89);"><td class="xpath" id="SearchResult90">XPath-90</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(90);"><td class="xpath" id="SearchResult91">XPath-91</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(91);"><td class="xpath" id="SearchResult92">XPath-92</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(92);"><td class="xpath" id="SearchResult93">XPath-93</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(93);"><td class="xpath" id="SearchResult94">XPath-94</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(94);"><td class="xpath" id="SearchResult95">XPath-95</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(95);"><td class="xpath" id="SearchResult96">XPath-96</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(96);"><td class="xpath" id="SearchResult97">XPath-97</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(97);"><td class="xpath" id="SearchResult98">XPath-98</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(98);"><td class="xpath" id="SearchResult99">XPath-99</td></tr>
      <tr class="search-result" onclick="SearchResultClicked(99);"><td class="xpath" id="SearchResult100">XPath-100</td></tr>
      <tr class="search-result"><td class="xpath" id="TooManyResults">Too many results found</td></tr>
    </table>
  </div>

  <div id="canvas-container" style="height: 750px; overflow: scroll; display: none;">
    <canvas id="tree" width="4096" height="4096" style="border:1px solid #000000; background-color: #EDEDED;">Your browser does not support canves :-(</canvas>
    <!--div id="node-details" class="nodedetails">Line One is longer then the rest<br />Line Two is shorter<br />Line Three <br />Line Four is medium length</div-->
    <div id="node-details" class="node-details">
      <table class="node-details">
        <tr><td class="nd-column">Name</td><td class="nd-name" id="nd-name">SampleNodeName</td></tr>
        <tr><td class="nd-column">Attr</td><td class="nd-attr" id="nd-attr"><b>AttrOne:</b> TypeInfo<br/><b>AttributeTwo:</b> TypeInfo</td></tr>
        <tr><td class="nd-column">Type</td><td class="nd-type" id="nd-type">Type Description</td></tr>
        <tr><td class="nd-column">Pattern</td><td class="nd-pattern" id="nd-pattern">Pattern</td></tr>
        <tr><td class="nd-column">Descr</td><td class="nd-anno" id="nd-anno">First line of annotation text<br/>second line of annotation text<br/>third line</td></tr>
        <tr><td class="nd-column">Enum</td><td class="nd-enum" id="nd-enum">FIRST<br/>SECOND<br/>THIRD<br/>FOURTH</td></tr>
        <tr><td class="nd-column">XPath</td><td class="nd-xpath" id="nd-xpath">/FundsXML4/Funds/Fund/FundDynamicData/TotalAssetValues/TotalAssetValue</td></tr>
      </table>
    </div>
  </div>

  <p id="trace" style="display: none; margin: 0px;"></p>

  <p class="bottom-line" id="BottomLineParagraph">Written by Peter Raffelsberger (contact: info@xml-tools.net)
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="bottom-line" href="https://github.com/peterraf/online-xsd-viewer" target="_blank">Published on GitHub unter MIT-Licence</a>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Press F5 to view another schema
  </p>

</body>


<script language="JavaScript">

  var loadSchemaParagraph = document.getElementById('LoadSchemaParagraph');
  var loadSchemaButton = document.getElementById('LoadSchemaButton');
  var schemaOptions = document.getElementById('SchemaOptions');
  var searchText = document.getElementById('SearchText');
  var lastSearchText = '';
  var searchResetButton = document.getElementById('SearchReset');
  var openNewWindow = document.getElementById('OpenNewWindow');
  var searchResultDiv = document.getElementById('SearchResultDiv');
  var firstSearchResult = document.getElementById('SearchResult1');
  var tooManyResults = document.getElementById('TooManyResults');
  var statusText = document.getElementById('Status');
  var canvasContainer = document.getElementById('canvas-container');
  var tracePar = document.getElementById('trace');
  var bottomLineParagraph = document.getElementById('BottomLineParagraph');

  var Nodes = new Array();
  //Nodes.push({name: 'FundsXML4', left: 0, top: 0, right: 0, bottom: 0});
  var ComplexTypes = new Array();
  var SimpleTypes = new Array();
  var SearchResults = new Array();

  var rootNodeIndex = null;
  var bResolveComplexTypes = false;

  var NodeTypeComplex = 1;
  var NodeTypeSimple = 2;
  var NodeTypeSequence = 3;
  var NodeTypeChoice = 4;
  var NodeTypeString = 5;
  var NodeTypeNumber = 6;
  var NodeTypeInteger = 7;
  var NodeTypeDate = 8;
  var NodeTypeDateTime = 9;
  var NodeTypeBoolean = 10;

  var NodeTypeNames = ["", "Complex", "Simple", "Sequence", "Choice", "String", "Number", "Integer", "Date", "DateTime", "Boolean"];

  var nMaxSearchResults = 100;
  var bTooManySearchResults = false;

  searchResetButton.style.display = "none";

  if (window != window.top)
    openNewWindow.style.display = "inline-block";


  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Schema functions


  function IsRealNode(nodeType)
  {
    var result = true;
    if (nodeType == NodeTypeChoice || nodeType == NodeTypeSequence)
      result = false;
    return result;
  }


  function GetFirstChildNode(parentNode, nodeName)
  {
    var result;
    var childNodes = parentNode.childNodes;
    var i = 0;

    while (i < childNodes.length && !result)
      if (childNodes[i].nodeName == nodeName)
        result = childNodes[i];
      else
        i++;

    return result;
  }


  function ShowChildNodes(parentNode)
  {
    var childNodes = parentNode.childNodes;
    var txt = "ChildNodes: <br>";

    for (i = 0; i < childNodes.length; i++)
      txt += "Nodename: " + childNodes[i].nodeName + " (nodetype: " + childNodes[i].nodeType + ") <br>";

    tracePar.innerHTML = txt;
  }


  /*
  <xs:element name="FundsXML4">
    <xs:annotation>
      <xs:documentation>Root element of FundsXML V4</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:sequence>
        <xs:element name="ControlData" type="ControlDataType">
        <xs:annotation>
          <xs:documentation>Meta data of xml document (like unique id, date, data supplier, language, ...)</xs:documentation>
        </xs:annotation>
    ...
  </xs:element>

  <xs:complexType name="FundType">
    <xs:sequence>
      <xs:element name="Identifiers" type="IdentifiersType">
        <xs:annotation>
          <xs:documentation>Identifiers of fund</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="Names" type="NamesType">
        <xs:annotation>
          <xs:documentation>Names of fund</xs:documentation>
        </xs:annotation>
      </xs:element>

	<xs:complexType name="CountrySpecificDataATType">
		<xs:complexContent>
			<xs:extension base="xs:anyType"/>
		</xs:complexContent>
	</xs:complexType>
  */

  function ParseComplexTypeNode(node, parentIndex)
  {
    //Nodes[parentIndex].type = NodeTypeComplex;

    var childNodes = node.childNodes;
    var nodeName;
    var previousIndex = null;
    var nodeIndex = null;
    var i = null;

    for (i = 0; i < childNodes.length; i++) {
      if (childNodes[i].nodeType == 1) {
        nodeName = childNodes[i].nodeName;
        /*if (nodeName == "xs:annotation") {
          // todo
        }*/
        if (nodeName == "xs:choice" || nodeName == "xs:sequence") {
          previousIndex = nodeIndex;
          nodeIndex = AddNode(childNodes[i], parentIndex, previousIndex);
          if (parentIndex != null && previousIndex == null)
            Nodes[parentIndex].firstChildIndex = nodeIndex;
          if (previousIndex != null)
            Nodes[previousIndex].nextIndex = nodeIndex;
        }
        if (nodeName == "xs:complexContent") {
          var extensionNode = GetFirstChildNode(childNodes[i], "xs:extension");
          if (extensionNode) {
            Nodes[parentIndex].baseTypeName = extensionNode.getAttribute("base");
          }
        }
      }
    }
  }


  function ParseSequenceNode(node, parentIndex)
  {
    var childNodes = node.childNodes;
    var previousIndex = null;
    var nodeIndex = null;
    var i = null;

    for (i = 0; i < childNodes.length; i++) {
      if (childNodes[i].nodeType == 1) {
        previousIndex = nodeIndex;
        nodeIndex = AddNode(childNodes[i], parentIndex, previousIndex);
        if (parentIndex != null && previousIndex == null)
          Nodes[parentIndex].firstChildIndex = nodeIndex;
        if (previousIndex != null)
          Nodes[previousIndex].nextIndex = nodeIndex;
      }
    }
  }


  function StrLen(text)
  {
    var result = 0;
    var vt = typeof value;

    if (vt == 'string')
      result = Number(text.length);

    return result;
  }


  function ToNumber(value, default_value)
  {
    var result;
    var vt = typeof value;

    if (vt == 'number' || vt == 'string')
      result = Number(value);
    else
      result = default_value;

    return result;
  }


  function ToNumberUnbounded(value, default_value)
  {
    var result;

    if (value == 'unbounded')
      result = -1;
    else {
      var vt = typeof value;
      if (vt == 'number' || vt == 'string')
        result = Number(value);
      else
        result = default_value;
    }

    return result;
  }


  /*
  <xs:simpleType>
    <xs:restriction base="xs:string">
      <xs:enumeration value="AssetMasterData"/>

	<xs:simpleType name="ISOCurrencyCodeType">
		<xs:annotation>
			<xs:documentation xml:lang="en">Three-letter ISO-CurrencyCode (ISO 4217)</xs:documentation>
			<xs:documentation xml:lang="de">Dreistelliger ISO-Waehrungscode (ISO 4217)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:maxLength value="3"/>
			<xs:minLength value="3"/>
			<xs:pattern value="[A-Z]{3}"/>
		</xs:restriction>
	</xs:simpleType>

	<xs:element name="DataOperation" minOccurs="0">
		<xs:annotation>
			<xs:documentation>Initial, Amend, Delete</xs:documentation>
		</xs:annotation>
		<xs:simpleType>
			<xs:restriction base="xs:string">
				<xs:minLength value="5"/>
				<xs:maxLength value="7"/>
				<xs:enumeration value="INITIAL"/>
				<xs:enumeration value="AMEND"/>
				<xs:enumeration value="DELETE"/>
			</xs:restriction>
		</xs:simpleType>
	</xs:element>

  <xs:element name="UnlistedType">
    <xs:annotation>
      <xs:documentation>Description of other document types</xs:documentation>
    </xs:annotation>
    <xs:simpleType>
      <xs:restriction base="Text128Type">
        <xs:minLength value="1"/>
      </xs:restriction>
    </xs:simpleType>
  </xs:element>
  */

  function ParseSimpleTypeNode(node, destIndex)
  {
    var internalNodeName;
    var restrictionNode = GetFirstChildNode(node, "xs:restriction");

    internalNodeName = Nodes[destIndex].name;
    if (internalNodeName == "AssetTypeType")
      internalNodeName = "";

    if (restrictionNode) {
      Nodes[destIndex].baseTypeName = restrictionNode.getAttribute("base");
      Nodes[destIndex].enumeration = new Array();
      var childNodes = restrictionNode.childNodes;

      for (i = 0; i < childNodes.length; i++)
        if (childNodes[i].nodeType == 1) {
          internalNodeName = childNodes[i].nodeName;
          if (internalNodeName == "xs:minLength")
            Nodes[destIndex].minLength = childNodes[i].getAttribute("value");
          if (internalNodeName == "xs:maxLength")
            Nodes[destIndex].maxLength = childNodes[i].getAttribute("value");
          if (internalNodeName == "xs:pattern")
            Nodes[destIndex].pattern = childNodes[i].getAttribute("value");
          if (internalNodeName == "xs:enumeration")
            Nodes[destIndex].enumeration.push(childNodes[i].getAttribute("value"));
        }
    }
  }


  /*
	<xs:element name="Amount" maxOccurs="unbounded">
		<xs:annotation>
			<xs:documentation xml:lang="en">Amounts in currency as defined in attribute</xs:documentation>
			<xs:documentation xml:lang="de">Betrag in frei waehlbarer Waehrung</xs:documentation>
		</xs:annotation>
		<xs:complexType>
			<xs:simpleContent>
				<xs:extension base="xs:decimal">
					<xs:attribute name="ccy" type="ISOCurrencyCodeType" use="required"/>
					<xs:attribute name="isfundccy" type="xs:boolean"/>
					<xs:attribute name="issubfundccy" type="xs:boolean"/>
					<xs:attribute name="isshareclassccy" type="xs:boolean"/>
				</xs:extension>
			</xs:simpleContent>
		</xs:complexType>
	</xs:element>
  */

  function ParseSimpleContentNode(node, destIndex)
  {
    var internalNodeName;
    var extensionNode = GetFirstChildNode(node, "xs:extension");

    if (extensionNode) {
      Nodes[destIndex].baseTypeName = extensionNode.getAttribute("base");
      Nodes[destIndex].attributes = new Array();
      var childNodes = extensionNode.childNodes;

      for (i = 0; i < childNodes.length; i++)
        if (childNodes[i].nodeType == 1) {
          internalNodeName = childNodes[i].nodeName;
          if (internalNodeName == "xs:attribute") {
            var attribute = new Object();
            attribute.name = childNodes[i].getAttribute("name");
            attribute.type = childNodes[i].getAttribute("type");
            attribute.use = childNodes[i].getAttribute("use");  // mandatory attribute: use="required"
            Nodes[destIndex].attributes.push(attribute);
          }
        }
    }
  }


	function UpdateTypeDescription(nodeIndex)
	{
    var typeDescription;

    if (Nodes[nodeIndex].typeName)
      typeDescription = Nodes[nodeIndex].typeName;

    if (Nodes[nodeIndex].baseTypeName) {
			if (typeDescription)
			  typeDescription += ":  " + Nodes[nodeIndex].baseTypeName;
			else
				typeDescription = Nodes[nodeIndex].baseTypeName;

			var minLength = Nodes[nodeIndex].minLength;
      var maxLength = Nodes[nodeIndex].maxLength;

      if (minLength)
        if (maxLength)
          if (minLength == maxLength)
            typeDescription += " (" + maxLength + " chars)";
          else
            typeDescription += " (" + minLength + "-" + maxLength + " chars)";
        else
          typeDescription += " (min " + minLength + " chars)";
      else
        if (maxLength)
          typeDescription += " (max " + maxLength + " chars)";
      /*
			if (Nodes[nodeIndex].pattern)
        typeDescription += " " + Nodes[nodeIndex].pattern;
      */
    }

    if (typeDescription) {
      var minOccurs = Nodes[nodeIndex].minOccurs;
      var maxOccurs = Nodes[nodeIndex].maxOccurs;
      /*
      if (maxOccurs == "1")
        if (minOccurs == "0")
          typeDescription += "  [optional]";
        else
          typeDescription += "  [mandatory]";
      else
      */
      if (maxOccurs != "1")
        if (minOccurs == maxOccurs)
          typeDescription += "  [" + maxOccurs + "]";
        else
          if (maxOccurs > 0)
            typeDescription += "  [" + minOccurs + "..." + maxOccurs + "]";
          else
            typeDescription += "  [" + minOccurs + "...unbound]";  // "...&#8734;]";  // "...&infin;]";
    }

    Nodes[nodeIndex].typeDescription = typeDescription;
	}


  function AddNode(node, parentIndex, previousIndex)
  {
    var mynode = new Object();
    var complexTypeNode;

    mynode.parentIndex = parentIndex;
    mynode.previousIndex = previousIndex;

    var internalNodeName = node.nodeName;

    if (internalNodeName == "xs:choice") {
      mynode.type = NodeTypeChoice;
    }

    if (internalNodeName == "xs:sequence") {
      mynode.type = NodeTypeSequence;
    }

    if (internalNodeName == "xs:element") {
      mynode.name = node.getAttribute("name");
      mynode.typeName = node.getAttribute("type");
      mynode.minOccurs = ToNumber(node.getAttribute("minOccurs"), 1);
      mynode.maxOccurs = ToNumberUnbounded(node.getAttribute("maxOccurs"), 1);  // 'unbounded'
      if (mynode.typeName && mynode.typeName.length > 0 && mynode.typeName.substr(0, 3) != "xs:")
        mynode.type = NodeTypeComplex;
    }

    //mynode.annotation = null;
    mynode.firstChildIndex = null;
    mynode.expanded = false;
    mynode.showAttributes = true;

    var annotationNode = GetFirstChildNode(node, "xs:annotation");
    if (annotationNode) {
      mynode.annotation = "Trace-1";
      docNode = GetFirstChildNode(annotationNode, "xs:documentation");
      if (docNode) {
        mynode.annotation = "Trace-2";
        mynode.annotation = docNode.textContent;   //.nodeValue;
      }
    }

    var nodeIndex = Nodes.length;
    Nodes.push(mynode);

    /*
    if (mynode.name == "UnlistedType")
      var i = 0;
    */

    if (!mynode.typeName) {
      var simpleTypeNode = GetFirstChildNode(node, "xs:simpleType");
      if (simpleTypeNode)
        ParseSimpleTypeNode(simpleTypeNode, nodeIndex);
    }

    if (!mynode.typeName) {
      complexTypeNode = GetFirstChildNode(node, "xs:complexType");
      if (complexTypeNode) {
        var simpleContentNode = GetFirstChildNode(complexTypeNode, "xs:simpleContent");
        if (simpleContentNode)
          ParseSimpleContentNode(simpleContentNode, nodeIndex);
      }
    }

		UpdateTypeDescription(nodeIndex);

    if (Nodes.length < 100000) {
      if (mynode.type == NodeTypeChoice || mynode.type == NodeTypeSequence)
        ParseSequenceNode(node, nodeIndex);
      else {
        if (!mynode.typeName) {
          complexTypeNode = GetFirstChildNode(node, "xs:complexType");
          if (complexTypeNode) {
            Nodes[nodeIndex].type = NodeTypeComplex;
            ParseComplexTypeNode(complexTypeNode, nodeIndex);
          }
        }
      }

      if (bResolveComplexTypes && !Nodes[nodeIndex].firstChildIndex) {
        if (mynode.type == NodeTypeComplex && mynode.typeName && mynode.typeName.length > 0)
          ResolveComplexType(nodeIndex);
        if (mynode.baseTypeName && mynode.baseTypeName.length > 0)
          ResolveSimpleBaseType(nodeIndex);
      }
    }

    return nodeIndex;
  }


  function XPath(nodeIndex)
  {
    var result = "";
    var nodeType = Nodes[nodeIndex].type;
    if (nodeType != NodeTypeChoice && nodeType != NodeTypeSequence)
      result = "/" + Nodes[nodeIndex].name;
    var parentIndex = Nodes[nodeIndex].parentIndex;
    if (parentIndex)
      result = XPath(parentIndex) + result;
    return result;
  }


  function TypeNameUsedAbove(nodeIndex, typeName)
  {
    var result = false;
    var parentIndex = Nodes[nodeIndex].parentIndex;

    /*
    if (parentIndex) {
      if (Nodes[parentIndex].typeName == typeName)
        result = true;
      else
        result = TypeNameUsedAbove(parentIndex, typeName);
    }*/

    while (parentIndex && !result) {
      if (Nodes[parentIndex].typeName == typeName)
        result = true;
      else
        parentIndex = Nodes[parentIndex].parentIndex;
    }

    return result;
  }


  function SetNodesExpanded(nNodeIndex, bExpanded, nLevels)
  {
    var firstChildIndex = Nodes[nNodeIndex].firstChildIndex;

    if (firstChildIndex) {
      Nodes[nNodeIndex].expanded = bExpanded;

      if (nLevels > 1) {
        var nextNodeIndex = firstChildIndex;
        var nNextLevels = nLevels - 1;

        while (nextNodeIndex) {
          SetNodesExpanded(nextNodeIndex, bExpanded, nNextLevels);
          nextNodeIndex = Nodes[nextNodeIndex].nextIndex;
        }
      }
    }
  }


  function CopyChildNodes(destNodeIndex, sourceNodeIndex)
  {
    var firstChildIndex = Nodes[sourceNodeIndex].firstChildIndex;

    if (firstChildIndex) {
      var sourceNode = Nodes[firstChildIndex];
      var newNode = new Object();
      newNode.parentIndex = destNodeIndex;
      newNode.name = sourceNode.name;
      newNode.type = sourceNode.type;
      newNode.typeName = sourceNode.typeName;
      newNode.baseTypeName = sourceNode.baseTypeName;
      newNode.minOccurs = sourceNode.minOccurs;
      newNode.maxOccurs = sourceNode.maxOccurs;
      newNode.minLength = sourceNode.minLength;
      newNode.maxLength = sourceNode.maxLength;
      newNode.annotation = sourceNode.annotation;
      newNode.enumeration = sourceNode.enumeration;
      newNode.attributes = sourceNode.attributes;
      newNode.typeDescription = sourceNode.typeDescription;
      if (newNode.attributes)
        newNode.showAttributes = true; // for testing only !!!

      var newNodeIndex = Nodes.length;
      Nodes.push(newNode);
      Nodes[destNodeIndex].firstChildIndex = newNodeIndex;

      CopyChildNodes(newNodeIndex, firstChildIndex);

      var nextSourceIndex = sourceNode.nextIndex;

      while (nextSourceIndex) {
        var previousIndex = newNodeIndex;
        var sourceNode = Nodes[nextSourceIndex];
        var newNode = new Object();
        newNode.parentIndex = destNodeIndex;
        newNode.name = sourceNode.name;
        newNode.type = sourceNode.type;
        newNode.typeName = sourceNode.typeName;
        newNode.baseTypeName = sourceNode.baseTypeName;
        newNode.minOccurs = sourceNode.minOccurs;
        newNode.maxOccurs = sourceNode.maxOccurs;
        newNode.minLength = sourceNode.minLength;
        newNode.maxLength = sourceNode.maxLength;
        newNode.annotation = sourceNode.annotation;
        newNode.enumeration = sourceNode.enumeration;
        newNode.attributes = sourceNode.attributes;
        newNode.typeDescription = sourceNode.typeDescription;
        if (newNode.attributes)
          newNode.showAttributes = true; // for testing only !!!

        newNodeIndex = Nodes.length;
        Nodes.push(newNode);
        Nodes[previousIndex].nextIndex = newNodeIndex;

        CopyChildNodes(newNodeIndex, nextSourceIndex);

        nextSourceIndex = sourceNode.nextIndex;
      }
    }
    else {
      if (bResolveComplexTypes) {
        if (Nodes[destNodeIndex].type == NodeTypeComplex)
          ResolveComplexType(destNodeIndex);
        var baseTypeName = Nodes[sourceNodeIndex].baseTypeName;
        if (baseTypeName && baseTypeName.length > 0)
          ResolveSimpleBaseType(destNodeIndex);
      }
    }
  }


  function ResolveComplexType(nodeIndex)
  {
    var typeName = Nodes[nodeIndex].typeName;
    var complexTypeIndex = null;
    var i = 1;

    if (typeName) {
      while (i < ComplexTypes.length && !complexTypeIndex) {
        if (ComplexTypes[i].name == typeName)
          complexTypeIndex = i;
        else
          i++;
      }
    }

    if (complexTypeIndex != null)
      if (TypeNameUsedAbove(nodeIndex, typeName))
        Nodes[nodeIndex].recursiveType = true;
      else {
        var sourceNodeIndex = ComplexTypes[complexTypeIndex].nodeIndex;
        Nodes[nodeIndex].baseTypeName = Nodes[sourceNodeIndex].baseTypeName;
        if (Nodes[sourceNodeIndex].firstChildIndex)
          CopyChildNodes(nodeIndex, ComplexTypes[complexTypeIndex].nodeIndex);
        UpdateTypeDescription(nodeIndex);
      }
		
		if (complexTypeIndex == null && typeName) {
			var simpleTypeIndex = null;
			i = 1;
      while (i < SimpleTypes.length && !simpleTypeIndex) {
        if (SimpleTypes[i].name == typeName)
          simpleTypeIndex = i;
        else
          i++;
      }
			if (simpleTypeIndex) {
			  var sourceNodeIndex = SimpleTypes[simpleTypeIndex].nodeIndex;
			  /*if (typeName == "Text128Type")
			    i = 0;*/
				Nodes[nodeIndex].baseTypeName = Nodes[sourceNodeIndex].baseTypeName;
				Nodes[nodeIndex].minLength = Nodes[sourceNodeIndex].minLength;
				Nodes[nodeIndex].maxLength = Nodes[sourceNodeIndex].maxLength;
				Nodes[nodeIndex].pattern = Nodes[sourceNodeIndex].pattern;
				Nodes[nodeIndex].enumeration = Nodes[sourceNodeIndex].enumeration;
				UpdateTypeDescription(nodeIndex);
			}
		}
  }


  function ResolveSimpleBaseType(nodeIndex)
  {
    var baseTypeName = Nodes[nodeIndex].baseTypeName;
    var simpleTypeIndex = null;
    var i = 1;

    while (i < SimpleTypes.length && !simpleTypeIndex) {
      if (SimpleTypes[i].name == baseTypeName)
        simpleTypeIndex = i;
      else
        i++;
    }
    if (simpleTypeIndex) {
      var sourceNodeIndex = SimpleTypes[simpleTypeIndex].nodeIndex;
      if (baseTypeName == "AssetTypeType")
        i = 0;

      if (!Nodes[nodeIndex].minLength)
        Nodes[nodeIndex].minLength = Nodes[sourceNodeIndex].minLength;
      if (!Nodes[nodeIndex].maxLength)
        Nodes[nodeIndex].maxLength = Nodes[sourceNodeIndex].maxLength;
      if (!Nodes[nodeIndex].pattern)
        Nodes[nodeIndex].pattern = Nodes[sourceNodeIndex].pattern;
      if (!Nodes[nodeIndex].enumeration || Nodes[nodeIndex].enumeration.length == 0)
        Nodes[nodeIndex].enumeration = Nodes[sourceNodeIndex].enumeration;

      UpdateTypeDescription(nodeIndex);
    }
  }


  function LoadComplexTypes(node)
  {
    //var mynode = {};
    var nodeCount = null;
    var childNodes = node.childNodes;
    //var complexType = {};
    var i = null;

    for (i = 0; i < childNodes.length; i++)
      if (childNodes[i].nodeType == 1 && childNodes[i].nodeName == "xs:complexType") {
        var complexType = new Object();
        complexType.name = childNodes[i].getAttribute("name");
        var mynode = new Object();
        mynode.name = complexType.name;
        mynode.type = NodeTypeComplex;
        nodeCount = Nodes.length;
        Nodes.push(mynode);
        complexType.nodeIndex = nodeCount;
        ParseComplexTypeNode(childNodes[i], nodeCount);
        ComplexTypes.push(complexType);
      }
  }


  function LoadSimpleTypes(node)
  {
    var nodeCount = null;
    var childNodes = node.childNodes;
    var i = null;

    for (i = 0; i < childNodes.length; i++)
      if (childNodes[i].nodeType == 1 && childNodes[i].nodeName == "xs:simpleType") {
        var simpleType = new Object();
        simpleType.name = childNodes[i].getAttribute("name");
        var mynode = new Object();
        mynode.name = simpleType.name;
        mynode.type = NodeTypeSimple;
        nodeCount = Nodes.length;
        Nodes.push(mynode);
        simpleType.nodeIndex = nodeCount;
        ParseSimpleTypeNode(childNodes[i], nodeCount);
        SimpleTypes.push(simpleType);
      }
  }


  //<xs:include schemaLocation="FundsXML4_Core.xsd"/>

  function LoadIncludes(sourcePath, node)
  {
    var schemaLocation;
    var schemaURL;
    var childNodes = node.childNodes;
    var xhttp;
    var xmlDoc;
    var schemaNode;
    var nIncludes = 0;
    var i = null;

    for (i = 0; i < childNodes.length; i++)
      if (childNodes[i].nodeType == 1 && childNodes[i].nodeName == "xs:include") {
        schemaLocation = childNodes[i].getAttribute("schemaLocation");
        if (schemaLocation) {
          statusText.innerHTML = "Loading include file '" + schemaLocation + "' ...";
          schemaURL = sourcePath + schemaLocation;
          xhttp = new XMLHttpRequest();
          xhttp.overrideMimeType('text/xml');
          xhttp.open("GET", schemaURL, false);
          xhttp.send(null);
          xmlDoc = xhttp.responseXML;
          nIncludes++;

          schemaNode = GetFirstChildNode(xmlDoc, "xs:schema");
          LoadSimpleTypes(schemaNode);
          LoadComplexTypes(schemaNode);
        }
      }

    return nIncludes;
  }


  function ToString(txt)
  {
    var result = '';
    if (txt !== undefined)
      result = txt;
    return result;
  }


  function LoadSchemaUI()
  {
    if (rootNodeIndex)
      return;

    statusText.innerHTML = "Loading schema file ...";
    loadSchemaButton.style.display = 'none';
    //statusText.offsetHeight;
    statusText.style.display = 'block';
    //statusText.offsetHeight;
    /*
    var offsetLeft = statusText.offsetLeft;
    var offsetTop = statusText.offsetTop;
    var clientWidth = statusText.clientWidth;
    var clientHeight = statusText.clientHeight;
    */
    //statusText.redraw(true) // force redraw
    /*
    var n = document.createTextNode(' ');
    statusText.appendChild(n);
    n.parentNode.removeChild(n);
    */
    //loadSchemaButton.parentNode.removeChild(loadSchemaButton);

    //var ctx = canvas.getContext("2d");
    //DrawSizeRuler(ctx, 5, 5, 50);

    //setTimeout(function () { nodeDetails.style.display = "block"; }, 50);
    setTimeout(LoadSchema(), 500);

    //statusText.innerHTML = "offsetLeft = " + offsetLeft;
  }


  function SampleSchema()
  {
    var textarea = document.getElementById("schema-text");
    textarea.value = `
    <?xml version="1.0" encoding="UTF-8"?>
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" id="SAF-T"
  targetNamespace="mf:nra:dgti:dxxxx:declaration:v1" version="0.0.7"
  xmlns="mf:nra:dgti:dxxxx:declaration:v1" xmlns:xdb="http://xmlns.oracle.com/xdb"
  xmlns:doc="urn:schemas-OECD:schema-extensions:documentation xml:lang=en"
  xmlns:nsSAFT="mf:nra:dgti:dxxxx:declaration:v1" xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xdb:storeVarrayAsTable="true" xdb:flags="1075847463" xdb:schemaURL="BG_SAFT"
  xdb:schemaOwner="SYSTEM" xdb:numProps="497">
  <xs:annotation>
    <xs:documentation xml:lang="bg">Български SAF-T Финансови данни Национална агенция за
			приходите 0.0.1 Проектна версия SAF-T Работна група OECD Standard Audit File - Taxation
			2.00 30-10-2023</xs:documentation>
    <xs:documentation xml:lang="en"> Bulgarian SAF-T Financial data National Revenue Agency
			0.0.1 Draft Version SAF-T Working group OECD Standard Audit File - Taxation 2.00
			30-10-2023</xs:documentation>
  </xs:annotation>
  <xs:element name="AuditFile" xdb:SQLType="AUDITFILE_T" xdb:SQLCollType="AUDITFILE_V"
    xdb:defaultTable="" xdb:defaultTableSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Основен елемент на българския SAF-T
				файл.</xs:documentation>
      <xs:documentation xml:lang="en">Root element of the Bulgarian SAF-T
				file.</xs:documentation>
    </xs:annotation>
    <xs:complexType xdb:SQLType="AUDITFILE_T" xdb:SQLSchema="SYSTEM">
      <xs:sequence>
        <xs:element name="Header" xdb:SQLType="HEADER_T">
          <xs:annotation>
            <xs:documentation xml:lang="bg">Обща информация за този стандартен одитен
							файл.</xs:documentation>
            <xs:documentation xml:lang="en">Overall information about this Standard
							Audit file.</xs:documentation>
          </xs:annotation>
          <xs:complexType xdb:SQLType="HEADER_T" xdb:SQLSchema="SYSTEM">
            <xs:complexContent>
              <xs:extension base="nsSAFT:HeaderStructure">
                <xs:sequence>
                  <xs:element name="TaxAccountingBasis" xdb:SQLType="XDB$ENUM_T">
                    <xs:annotation>
                      <xs:documentation xml:lang="bg">Тип данни в одитния
												файл. Валидни стойности са "A" (Търговски предприятия), "P"
												(бюджетни предприятия), "BANK",
												"INSURANCE"</xs:documentation>
                      <xs:documentation xml:lang="en">Type of data in the
												audit file. Valid values are "A" (General commercial entities), "P"
												(public/government entities), "BANK",
												"INSURANCE"</xs:documentation>
                    </xs:annotation>
                    <xs:simpleType>
                      <xs:restriction base="nsSAFT:SAFshorttextType">
                        <xs:enumeration value="A"/>
                        <xs:enumeration value="P"/>
                        <xs:enumeration value="BANK"/>
                        <xs:enumeration value="INSURANCE"/>
                      </xs:restriction>
                    </xs:simpleType>
                  </xs:element>
                  <xs:element minOccurs="0" name="TaxEntity" type="nsSAFT:SAFmiddle2textType"
                    xdb:SQLType="VARCHAR2">
                    <xs:annotation>
                      <xs:documentation xml:lang="bg">Файл за
												фирма/подразделение/клон</xs:documentation>
                      <xs:documentation xml:lang="en">Company / Division /
												Branch reference</xs:documentation>
                    </xs:annotation>
                  </xs:element>
                </xs:sequence>
              </xs:extension>
            </xs:complexContent>
          </xs:complexType>
        </xs:element>
        <xs:element name="MasterFiles" xdb:SQLType="MASTERFILES_T">
          <xs:annotation>
            <xs:documentation xml:lang="bg">Основни данни за счетоводни сметки,
							доставчици, клиенти, продукти и т.н. Осигурена е точка за разширение,
							която позволява на органите по приходите да определят допълнителни
							елементи или структури, като например таблици с данъчни
							ставки.</xs:documentation>
            <xs:documentation xml:lang="en">Holds standing data about general ledger
							account, suppliers, customers, products, etc. An extension point is
							provided to allow Revenue Bodies to specify additional elements or
							structures such as tax rate tables.</xs:documentation>
          </xs:annotation>
          <xs:complexType xdb:SQLType="MASTERFILES_T" xdb:SQLSchema="SYSTEM">
            <xs:sequence>
              <xs:element name="GeneralLedgerAccounts" xdb:SQLType="GENERALLEDGERACCOUNTS_T">
                <xs:annotation>
                  <xs:documentation xml:lang="bg">Списък на счетоводните
										сметки.</xs:documentation>
                  <xs:documentation xml:lang="en">The general ledger accounts of a
										company.</xs:documentation>
                </xs:annotation>
                <xs:complexType xdb:SQLType="GENERALLEDGERACCOUNTS_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="Account"
                      xdb:SQLType="ACCOUNT_T" xdb:SQLCollType="ACCOUNT_V">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg">Информация за
												счетоводни сметки.</xs:documentation>
                        <xs:documentation xml:lang="en">General ledger
												account information.</xs:documentation>
                      </xs:annotation>
                      <xs:complexType xdb:SQLType="ACCOUNT_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element name="AccountID" minOccurs="1" type="nsSAFT:SAFmiddle2textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Код на аналитична
												счетоводна сметка, който трябва да съответства на
												предоставената номенклатура от сметки
												от НАП.</xs:documentation>
                              <xs:documentation xml:lang="en">This is the analytical account ID based on the nomenclature of accounts, provided by NRA.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="AccountDescription" type="nsSAFT:SAFlongtextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Наименование на сметката от системата на задълженото лице.</xs:documentation>
                              <xs:documentation xml:lang="en">Name of individual GL account from the tax payer's information system.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="1" name="TaxpayerAccountID"
                            type="nsSAFT:SAFmiddle1textType" xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Номер на сметка от информационната система, използвана за счетоводно отчитане от данъкоплатеца.</xs:documentation>
                              <xs:documentation xml:lang="en"> AccountID used by the tax payer in their ERP/accounting system.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="GroupingCategory"
                            type="nsSAFT:SAFmiddle1textType" xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Категория за групиране на сметката, използвана от данъкоплатеца. Обикновено се използва за отбелязване на специфична за данъкоплатеца категоризация (например - разходни, приходни).</xs:documentation>
                              <xs:documentation xml:lang="en">Category for grouping the accounts, relevant in reconciling financial statements.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="GroupingCode"
                            type="nsSAFT:SAFmiddle1textType" xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Код от категорията за групиранe. Конкретен код от посочената категория  за групиране (например - материали или резервни части).</xs:documentation>
                              <xs:documentation xml:lang="en"> Subcode for grouping the accounts.Specific code of the specified grouping category (for example - materials or spare parts) </xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="AccountType" xdb:SQLType="XDB$ENUM_T">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Тип на сметката -
												"Активна", "Пасивна",
												"Активно-пасивна"</xs:documentation>
                              <xs:documentation xml:lang="en"> Type of account - Active", "Passive", "Bifunctional".</xs:documentation>
                            </xs:annotation>
                            <xs:simpleType>
                              <xs:restriction base="nsSAFT:SAFshorttextType">
                                <xs:enumeration value="Active"/>
                                <xs:enumeration value="Pasive"/>
                                <xs:enumeration value="Bifunctional"/>
                              </xs:restriction>
                            </xs:simpleType>
                          </xs:element>
                          <xs:element minOccurs="0" name="AccountCreationDate" type="xs:date"
                            xdb:SQLType="DATE">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Дата на създаване
												на сметката.</xs:documentation>
                              <xs:documentation xml:lang="en">Date of creating the general ledger account.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:choice>
                            <xs:element name="OpeningDebitBalance" type="nsSAFT:SAFmonetaryType"
                              xdb:SQLType="NUMBER">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg">Дебитно салдо в
												началото на периода на файла(в основна
												валута) Ако салдото е отрицателно, това следва да е указано със знак "-"(минус).</xs:documentation>
                                <xs:documentation xml:lang="en"> Debit balance at
												the start date of the selection period in the
												header's default currency. The total of the debit amounts may be positive or negative. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                            <xs:element name="OpeningCreditBalance" type="nsSAFT:SAFmonetaryType"
                              xdb:SQLType="NUMBER">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg">Кредитно салдо в
												началото на периода (в основна
												валута). Ако салдото е отрицателно, това следва да е указано със знак "-" (минус).</xs:documentation>
                                <xs:documentation xml:lang="en"> Credit balance at
												the start date of the selection period in the
												header's default currency. The total of the credit amounts may be positive or negative. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                          </xs:choice>
                          <xs:choice>
                            <xs:element name="ClosingDebitBalance" type="nsSAFT:SAFmonetaryType"
                              xdb:SQLType="NUMBER">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg">Дебитно салдо в края на периода на файла (в основна валута). Ако салдото е отрицателно, това следва да е указано със знак "-" (минус).</xs:documentation>
                                <xs:documentation xml:lang="en"> Debit balance at the end date of the selection period in the header's default currency.
The total of the debit amounts may be positive or negative. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                            <xs:element name="ClosingCreditBalance" type="nsSAFT:SAFmonetaryType"
                              xdb:SQLType="NUMBER">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg"> Кредитно салдо в края на периода на файла (в основна валута). Ако салдото е отрицателно, това следва да е указано със знак "-" (минус).</xs:documentation>
                                <xs:documentation xml:lang="en"> Credit balance at the end date of the selection period in the header's default currency.
The total of the credit amounts may be positive or negative. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                          </xs:choice>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element minOccurs="0" name="Taxonomies" xdb:SQLType="TAXONOMIES_T">
                <xs:annotation>
                  <xs:documentation xml:lang="bg">Таксономии (секцията не се
										попълва).</xs:documentation>
                  <xs:documentation xml:lang="en">Taxonomies (this section is not
										used).</xs:documentation>
                </xs:annotation>
                <xs:complexType xdb:SQLType="TAXONOMIES_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="Taxonomy"
                      xdb:SQLType="TAXONOMY_T" xdb:SQLCollType="TAXONOMY_V">
                      <xs:complexType xdb:SQLType="TAXONOMY_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element name="TaxonomyReference" type="nsSAFT:SAFlongtextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Препратка към допълнителна таксономия (класификация), която се прилага към счетоводната сметка.</xs:documentation>
                              <xs:documentation xml:lang="en"> Reference to an additional taxonomy (classification) that applies to the GL Account.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element maxOccurs="unbounded" minOccurs="0" name="TaxonomyElement"
                            xdb:SQLType="TAXONOMYELEMENT_T" xdb:SQLCollType="TAXONOMYELEMENT_V">
                            <xs:complexType xdb:SQLType="TAXONOMYELEMENT_T" xdb:SQLSchema="SYSTEM">
                              <xs:sequence>
                                <xs:element name="TaxonomyCode" type="nsSAFT:SAFlongtextType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Препратка към
												конкретния елемент на
												допълнителната таксономия (класификация).</xs:documentation>
                                    <xs:documentation xml:lang="en"> Reference to
												specific taxonomy element.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="TaxonomyClusterID"
                                  type="nsSAFT:SAFlongtextType" xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Допълнителна
												препратка към конкретен елемент от
												допълнителната таксономия (класификация).</xs:documentation>
                                    <xs:documentation xml:lang="en"> Additional
												reference to specific taxonomy
												element</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="TaxonomyClusterContextID"
                                  type="nsSAFT:SAFlongtextType" xdb:SQLType="VARCHAR2"/>
                                <xs:element name="AccountID" type="nsSAFT:SAFmiddle2textType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> Код на аналитична счетоводна сметка, който трябва да съответства на предоставената номенклатура на сметки от НАП.</xs:documentation>
                                    <xs:documentation xml:lang="en"> This is the analytical account ID based on the nomenclature of accounts, provided by NRA.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element name="Customers" xdb:SQLType="CUSTOMERS_T">
                <xs:annotation>
                  <xs:documentation xml:lang="bg">Списък и информация за клиентите
										на компанията.</xs:documentation>
                  <xs:documentation xml:lang="en">Information about the customers of the
										company.</xs:documentation>
                </xs:annotation>
                <xs:complexType xdb:SQLType="CUSTOMERS_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="Customer"
                      xdb:SQLType="CUSTOMER_T" xdb:SQLCollType="CUSTOMER_V">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg">Информация за
												клиента.</xs:documentation>
                        <xs:documentation xml:lang="en">Customer
												information.</xs:documentation>
                      </xs:annotation>
                      <xs:complexType xdb:SQLType="CUSTOMER_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element minOccurs="0" name="CompanyStructure"
                            type="nsSAFT:CompanyStructure" xdb:SQLType="COMPANYSTRUCTURE_T">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Дефиниция на
												структурата на компанията на
												клиента.</xs:documentation>
                              <xs:documentation xml:lang="en"> Company structure
												definition for the customer.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="CustomerID" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Уникален код/номер
												на клиента (попълва се съгласно
												указанията).</xs:documentation>
                              <xs:documentation xml:lang="en"> Unique account
												code/number for the customer (filled in according
												to the instruction).</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="SelfBillingIndicator"
                            type="nsSAFT:SAFcodeType" xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Индикатор,
												показващ дали съществува споразумение за
												самофактуриране между клиента и
												доставчика.</xs:documentation>
                              <xs:documentation xml:lang="en"> Indicator showing
												if a self-billing agreement exists between the
												customer and the supplier.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="AccountID" type="nsSAFT:SAFmiddle2textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Код на аналитична счетоводна сметка, който трябва да съответства на предоставената номенклатура от сметки от НАП.</xs:documentation>
                              <xs:documentation xml:lang="en"> This is the analytical account ID based on the nomenclatures of accounts, provided by NRA.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:choice>
                            <xs:element name="OpeningDebitBalance" type="nsSAFT:SAFmonetaryType"
                              xdb:SQLType="NUMBER">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg"> Дебитно салдо в началото на периода на файла (в основна валута). Ако салдото е отрицателно, това следва да е указано със знак "-" (минус).</xs:documentation>
                                <xs:documentation xml:lang="en"> Debit balance at the start date of the selection period in the header's default currency.
The total of the debit amounts may be positive or negative. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                            <xs:element name="OpeningCreditBalance" type="nsSAFT:SAFmonetaryType"
                              xdb:SQLType="NUMBER">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg"> Кредитно салдо в началото на периода на файла (в основна валута). Ако салдото е отрицателно, това следва да е указано със знак "-" (минус)..</xs:documentation>
                                <xs:documentation xml:lang="en"> Credit balance at the start date of the selection period in the header's default currency.
The total of the credit amounts may be positive or negative. Negative amounts are prefixed with the minus („-”) sign..</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                          </xs:choice>
                          <xs:choice>
                            <xs:element name="ClosingDebitBalance" type="nsSAFT:SAFmonetaryType"
                              xdb:SQLType="NUMBER">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg"> Дебитно салдо в края на периода на файла (в основна валута). Ако салдото е отрицателно, това следва да е указано със знак "-" (минус).</xs:documentation>
                                <xs:documentation xml:lang="en"> Debit balance at the end date of the selection period in the header's default currency.
The total of the debit amounts may be positive or negative. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                            <xs:element name="ClosingCreditBalance" type="nsSAFT:SAFmonetaryType"
                              xdb:SQLType="NUMBER">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg"> Кредитно салдо в края на периода на файла (в основна валута). Ако салдото е отрицателно, това следва да е указано със знак "-" (минус)..</xs:documentation>
                                <xs:documentation xml:lang="en"> Credit balance at the end date of the selection period in the header's default currency.
The total of the credit amounts may be positive or negative. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                          </xs:choice>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element name="Suppliers" xdb:SQLType="SUPPLIERS_T">
                <xs:annotation>
                  <xs:documentation xml:lang="bg">Информация за доставчиците на
										компанията.</xs:documentation>
                  <xs:documentation xml:lang="en">Information about the suppliers of the
										company.</xs:documentation>
                </xs:annotation>
                <xs:complexType xdb:SQLType="SUPPLIERS_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="Supplier"
                      xdb:SQLType="SUPPLIER_T" xdb:SQLCollType="SUPPLIER_V">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg">Информация за
												доставчик.</xs:documentation>
                        <xs:documentation xml:lang="en">Supplier
												information.</xs:documentation>
                      </xs:annotation>
                      <xs:complexType xdb:SQLType="SUPPLIER_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element minOccurs="0" name="CompanyStructure"
                            type="nsSAFT:CompanyStructure" xdb:SQLType="COMPANYSTRUCTURE_T">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Име и адрес на компанията.</xs:documentation>
                              <xs:documentation xml:lang="en"> Company’s name and address details.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="SupplierID" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Уникален номер за идентифициране на икономическия оператор, издаден от държавната администрация (попълва се съгласно
												указанията).</xs:documentation>
                              <xs:documentation xml:lang="en"> Unique number to identify the economic operator, issued by relevant authorities (filled according to
												the instruction).</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="SelfBillingIndicator"
                            type="nsSAFT:SAFcodeType" xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Индикатор,
												показващ дали има споразумение за
												самофактуриране между клиента и
												доставчика.</xs:documentation>
                              <xs:documentation xml:lang="en"> Indicator showing
												if a self-billing agreement exists between the
												customer and the supplier.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="AccountID" type="nsSAFT:SAFmiddle2textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Код на аналитична счетоводна сметка, който трябва да съответства на предоставената номенклатура на сметки от НАП.</xs:documentation>
                              <xs:documentation xml:lang="en"> This is the analytical account ID based on the nomenclatures of accounts, provided by NRA.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:choice>
                            <xs:element name="OpeningDebitBalance" type="nsSAFT:SAFmonetaryType"
                              xdb:SQLType="NUMBER">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg"> Дебитно салдо в началото на периода на файла (в основна валута). Ако салдото е отрицателно, това следва да е указано със знак "-" (минус).</xs:documentation>
                                <xs:documentation xml:lang="en"> Debit balance at the start date of the selection period in the header's default currency.
The total of the debit amounts may be positive or negative. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                            <xs:element name="OpeningCreditBalance" type="nsSAFT:SAFmonetaryType"
                              xdb:SQLType="NUMBER">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg"> Кредитно салдо в началото на периода на файла (в основна валута). Ако салдото е отрицателно, това следва да е указано със знак "-" (минус).</xs:documentation>
                                <xs:documentation xml:lang="en"> Credit balance at the start date of the selection period in the header's default currency.
The total of the credit amounts may be positive or negative. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                          </xs:choice>
                          <xs:choice>
                            <xs:element name="ClosingDebitBalance" type="nsSAFT:SAFmonetaryType"
                              xdb:SQLType="NUMBER">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg"> Дебитно салдо в края на периода на файла (в основна валута). Ако салдото е отрицателно, това следва да е указано със знак "-" (минус).</xs:documentation>
                                <xs:documentation xml:lang="en"> Debit balance at the end date of the selection period in the header's default currency.
The total of the debit amounts may be positive or negative. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                            <xs:element name="ClosingCreditBalance" type="nsSAFT:SAFmonetaryType"
                              xdb:SQLType="NUMBER">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg"> Кредитно салдо в края на периода на файла (в основна валута). Ако салдото е отрицателно, това следва да е указано със знак "-" (минус).</xs:documentation>
                                <xs:documentation xml:lang="en"> Credit balance at the end date of the selection period in the header's default currency.
The total of the credit amounts may be positive or negative. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                          </xs:choice>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element name="TaxTable" xdb:SQLType="TAXTABLE_T">
                <xs:annotation>
                  <xs:documentation xml:lang="bg">Данъчни таблици за
										компанията.</xs:documentation>
                  <xs:documentation xml:lang="en">The tax tables of the
										company.</xs:documentation>
                </xs:annotation>
                <xs:complexType xdb:SQLType="TAXTABLE_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="TaxTableEntry"
                      xdb:SQLType="TAXTABLEENTRY_T" xdb:SQLCollType="TAXTABLEENTRY_V">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg">Запис за данъчна
												информация.</xs:documentation>
                        <xs:documentation xml:lang="en">Tax entry
												information.</xs:documentation>
                      </xs:annotation>
                      <xs:complexType xdb:SQLType="TAXTABLEENTRY_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element name="TaxType" type="nsSAFT:SAFcodeType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> TaxType референция към предоставената таблица.</xs:documentation>
                              <xs:documentation xml:lang="en"> TaxType for look-up in tables.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="Description" type="nsSAFT:SAFlongtextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Описание на TaxType.</xs:documentation>
                              <xs:documentation xml:lang="en"> Description of the Tax Type.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element maxOccurs="unbounded" name="TaxCodeDetails"
                            xdb:SQLType="TAXCODEDETAILS_T" xdb:SQLCollType="TAXCODEDETAILS_V">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Детайли по данъчен
												код за записа в данъчната
												таблица.</xs:documentation>
                              <xs:documentation xml:lang="en"> Tax code details
												of the tax table entry.</xs:documentation>
                            </xs:annotation>
                            <xs:complexType xdb:SQLType="TAXCODEDETAILS_T" xdb:SQLSchema="SYSTEM">
                              <xs:sequence>
                                <xs:element name="TaxCode" type="nsSAFT:SAFcodeType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> TaxCode референция.</xs:documentation>
                                    <xs:documentation xml:lang="en"> TaxCode for lookup in tables.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="EffectiveDate" type="xs:date"
                                  xdb:SQLType="DATE">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Начална дата за
												този запис.</xs:documentation>
                                    <xs:documentation xml:lang="en"> Representing the
												starting date for this entry.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="ExpirationDate" type="xs:date"
                                  xdb:SQLType="DATE">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Крайна дата за
												този запис.</xs:documentation>
                                    <xs:documentation xml:lang="en"> Representing the
												ending date for this entry.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="Description"
                                  type="nsSAFT:SAFlongtextType" xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Описание на TaxCode.</xs:documentation>
                                    <xs:documentation xml:lang="en">Description of the Tax Code.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:choice>
                                  <xs:element name="TaxPercentage" type="xs:decimal"
                                    xdb:SQLType="NUMBER">
                                    <xs:annotation>
                                      <xs:documentation xml:lang="bg">Данъчна
												ставка.</xs:documentation>
                                      <xs:documentation xml:lang="en">Tax
												percentage.</xs:documentation>
                                    </xs:annotation>
                                  </xs:element>
                                  <xs:element name="FlatTaxRate" type="nsSAFT:AmountStructure"
                                    xdb:SQLType="AMOUNTSTRUCTURE_T">
                                    <xs:annotation>
                                      <xs:documentation xml:lang="bg"> </xs:documentation>
                                      <xs:documentation xml:lang="en"> </xs:documentation>
                                    </xs:annotation>
                                  </xs:element>
                                </xs:choice>
                                <xs:element maxOccurs="unbounded" name="BaseRate"
                                  type="nsSAFT:SAFBaseRate" xdb:SQLCollType="BASERATE_V"
                                  xdb:SQLType="NUMBER">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> Коефициент на приспадане, използван за съответния TaxCode.</xs:documentation>
                                    <xs:documentation xml:lang="en"> Base rates used for the TaxCode.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="Country" type="nsSAFT:ISOCountryCode"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> Двубуквен код на страната съгласно ISO3166-2-CountryCodes. Например BG за България.</xs:documentation>
                                    <xs:documentation xml:lang="en"> Two-letter country code according to ISO3166-2-CountryCodes standard. Example BG for Bulgaria.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="Region" type="nsSAFT:SAFcodeType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> Специфичен за страната код за посочване на регионите/провинциите в рамките на данъчния орган. За предпочитане е описано в съответствие с ISO3166-1A2 - EN Dept Codes. Пример: BG-22 София.</xs:documentation>
                                    <xs:documentation xml:lang="en"> Country specific code to indicate regions / provinces within the tax authority. Preferably described according to ISO3166-1A2 - Dept Codes. Example: BG-22 Sofia.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element name="UOMTable" xdb:SQLType="UOMTABLE_T">
                <xs:annotation>
                  <xs:documentation xml:lang="bg">Таблица на мерните
										единици.</xs:documentation>
                  <xs:documentation xml:lang="en">Units of Measure
										Table.</xs:documentation>
                </xs:annotation>
                <xs:complexType xdb:SQLType="UOMTABLE_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="UOMTableEntry"
                      xdb:SQLType="UOMTABLEENTRY_T" xdb:SQLCollType="UOMTABLEENTRY_V">
                      <xs:complexType xdb:SQLType="UOMTABLEENTRY_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element name="UnitOfMeasure" type="nsSAFT:SAFcodeType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Единица мярка за количество, например пакет от 12.</xs:documentation>
                              <xs:documentation xml:lang="en"> Quantity unit of measure e.g. pack of 12</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="Description" type="nsSAFT:SAFlongtextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Описание на
												мерната единица</xs:documentation>
                              <xs:documentation xml:lang="en">Description of the
												UOM</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element name="AnalysisTypeTable" minOccurs="0" xdb:SQLType="ANALYSISTYPETABLE_T">
                <xs:annotation>
                  <xs:documentation xml:lang="bg">Таблица с идентификаторите на
										аналитичности (допълнителни кодове за анализ). Използва се
										за допълнително уточняване на данните за транзакциите.
										Пример: разходна единица, разходен център, проект, отдел,
										доставчик, тип дневник, служители и т.н. Journal type винаги
										трябва да се използва за всички
										транзакции.</xs:documentation>
                  <xs:documentation xml:lang="en"> Table with the analysis code
										identifiers (additional analysis codes). Used for further specification of transaction
										data. Example: cost unit, cost center, project, department,
										provider, journal type, employees, etc. Journal type should
										always be used on all transactions.</xs:documentation>
                </xs:annotation>
                <xs:complexType xdb:SQLType="ANALYSISTYPETABLE_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="AnalysisTypeTableEntry"
                      xdb:SQLType="ANALYSISTYPETABLEENTRY_T"
                      xdb:SQLCollType="ANALYSISTYPETABLEENTRY_V">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> </xs:documentation>
                        <xs:documentation xml:lang="en"> </xs:documentation>
                      </xs:annotation>
                      <xs:complexType xdb:SQLType="ANALYSISTYPETABLEENTRY_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element name="AnalysisType" type="nsSAFT:SAFcodeType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Идентификатор на Analysis Type: напр. CC (за разходен център), DEP (за отдел) и др., т.е. попълва се идентификационен код на самата номенклатура.</xs:documentation>
                              <xs:documentation xml:lang="en"> Analysis type identifier: e.g. CC (for Cost Center), DEP (for department), etc.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="AnalysisTypeDescription" type="nsSAFT:SAFlongtextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Описание на AnalysisType, т.е. описание на попълнения идентификационен код. Например - ако е попълнен код - CC за разходен център - се опълва описание "Разходни центрове".</xs:documentation>
                              <xs:documentation xml:lang="en"> Description of the AnalysisType, e.g. "Cost Center".</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="AnalysisID" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> AnalysisID: напр. 1200-HDOF-TR (за разходен център Продажби в централата), P-4800-123 (за проект 123 в клон 4800). Т.е. попълва се конкретна стойност (в случая код) за съответния тип аналитични кодове.</xs:documentation>
                              <xs:documentation xml:lang="en"> Analysis ID: e.g. 1200-HDOF-TR (for cost center Sales in the headoffice), P-4800-123 (for project 123 in branch 4800).</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="AnalysisIDDescription" type="nsSAFT:SAFlongtextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Описание на AnalysisID например "Разходен център - Продажби", т.е. попълва се описание за съответния код.</xs:documentation>
                              <xs:documentation xml:lang="en"> Description of the AnalysisID: e.g. "Headoffice-Treasury".</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element name="MovementTypeTable" xdb:SQLType="MOVEMENTTYPETABLE_T">
                <xs:annotation>
                  <xs:documentation xml:lang="bg">Тип движение.</xs:documentation>
                  <xs:documentation xml:lang="en">Movement
										Type.</xs:documentation>
                </xs:annotation>
                <xs:complexType xdb:SQLType="MOVEMENTTYPETABLE_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="MovementTypeTableEntry"
                      xdb:SQLType="MOVEMENTTYPETABLEENTRY_T"
                      xdb:SQLCollType="MOVEMENTTYPETABLEENTRY_V">
                      <xs:complexType xdb:SQLType="MOVEMENTTYPETABLEENTRY_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element name="MovementType" type="nsSAFT:SAFcodeType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Идентификатор за вида на стоковото движение. Например, продажба, покупка, приспособяване и т.н. Или технологични загуби, използване на компоненти в производството и др. Следва да се използва предоставената таблица.</xs:documentation>
                              <xs:documentation xml:lang="en"> Identify kind of movement or movement line. E.g. sale, purchase, adjustment, etc. Or efficiencyloss, use of components in production, etc. Nomenclature to be used.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="Description" type="nsSAFT:SAFlongtextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Описание на стоковото
												движение</xs:documentation>
                              <xs:documentation xml:lang="en">Description of the
												movement(sub)type</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element name="Products" xdb:SQLType="PRODUCTS_T">
                <xs:annotation>
                  <xs:documentation xml:lang="bg">Продукти.</xs:documentation>
                  <xs:documentation xml:lang="en">Products.</xs:documentation>
                </xs:annotation>
                <xs:complexType xdb:SQLType="PRODUCTS_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="Product"
                      xdb:SQLType="PRODUCT_T" xdb:SQLCollType="PRODUCT_V">
                      <xs:complexType xdb:SQLType="PRODUCT_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element name="ProductCode" type="nsSAFT:SAFmiddle2textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Код на
												продукта/ материален запас / услуга.</xs:documentation>
                              <xs:documentation xml:lang="en">Product
												code(denoting products, goods, material items, services, etc.)</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="GoodsServicesID" type="nsSAFT:SAFcodeType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Индикатор,
												показващ дали продукта е стока или
												услуга.</xs:documentation>
                              <xs:documentation xml:lang="en"> Indicator showing
												if goods or services.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="ProductGroup"
                            type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Продуктова група.</xs:documentation>
                              <xs:documentation xml:lang="en"> Code identifying
												aggregated level at which similar products are
												grouped</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="Description" type="nsSAFT:SAFlongtextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Описание на
												стоката или услугата.</xs:documentation>
                              <xs:documentation xml:lang="en">Description of
												goods or services.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="ProductCommodityCode" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Код съгласно
												комбинирата номенклатура
												(NC8_TARIC3).</xs:documentation>
                              <xs:documentation xml:lang="en"> Code according to NC8_TARIC3 sheet.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="ProductNumberCode"
                            type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> EAN или друг, като баркод или друг сходен тип код използва за етикиране на продукта.</xs:documentation>
                              <xs:documentation xml:lang="en"> EAN or other, such as barcode or other labelling code type</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="ValuationMethod" type="nsSAFT:SAFcodeType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Средно претеглена, FIFO, LIFO, Standard или др.</xs:documentation>
                              <xs:documentation xml:lang="en"> Average Cost, FIFO, LIFO, Standard or other.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="UOMBase" type="nsSAFT:SAFcodeType" minOccurs="1"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Основна мерна единица, използвана в информационните системи на данъкоплатеца.</xs:documentation>
                              <xs:documentation xml:lang="en"> Unit of measure
												for Stock Administration for this
												product.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:sequence>
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Дефиниция на
												стандартна мерна единица, приложима за този
												продукт.</xs:documentation>
                              <xs:documentation xml:lang="en"> Unit of measure
												applicable to this product.</xs:documentation>
                            </xs:annotation>
                            <xs:element name="UOMStandard" type="nsSAFT:SAFcodeType"
                              xdb:SQLType="VARCHAR2">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg"> Стандартна мерна единица, съгласно предоставената таблица, например килограм, метър, кубичен метър.</xs:documentation>
                                <xs:documentation xml:lang="en"> A Standard Unit of Measure applicable for this product, f.i. Kilo, Metres, Cubic meter.</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                            <xs:element name="UOMToUOMBaseConversionFactor" type="xs:decimal"
                              xdb:SQLType="NUMBER">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg"> Коефициент на преобразуване между UOMStandard и UOMBase</xs:documentation>
                                <xs:documentation xml:lang="en"> Conversion factor of the UOM to UOMBase</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                          </xs:sequence>
                          <xs:element maxOccurs="unbounded" minOccurs="0" name="Tax"
                            xdb:SQLType="TAX_T" xdb:SQLCollType="TAXV">
                            <xs:complexType xdb:SQLType="TAX_T" xdb:SQLSchema="SYSTEM">
                              <xs:sequence>
                                <xs:element name="TaxType" type="nsSAFT:SAFcodeType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> TaxType референция към предоставената таблица</xs:documentation>
                                    <xs:documentation xml:lang="en"> TaxType for lookup in tables.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="TaxCode" type="nsSAFT:SAFcodeType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> TaxCode референция</xs:documentation>
                                    <xs:documentation xml:lang="en"> TaxCode for lookup in tables.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element minOccurs="0" name="PhysicalStock" xdb:SQLType="PHYSICALSTOCK_T">
                <xs:annotation>
                  <xs:documentation xml:lang="bg">Стоки на склад.</xs:documentation>
                  <xs:documentation xml:lang="en">Physical
										Stock.</xs:documentation>
                </xs:annotation>
                <xs:complexType xdb:SQLType="PHYSICALSTOCK_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element maxOccurs="unbounded" name="PhysicalStockEntry"
                      xdb:SQLType="PHYSICALSTOCKENTRY_T" xdb:SQLCollType="PHYSICALSTOCKENTRY_V">
                      <xs:complexType xdb:SQLType="PHYSICALSTOCKENTRY_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element name="WarehouseID" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Складът, в който се съхраняват стоките, следва да се включат складови или производствени помещения и площадки с незавършено производство, както и превозни средства или други, които съдържат стоки на път.</xs:documentation>
                              <xs:documentation xml:lang="en"> Warehouse where goods held - possible also to identify work-in-progress, or stock-in-transit.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="LocationID" type="nsSAFT:SAFshorttextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Локация на
												стоките в склада</xs:documentation>
                              <xs:documentation xml:lang="en">Location of goods
												in warehouse</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="ProductCode" type="nsSAFT:SAFmiddle2textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Код на
												продукта</xs:documentation>
                              <xs:documentation xml:lang="en">Product
												code</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="StockAccountNo"
                            type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Партида или сериен
												номер. Не се използва, когато има точно 1 физически запис на
												склад за код на продукт.</xs:documentation>
                              <xs:documentation xml:lang="en"> Stock batch, lot,
												serial identification. Not used when there is
												exactly 1 PhysicalStock entry per
												ProductCode</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="ProductType" type="nsSAFT:SAFshorttextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Oпределя дали  продукта/материалния запас е суровина, незавършено производство, краен продукт, стока и др.</xs:documentation>
                              <xs:documentation xml:lang="en"> To determine whether the product/stock account is raw material, work-in-progress, finished good, merchandise for resale, etc.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="ProductStatus"
                            type="nsSAFT:SAFshorttextType" xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> За да се определи дали  продукта е извън експлоатация, повредена, остаряла, активна и т.н.</xs:documentation>
                              <xs:documentation xml:lang="en"> To determine whether the product/stock account is raw material, work-in-progress, finished good, merchandise for resale, etc.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="StockAccountCommodityCode"
                            type="nsSAFT:SAFmiddle1textType" xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Код от
												комбинираната номенклатура за конкретната
												партида/сериен номер(съгласно таблицата NC8_TARIC3).</xs:documentation>
                              <xs:documentation xml:lang="en"> Code from the combined (tariff and statistical) nomenclature (according to NC8_TARIC3 sheet).</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="OwnerID" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Уникален номер за идентифициране на икономическия оператор, издаден от държавната администрация.</xs:documentation>
                              <xs:documentation xml:lang="en"> Unique number to identify the economic operator, issued by relevant authorities.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:sequence>
                            <xs:element name="UOMPhysicalStock" type="nsSAFT:SAFcodeType"
                              xdb:SQLType="VARCHAR2">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg"> Мерна единица за тази PhysicalStock позиция.</xs:documentation>
                                <xs:documentation xml:lang="en"> Unit of
												Measurement for this Physical Stock
												position</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                            <xs:element name="UOMToUOMBaseConversionFactor" type="xs:decimal"
                              xdb:SQLType="NUMBER">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg">Коефициент на
												преобразуване мужду UOMStandard към UOM
												Base.</xs:documentation>
                                <xs:documentation xml:lang="en"> Conversion factor
												of the UOM to UOM Base.</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                          </xs:sequence>
                          <xs:element name="UnitPrice" type="nsSAFT:SAFmonetaryType"
                            xdb:SQLType="NUMBER">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Единична цена за тази позиция (в основна валута).</xs:documentation>
                              <xs:documentation xml:lang="en"> Base Unit price
												for this stock account in the header's default
												currency.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="OpeningStockQuantity" type="nsSAFT:SAFquantityType"
                            xdb:SQLType="NUMBER">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Начално салдо (количествено) в UOMPhisicalStock.</xs:documentation>
                              <xs:documentation xml:lang="en"> Opening balance (quantity) in UOMPhysicalStock.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="OpeningStockValue" type="nsSAFT:SAFmonetaryType"
                            xdb:SQLType="NUMBER">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Начално салдо (в стойност).</xs:documentation>
                              <xs:documentation xml:lang="en"> Opening balance (in value).</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="ClosingStockQuantity" type="nsSAFT:SAFquantityType"
                            xdb:SQLType="NUMBER">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Крайно салдо (количествено) в UOMPhisicalStock.</xs:documentation>
                              <xs:documentation xml:lang="en"> Closing balance (quantity) in UOMPhysicalStock.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="ClosingStockValue" type="nsSAFT:SAFmonetaryType"
                            xdb:SQLType="NUMBER">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Крайно салдо (в стойност).</xs:documentation>
                              <xs:documentation xml:lang="en"> Closing stock value in the header's default currency for selection period</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="StockCharacteristics" minOccurs="0"
                            xdb:SQLType="STOCKCHARACTERISTICS_T">
                            <xs:complexType xdb:SQLType="STOCKCHARACTERISTICS_T"
                              xdb:SQLSchema="SYSTEM">
                              <xs:sequence maxOccurs="unbounded">
                                <xs:element name="StockCharacteristic" minOccurs="0"
                                  type="nsSAFT:SAFshorttextType" xdb:SQLType="VARCHAR2"
                                  xdb:SQLCollType="OTHERTITLES_V">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Код на потребителски дефинируеми характеристики на стоковия запас. Например, ако се описва цвят - COLOR.</xs:documentation>
                                    <xs:documentation xml:lang="en"> Code of the user definable characteristics of the goods.For example - COLOR, if we are describing colors. </xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="StockCharacteristicValue"
                                  type="nsSAFT:SAFmiddle1textType" xdb:SQLType="VARCHAR2"
                                  xdb:SQLCollType="MOVEMENTREFERENCE_V">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Тегло, размер на
												опаковката, цвят и др. Например - Синьо, Червено, Зелено и т.н. </xs:documentation>
                                    <xs:documentation xml:lang="en"> The weight, pack
												size, colour etc. For example - Blue, Red, Green, etc.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element name="Owners" xdb:SQLType="OWNERS_T">
                <xs:annotation>
                  <xs:documentation xml:lang="bg">Собственици на
										компания.</xs:documentation>
                  <xs:documentation xml:lang="en">The owners of a
										company.</xs:documentation>
                </xs:annotation>
                <xs:complexType xdb:SQLType="OWNERS_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="Owner"
                      xdb:SQLType="OWNER_T" xdb:SQLCollType="OWNER_V">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg">Информация за
												собственика.</xs:documentation>
                        <xs:documentation xml:lang="en">Owner
												information.</xs:documentation>
                      </xs:annotation>
                      <xs:complexType xdb:SQLType="OWNER_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element minOccurs="0" name="CompanyStructure"
                            type="nsSAFT:CompanyStructure" xdb:SQLType="COMPANYSTRUCTURE_T">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Дефиниция на
												информационна структура за компанията /
												собственика.</xs:documentation>
                              <xs:documentation xml:lang="en"> Company structure
												definition for the owner.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="OwnerID" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Уникален номер за идентифициране на икономическия оператор, издаден от държавната администрация.</xs:documentation>
                              <xs:documentation xml:lang="en"> Unique number to identify the economic operator, issued by relevant authorities.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="AccountID" type="nsSAFT:SAFmiddle2textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Код на аналитична счетоводна сметка, който трябва да съответства на предоставената номенклатура от сметки от НАП.</xs:documentation>
                              <xs:documentation xml:lang="en"> This is the analytical account ID based on the nomenclatures of accounts, provided by NRA.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element name="Assets" xdb:SQLType="ASSETS_T">
                <xs:annotation>
                  <xs:documentation xml:lang="bg">Активи.</xs:documentation>
                  <xs:documentation xml:lang="en">Assets.</xs:documentation>
                </xs:annotation>
                <xs:complexType xdb:SQLType="ASSETS_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="Asset"
                      xdb:SQLType="ASSET_T" xdb:SQLCollType="ASSET_V">
                      <xs:complexType xdb:SQLType="ASSET_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element name="AssetID" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Уникален код на актива, присвоен от задълженото лице (системно или ръчно).</xs:documentation>
                              <xs:documentation xml:lang="en">Unique identifier of the asset, assigned by the tax payer (automatically via information system or manually).</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="AccountID" type="nsSAFT:SAFmiddle2textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Код на аналитична счетоводна сметка, който трябва да съответства на предоставената номенклатура от сметки от НАП.</xs:documentation>
                              <xs:documentation xml:lang="en"> This is the analytical account ID based on the nomenclatures of accounts, provided by NRA.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="Description" type="nsSAFT:SAFlongtextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Описание на
												актива</xs:documentation>
                              <xs:documentation xml:lang="en">Description of
												this asset</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element maxOccurs="unbounded" minOccurs="0" name="AssetSupplier"
                            xdb:SQLType="ASSETSUPPLIER_T" xdb:SQLCollType="ASSETSUPPLIER_V">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Доставчик на
												актива (вкл. исторически данни)</xs:documentation>
                              <xs:documentation xml:lang="en"> Contains the
												information of all suppliers, including the
												historical suppliers.</xs:documentation>
                            </xs:annotation>
                            <xs:complexType xdb:SQLType="ASSETSUPPLIER_T" xdb:SQLSchema="SYSTEM">
                              <xs:sequence>
                                <xs:element name="SupplierName" type="nsSAFT:SAFmiddle2textType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Име на доставчик</xs:documentation>
                                    <xs:documentation xml:lang="en"> Name of the
												supplier of the asset</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="SupplierID" type="nsSAFT:SAFmiddle1textType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> Уникален номер за идентифициране на икономическия оператор, издаден от държавната администрация.</xs:documentation>
                                    <xs:documentation xml:lang="en"> Unique number to identify the economic operator, issued by relevant authorities</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="PostalAddress" type="nsSAFT:AddressStructure"
                                  xdb:SQLType="ADRESSSTRUCTURE_T">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> Адресна информация за доставчика</xs:documentation>
                                    <xs:documentation xml:lang="en"> Address
												information of the supplier of the
												asset</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                          <xs:element minOccurs="0" name="PurchaseOrderDate" type="xs:date"
                            xdb:SQLType="DATE">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Дата на поръчка
												за покупка на актива</xs:documentation>
                              <xs:documentation xml:lang="en"> Date of the
												purchase order of this asset</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="DateOfAcquisition" type="xs:date" xdb:SQLType="DATE">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Дата на
												придобиване.</xs:documentation>
                              <xs:documentation xml:lang="en"> Date of the
												acquisition of the asset (usually the date of
												delivery).</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="StartUpDate" type="xs:date" xdb:SQLType="DATE">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Дата на въвеждане
												в експлоатация.</xs:documentation>
                              <xs:documentation xml:lang="en">Commissioning date
												of the asset.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="Valuations" xdb:SQLType="VALUATIONS_T">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Данните за оценка
												на активи могат да бъдат изискани да бъдат
												докладвани за различни цели. Като минимум следва
												да включват данни за счетоводния амортизационен
												план и данъчния амортизационен план, където е
												приложимо.</xs:documentation>
                              <xs:documentation xml:lang="en"> An asset
												valuations data can be required to be reported for
												different purposes. As a minimum it must include
												Accounting Depreciation Plan and Tax Depreciation
												Plan data, where relevant.</xs:documentation>
                            </xs:annotation>
                            <xs:complexType xdb:SQLType="VALUATIONS_T" xdb:SQLSchema="SYSTEM">
                              <xs:sequence>
                                <xs:element maxOccurs="unbounded" name="Valuation"
                                  xdb:SQLType="VALUATION_T" xdb:SQLCollType="VALUATION_V">
                                  <xs:complexType xdb:SQLType="VALUATION_T" xdb:SQLSchema="SYSTEM">
                                    <xs:sequence>
                                      <xs:element name="AssetValuationType" xdb:SQLType="XDB$ENUM_T">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg"> Вид на даните ("SAP" или "DAP" за Счетоводен амортизационен план и Данъчен амортизационен план съответно) или "Other" за други цели</xs:documentation>
                                          <xs:documentation xml:lang="en"> Describes the purpose for the reporting: SAP (for accounting depreciation plan) or DAP (for Tax Depreciation plan) or Other for any other purpose.</xs:documentation>
                                        </xs:annotation>
                                        <xs:simpleType>
                                          <xs:annotation>
                                            <xs:documentation xml:lang="bg">Разрешават се два
												основни вида оценка на активи - SAP за счетоводен
												амортизационен план и DAP за данъчен
												амортизационен план.</xs:documentation>
                                            <xs:documentation xml:lang="en"> Two basic types
												of asset valuation is allowed - SAP for Accounting
												Depreciation Plan and DAP for Tax Depreciation
												Plan.</xs:documentation>
                                          </xs:annotation>
                                          <xs:restriction base="nsSAFT:SAFshorttextType">
                                            <xs:enumeration value="SAP"/>
                                            <xs:enumeration value="DAP"/>
                                            <xs:enumeration value="OTHER"/>
                                          </xs:restriction>
                                        </xs:simpleType>
                                      </xs:element>
                                      <xs:element name="ValuationClass"
                                        type="nsSAFT:SAFshorttextType" xdb:SQLType="VARCHAR2">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg">Класификация на
												актива за целите на счетоводното / данъчното
												отчитане.</xs:documentation>
                                          <xs:documentation xml:lang="en"> This describes
												the classification of the asset for (tax)
												reporting purposes.</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:element name="AcquisitionAndProductionCostsBegin"
                                        type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg">Общо начално салдо разходи за придобиване (вкл. по стопански начин) на актива (в основна валута).</xs:documentation>
                                          <xs:documentation xml:lang="en"> Total costs of acquisition and/or production of the asset at SelectionStartDate in the header's default currency.</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:element name="AcquisitionAndProductionCostsEnd"
                                        type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg">Общо крайно салдо разходи за придобиване (вкл. по стопански начин) на актива (в основна валута).</xs:documentation>
                                          <xs:documentation xml:lang="en"> Total costs of acquisition and/or production of the asset at SelectionEndDate in the header's default currency.</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:element name="InvestmentSupport"
                                        type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg"> Капиталови разходи за актива за периода (в основна валута) </xs:documentation>
                                          <xs:documentation xml:lang="en"> Total amount of
												investment support for this asset in the header's
												default currency.</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:choice>
                                        <xs:element name="AssetLifeYear" type="xs:decimal"
                                          xdb:SQLType="NUMBER">
                                          <xs:annotation>
                                            <xs:documentation xml:lang="bg">Полезен
												живот в години.</xs:documentation>
                                            <xs:documentation xml:lang="en"> Period of useful
												life in years</xs:documentation>
                                          </xs:annotation>
                                        </xs:element>
                                        <xs:element name="AssetLifeMonth" type="xs:decimal"
                                          xdb:SQLType="NUMBER">
                                          <xs:annotation>
                                            <xs:documentation xml:lang="bg">Полезен
												живот в месеци.</xs:documentation>
                                            <xs:documentation xml:lang="en"> Period of useful
												life in months</xs:documentation>
                                          </xs:annotation>
                                        </xs:element>
                                      </xs:choice>
                                      <xs:element name="AssetAddition" type="nsSAFT:SAFmonetaryType"
                                        xdb:SQLType="NUMBER">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg">Балансова стойност на актива (в основна валута).</xs:documentation>
                                          <xs:documentation xml:lang="en"> Bookvalue of the
												acquisition and/or production of the asset in default
												currency.</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:element name="Transfers" type="nsSAFT:SAFmonetaryType"
                                        xdb:SQLType="NUMBER">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg"> Стойност за прехвърляния / отчисления от стойността на актива за периода.</xs:documentation>
                                          <xs:documentation xml:lang="en"> Book value of the
												transfers of the asset during the Selectionperiod
												in the header's default
												currency.</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:element name="AssetDisposal" type="nsSAFT:SAFmonetaryType"
                                        xdb:SQLType="NUMBER">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg"> Балансова стойност при изписване на актива (в основна валута).</xs:documentation>
                                          <xs:documentation xml:lang="en"> Book value of the disposals of the asset during the Selectionperiod in the header's default currency.</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:element name="BookValueBegin"
                                        type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg">Балансова стойност
												в началото на периода.</xs:documentation>
                                          <xs:documentation xml:lang="en"> Bookvalue at the
												beginning of the Selectionperiod in the header's
												default currency.</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:element name="DepreciationMethod"
                                        type="nsSAFT:SAFmiddle1textType" xdb:SQLType="VARCHAR2">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg">Метод на
												амортизация </xs:documentation>
                                          <xs:documentation xml:lang="en"> Method of normal
												depreciation during the
												Selectionperiod.</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:element name="DepreciationPercentage" type="xs:decimal"
                                        xdb:SQLType="NUMBER">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg">Амортизационна норма (месечна или годишна в зависимост от посочения полезен живот по-горе - в месеци или години)</xs:documentation>
                                          <xs:documentation xml:lang="en"> The rate of the
												normal depreciation per year or month (depends on
												choice useful life period)</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:element name="DepreciationForPeriod"
                                        type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg">Обща сума на
												амортизацията за периода (в основна
												валута)</xs:documentation>
                                          <xs:documentation xml:lang="en"> Total amount of
												normal depreciation during the Selectionperiod in
												the header's default currency.</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:element name="AppreciationForPeriod"
                                        type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg">Обща сума на
												увеличения за периода (в основна
												валута)</xs:documentation>
                                          <xs:documentation xml:lang="en"> Total amouunt of
												appreciation during the Selectionperiod in the
												header's default currency.</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:element name="ExtraordinaryDepreciationsForPeriod"
                                        xdb:SQLType="EXTRAORDINARYDEPRECIATIONSFORPERIOD_T">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg">Сума на извънредно
												начислена амортизация за периода (в основна
												валута)</xs:documentation>
                                          <xs:documentation xml:lang="en"> Extraordinary
												depreciations for this asset during the
												Selectionperiod.</xs:documentation>
                                        </xs:annotation>
                                        <xs:complexType
                                          xdb:SQLType="EXTRAORDINARYDEPRECIATIONSFORPERIOD_T"
                                          xdb:SQLSchema="SYSTEM">
                                          <xs:sequence>
                                            <xs:element maxOccurs="unbounded"
                                              name="ExtraordinaryDepreciationForPeriod"
                                              xdb:SQLType="EXTRAORDINARYDEPRECIATIONFORPERIOD_T"
                                              xdb:SQLCollType="EXTRAORDINARYDEPRECIATIONFORPERIOD_V">
                                              <xs:complexType
                                                xdb:SQLType="EXTRAORDINARYDEPRECIATIONFORPERIOD_T"
                                                xdb:SQLSchema="SYSTEM">
                                                <xs:sequence>
                                                  <xs:element name="ExtraordinaryDepreciationMethod"
                                                  type="nsSAFT:SAFmiddle1textType"
                                                  xdb:SQLType="VARCHAR2">
                                                  <xs:annotation>
                                                  <xs:documentation xml:lang="bg">Метод на
												извънредна амортизация за
												периода</xs:documentation>
                                                  <xs:documentation xml:lang="en"> Method of
												extraordinary depreciation during the
												Selectionperiod.</xs:documentation>
                                                  </xs:annotation>
                                                  </xs:element>
                                                  <xs:element
                                                  name="ExtraordinaryDepreciationAmountForPeriod"
                                                  type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
                                                  <xs:annotation>
                                                  <xs:documentation xml:lang="bg">Сума на извънредно
												начислена амортизация за периода (в основна
												валута)</xs:documentation>
                                                  <xs:documentation xml:lang="en"> Amount of
												extraordinary depreciation during the
												Selectionperiod in the header's default
												currency.</xs:documentation>
                                                  </xs:annotation>
                                                  </xs:element>
                                                </xs:sequence>
                                              </xs:complexType>
                                            </xs:element>
                                          </xs:sequence>
                                        </xs:complexType>
                                      </xs:element>
                                      <xs:element name="AccumulatedDepreciation"
                                        type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg">Обща сума на
												натрупаната амортизация за актива (в основна
												валута)</xs:documentation>
                                          <xs:documentation xml:lang="en"> Total amount of
												depreciation for this asset</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:element name="BookValueEnd" type="nsSAFT:SAFmonetaryType"
                                        xdb:SQLType="NUMBER">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg">Балансова стойност
												на актив в края на периода (в основна
												валута)</xs:documentation>
                                          <xs:documentation xml:lang="en"> Bookvalue at the
												end of the Selectionperiod in the header's default
												currency.</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                    </xs:sequence>
                                  </xs:complexType>
                                </xs:element>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element maxOccurs="1" minOccurs="0" name="CorrespondingAccountsReport"
          xdb:SQLType="CORRESPONDINGACCOUNTSREPORT_T">
          <xs:annotation>
            <xs:documentation xml:lang="bg">Съдържа незадължителен отчет за дебитни
              и кредитни начални салда, обороти и крайни салда по главни и
              кореспондиращи сметки.</xs:documentation>
            <xs:documentation xml:lang="en"> Contains optional report on Debit and
              Credit opening balances, turnovers and closing balances by G/L and
              Corresponding accounts.</xs:documentation>
          </xs:annotation>
          <xs:complexType xdb:SQLType="CORRESPONDINGACCOUNTSREPORT_T" xdb:SQLSchema="SYSTEM">
            <xs:sequence>
              <xs:element maxOccurs="1" minOccurs="0" name="CorrespondingAccountsReportTotals"
                xdb:SQLType="CORRESPONDINGACCOUNTSREPORTTOTALS_T"
                xdb:SQLCollType="CORRESPONDINGACCOUNTSREPORTTOTALS_V">
                <xs:complexType xdb:SQLType="CORRESPONDINGACCOUNTSREPORTTOTALS_T"
                  xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element name="TotalDebitOpeningBalance" type="nsSAFT:SAFmonetaryType"
                      xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> Сума на дебитни начални салда.</xs:documentation>
                        <xs:documentation xml:lang="en"> Total Debit Opening Balance.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element name="TotalCreditOpeningBalance" type="nsSAFT:SAFmonetaryType"
                      xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> Сума на кредитни начални салда.</xs:documentation>
                        <xs:documentation xml:lang="en"> Total Credit Opening Balance.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element name="TotalDebit" type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> Сума на дебитен оборот.</xs:documentation>
                        <xs:documentation xml:lang="en"> Total Debit
												Turnover.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element name="TotalCredit" type="nsSAFT:SAFmonetaryType"
                      xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> Сума на кредитен оборот</xs:documentation>
                        <xs:documentation xml:lang="en"> Total Credit Turnover.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element name="TotalDebitClosingBalance" type="nsSAFT:SAFmonetaryType"
                      xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> Сума на дебитни крайни салда.</xs:documentation>
                        <xs:documentation xml:lang="en"> Total Debit Closing Balance.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element name="TotalCreditClosingBalance" type="nsSAFT:SAFmonetaryType"
                      xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> Сума на кредитни крайни салда.</xs:documentation>
                        <xs:documentation xml:lang="en"> Total Credit Closing Balance.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="ReportLine"
                      xdb:SQLType="REPORTLINE_T" xdb:SQLCollType="REPORTLINE_V">
                      <xs:complexType xdb:SQLType="REPORTLINE_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element name="LineNo" type="nsSAFT:SAFmiddle2textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Пореден номер на
												ред от справката.</xs:documentation>
                              <xs:documentation xml:lang="en"> Consecutive line number of the report. </xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="AccountID" type="nsSAFT:SAFmiddle2textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Код на аналитична
												счетоводна сметка, който трябва да съответства на
												предоставената номенклатура от сметки от НАП.
												от НАП.</xs:documentation>
                              <xs:documentation xml:lang="en"> This is the analytical account ID based on the nomenclature of accounts, provided by NRA.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="CorrespondingAccountID" type="nsSAFT:SAFmiddle2textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Код на
												кореспондираща аналитична счетоводна сметка, който
												трябва да съответства на предоставената номенклатура от сметки.</xs:documentation>
                              <xs:documentation xml:lang="en"> This is the
												corresponding analytical account ID based on the standard defined by the Bulgarian authorities, according to the presented nomenclature of accounts.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="Period" type="xs:nonNegativeInteger"
                            xdb:SQLType="NUMBER">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Счетоводен
												период</xs:documentation>
                              <xs:documentation xml:lang="en">Accounting
												Period</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="PeriodYear" type="xs:nonNegativeInteger"
                            xdb:SQLType="NUMBER">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Година на счетоводния
												период.</xs:documentation>
                              <xs:documentation xml:lang="en">The year of the
												Accounting Period.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element maxOccurs="unbounded" minOccurs="0" name="ReportLineValues"
                            xdb:SQLType="REPORTLINEVALUES_T" xdb:SQLCollType="REPORTLINEVALUES_V">
                            <xs:complexType xdb:SQLType="REPORTLINEVALUES_T" xdb:SQLSchema="SYSTEM">
                              <xs:sequence>
                                <xs:element name="DebitOpeningBalance" type="SAFmonetaryType"
                                  xdb:SQLType="NUMBER">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Дебитно начално
												салдо</xs:documentation>
                                    <xs:documentation xml:lang="en">Line Debit Opening
												Balance.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="CreditOpeningBalance" type="SAFmonetaryType"
                                  xdb:SQLType="NUMBER">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Кредитно начално
												салдо</xs:documentation>
                                    <xs:documentation xml:lang="en">Line Credit
												Opening Balance.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="DebitTurnover" type="SAFmonetaryType"
                                  xdb:SQLType="NUMBER">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Дебитен оборот за
												реда</xs:documentation>
                                    <xs:documentation xml:lang="en">Line Debit
												Turnover.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="CreditTurnover" type="SAFmonetaryType"
                                  xdb:SQLType="NUMBER">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Кредитен оборот за
												реда</xs:documentation>
                                    <xs:documentation xml:lang="en">Line Credit
												Turnover.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="DebitClosingBalance" type="SAFmonetaryType"
                                  xdb:SQLType="NUMBER">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Дебитно крайно
												салдо</xs:documentation>
                                    <xs:documentation xml:lang="en">Line Debit Closing
												Balance.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="CreditClosingBalance" type="SAFmonetaryType"
                                  xdb:SQLType="NUMBER">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Кредитно крайно
												салдо</xs:documentation>
                                    <xs:documentation xml:lang="en">Line Credit
												Closing Balance.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="GeneralLedgerEntries" xdb:SQLType="GENERALLEDGERENTRIES_T">
          <xs:annotation>
            <xs:documentation xml:lang="bg">Счетоводни операции.</xs:documentation>
            <xs:documentation xml:lang="en">Accounting transactions.</xs:documentation>
          </xs:annotation>
          <xs:complexType xdb:SQLType="GENERALLEDGERENTRIES_T" xdb:SQLSchema="SYSTEM">
            <xs:sequence>
              <xs:element minOccurs="0" name="NumberOfEntries" type="xs:nonNegativeInteger"
                xdb:SQLType="NUMBER">
                <xs:annotation>
                  <xs:documentation xml:lang="bg">Брой записи.</xs:documentation>
                  <xs:documentation xml:lang="en"> Number of entries.</xs:documentation>
                </xs:annotation>
              </xs:element>
              <xs:element minOccurs="0" name="TotalDebit" type="nsSAFT:SAFmonetaryType"
                xdb:SQLType="NUMBER">
                <xs:annotation>
                  <xs:documentation xml:lang="bg"> Обща сума на дебитите (в основна валута). Ако сумата е отрицателна, това следва да е указано със знак "-" (минус).</xs:documentation>
                  <xs:documentation xml:lang="en"> The total of all debit amounts in the header's default currency. The total of the debit amounts may be positive or negative. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
                </xs:annotation>
              </xs:element>
              <xs:element minOccurs="0" name="TotalCredit" type="nsSAFT:SAFmonetaryType"
                xdb:SQLType="NUMBER">
                <xs:annotation>
                  <xs:documentation xml:lang="bg"> Обща сума на кредитите (в основна валута). Ако сумата е отрицателна, това следва да е указано със знак "-" (минус).</xs:documentation>
                  <xs:documentation xml:lang="en"> The total of all credit amounts in the header's default currency. The total of the credit amounts may be positive or negative. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
                </xs:annotation>
              </xs:element>
              <xs:element maxOccurs="unbounded" minOccurs="0" name="Journal" xdb:SQLType="JOURNAL_T"
                xdb:SQLCollType="JOURNAL_V">
                <xs:annotation>
                  <xs:documentation xml:lang="bg">Информация за
										дневника.</xs:documentation>
                  <xs:documentation xml:lang="en">Journal
										information.</xs:documentation>
                </xs:annotation>
                <xs:complexType xdb:SQLType="JOURNAL_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element name="JournalID" type="nsSAFT:SAFshorttextType"
                      xdb:SQLType="VARCHAR2">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> Идентификационен код на журнала, източник на транзакцията.
Например, ако транзакцията е осчетоводена от журнал за плащания с код в информационната система - PAYMENTS, тогава елементът е със стойност PAYMENTS).</xs:documentation>
                        <xs:documentation xml:lang="en"> Source GL journal identifier, or invoices and payments in single ledger systems. For example - PAYMENTS for Journal Payments.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element name="Description" type="nsSAFT:SAFlongtextType"
                      xdb:SQLType="VARCHAR2">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> Описание на съответния код, посочен в предходния елемент. Например - Журнал Плащания.</xs:documentation>
                        <xs:documentation xml:lang="en"> Description of the Journal. For example - Payments journal.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element name="Type" type="nsSAFT:SAFcodeType" xdb:SQLType="VARCHAR2">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> Вид журнал (механизъм за групиране на журналите). Например - Accounts Payable (AP) тип журнали може да включват - журнал Плащания, журнал Фактури и т.н. и биха се обозначили с код AP..</xs:documentation>
                        <xs:documentation xml:lang="en"> Grouping mechanism for journals. For example - "AP" for Accounts Payable type, "AR" for Accounts Receivable, "GL" for General journal, etc.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element maxOccurs="unbounded" name="Transaction" xdb:SQLType="TRANSACTION_T"
                      xdb:SQLCollType="TRANSACTION_V">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> Счетоводни
												транзакции.</xs:documentation>
                        <xs:documentation xml:lang="en"> The accounting ledger
												transactions.</xs:documentation>
                      </xs:annotation>
                      <xs:complexType xdb:SQLType="TRANSACTION_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element name="TransactionID" type="nsSAFT:SAFmiddle2textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Идентификатор/референция към транзакцията.</xs:documentation>
                              <xs:documentation xml:lang="en"> Cross-reference to GL posting.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="Period" type="xs:nonNegativeInteger"
                            xdb:SQLType="NUMBER">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Счетоводен период.</xs:documentation>
                              <xs:documentation xml:lang="en"> Accounting Period.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="PeriodYear" type="xs:nonNegativeInteger"
                            xdb:SQLType="NUMBER">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Година на
												счетоводния период.</xs:documentation>
                              <xs:documentation xml:lang="en"> The year of the
												Accounting Period.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="TransactionDate" type="xs:date" xdb:SQLType="DATE">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Дата на документа/транзакцията.</xs:documentation>
                              <xs:documentation xml:lang="en"> Document date.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="SourceID" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Детайли за лицето или приложението, които са въвели/генерирали транзакцията.
Код и/или описание на вътрешен модул или външна информационна система (приложение), което е генерирало/осчетоводило транзакцията. Алтернативно, се посочва код/име/номер на потребител на информационната система, ако транзакцията е въведена ръчно.</xs:documentation>
                              <xs:documentation xml:lang="en"> Details of person
												or application that entered the
												transaction.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="TransactionType"
                            type="nsSAFT:SAFshorttextType" xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Вид на
												транзакцията в журнала: нормална, (автоматизирана)
												периодична и т.н.</xs:documentation>
                              <xs:documentation xml:lang="en"> Type of
												journal transaction: normal, (automated)
												periodically, etc.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="Description" type="nsSAFT:SAFlongtextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Описание на
												транзакцията.</xs:documentation>
                              <xs:documentation xml:lang="en">Description of
												Journal Transaction.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="BatchID" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Системно генериран
												идентификатор на пакет.</xs:documentation>
                              <xs:documentation xml:lang="en">Systems generated
												ID for batch.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="SystemEntryDate" type="xs:date" xdb:SQLType="DATE">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Системно запазена дата на въвеждане.</xs:documentation>
                              <xs:documentation xml:lang="en"> Date captured by system.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="GLPostingDate" type="xs:date" xdb:SQLType="DATE">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Дата на
												осчетоводяване.</xs:documentation>
                              <xs:documentation xml:lang="en"> Date posting to
												GL.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:choice minOccurs="0" maxOccurs="1">
                            <xs:element name="CustomerID" type="nsSAFT:SAFmiddle1textType"
                              xdb:SQLType="VARCHAR2">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg"> Уникален номер за идентифициране на икономическия оператор, издаден от държавната администрация.</xs:documentation>
                                <xs:documentation xml:lang="en"> Unique number to identify the economic operator, issued by relevant authorities.</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                            <xs:element name="SupplierID" type="nsSAFT:SAFmiddle1textType"
                              xdb:SQLType="VARCHAR2">
                              <xs:annotation>
                                <xs:documentation xml:lang="bg"> Уникален номер за идентифициране на икономическия оператор, издаден от държавната администрация.</xs:documentation>
                                <xs:documentation xml:lang="en"> Unique number to identify the economic operator, issued by relevant authorities.</xs:documentation>
                              </xs:annotation>
                            </xs:element>
                          </xs:choice>
                          <xs:element minOccurs="0" name="SystemID" type="nsSAFT:SAFshorttextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Уникален номер, създаден от системата за документа.</xs:documentation>
                              <xs:documentation xml:lang="en"> Unique number created by the system for the document.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element maxOccurs="unbounded" name="TransactionLine"
                            xdb:SQLType="TRANSACTIONLINE_T" xdb:SQLCollType="TRANSACTIONLINE_V">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Транзакционни
												линии.</xs:documentation>
                              <xs:documentation xml:lang="en">Transaction
												lines.</xs:documentation>
                            </xs:annotation>
                            <xs:complexType xdb:SQLType="TRANSACTIONLINE_T" xdb:SQLSchema="SYSTEM">
                              <xs:sequence>
                                <xs:element name="RecordID" type="nsSAFT:SAFshorttextType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Идентификатор на
												записа.</xs:documentation>
                                    <xs:documentation xml:lang="en"> Identifier to
												trace entry to journal line or posting
												reference.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="AccountID" type="nsSAFT:SAFmiddle2textType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Код на аналитична
												счетоводна сметка, който трябва да съответства на
												предоставената номенклатура от сметки
												от НАП.</xs:documentation>
                                    <xs:documentation xml:lang="en"> This is the
												analytical account ID based on the nomenclatures of accounts, provided by NRA.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="TaxpayerAccountID"
                                  type="nsSAFT:SAFmiddle1textType" xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> Номер на сметка от информационната система, използвана за счетоводно отчитане от данъкоплатеца.</xs:documentation>
                                    <xs:documentation xml:lang="en"> AccountID as used by the tax payer in their ERP/accounting system.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element maxOccurs="unbounded" minOccurs="0" name="Analysis"
                                  type="nsSAFT:AnalysisStructure" xdb:SQLType="ANALYSISSTRUCTURE_T"
                                  xdb:SQLCollType="ANALYSISSTRUCTURE_V">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Аналитични
												структури за Счетоводните
												записи</xs:documentation>
                                    <xs:documentation xml:lang="en">General Ledger
												analysis codes</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="ValueDate" type="xs:date"
                                  xdb:SQLType="DATE">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> Датата на влизане в сила (вальор) на транзакцията. Попълва се, когато е различна от датата на транзакцията.</xs:documentation>
                                    <xs:documentation xml:lang="en"> Effective date from which interest charged. To be reported when this date differs from the transaction date.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="SourceDocumentID"
                                  type="nsSAFT:SAFmiddle1textType" xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> Номер на документ, източник на транзакцията, към който реферира реда(например - номер на фактура).</xs:documentation>
                                    <xs:documentation xml:lang="en"> Source document number to which line relates (for example - invoice number).</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:choice minOccurs="0" maxOccurs="1">
                                  <xs:element name="CustomerID" type="nsSAFT:SAFmiddle1textType"
                                    xdb:SQLType="VARCHAR2">
                                    <xs:annotation>
                                      <xs:documentation xml:lang="bg"> Уникален номер за идентифициране на икономическия оператор, издаден от държавната администрация.</xs:documentation>
                                      <xs:documentation xml:lang="en"> Unique number to identify the economic operator, issued by relevant authorities.</xs:documentation>
                                    </xs:annotation>
                                  </xs:element>
                                  <xs:element name="SupplierID" type="nsSAFT:SAFmiddle1textType"
                                    xdb:SQLType="VARCHAR2">
                                    <xs:annotation>
                                      <xs:documentation xml:lang="bg"> Уникален номер за идентифициране на икономическия оператор, издаден от държавната администрация.</xs:documentation>
                                      <xs:documentation xml:lang="en"> Unique number to identify the economic operator, issued by relevant authorities.</xs:documentation>
                                    </xs:annotation>
                                  </xs:element>
                                </xs:choice>
                                <xs:element name="Description" type="nsSAFT:SAFlongtextType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Описание на реда
												на транзакцията.</xs:documentation>
                                    <xs:documentation xml:lang="en">Description of the
												Journal Line/Transaction.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:choice>
                                  <xs:element name="DebitAmount" type="nsSAFT:AmountStructure"
                                    xdb:SQLType="AMOUNTSTRUCTURE_T">
                                    <xs:annotation>
                                      <xs:documentation xml:lang="bg"> Информация за дебитната сума за транзакция
Дебитната сума може да бъде положителна или отрицателна, за да отрази сторно. Отрицателните суми се предхождат със знака минус ("-").</xs:documentation>
                                      <xs:documentation xml:lang="en"> Debit amount information for transaction
The debit amount may be positive or negative, to reflect the storno în black ink. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
                                    </xs:annotation>
                                  </xs:element>
                                  <xs:element name="CreditAmount" type="nsSAFT:AmountStructure"
                                    xdb:SQLType="AMOUNTSTRUCTURE_T">
                                    <xs:annotation>
                                      <xs:documentation xml:lang="bg"> Информация за кредитната сума за транзакция
Кредитната сума може да бъде положителна или отрицателна, за да отрази сторно. Отрицателните суми се предхождат със знака минус ("-").</xs:documentation>
                                      <xs:documentation xml:lang="en"> Credit amount information for transaction
The credit amount may be positive or negative, to reflect the storno in black ink. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
                                    </xs:annotation>
                                  </xs:element>
                                </xs:choice>
                                <xs:element maxOccurs="unbounded" name="TaxInformation"
                                  type="nsSAFT:TaxInformationStructure"
                                  xdb:SQLType="TAXINFORMATIONSTRUCTURE_T"
                                  xdb:SQLCollType="TAXINFORMATIONSTRUCTURE_V">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Данъчна информация
												за счетоводния ред.</xs:documentation>
                                    <xs:documentation xml:lang="en"> Tax information
												for the accounting line.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="SourceDocuments" xdb:SQLType="SOURCEDOCUMENTS_T">
          <xs:annotation>
            <xs:documentation xml:lang="bg">Изходни документи.</xs:documentation>
            <xs:documentation xml:lang="en">Source documents.</xs:documentation>
          </xs:annotation>
          <xs:complexType xdb:SQLType="SOURCEDOCUMENTS_T" xdb:SQLSchema="SYSTEM">
            <xs:sequence>
              <xs:element name="SalesInvoices" xdb:SQLType="SALESINVOICE_T">
                <xs:complexType xdb:SQLType="SALESINVOICE_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element minOccurs="0" name="NumberOfEntries" type="xs:nonNegativeInteger"
                      xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg">Брой
												записи</xs:documentation>
                        <xs:documentation xml:lang="en">Number of
												entries</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element minOccurs="0" name="TotalDebit" type="nsSAFT:SAFmonetaryType"
                      xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg">Общата сума на
												дебити (в основна валута). Ако сумата е отрицателна, това следва да е указано със знак "-" (минус).</xs:documentation>
                        <xs:documentation xml:lang="en"> The total of all
												debit amounts in the header's default
												currency. If the amount is negative, this should be indicated with a "-" (minus) sign. </xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element minOccurs="0" name="TotalCredit" type="nsSAFT:SAFmonetaryType"
                      xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg">Обща сума на кредити
												(в основна валута).Ако сумата е отрицателна, това следва да е указано със знак "-" (минус).</xs:documentation>
                        <xs:documentation xml:lang="en"> The total of all
												credit amounts in the header's default
												currency. If the amount is negative, this should be indicated with a "-" (minus) sign.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="Invoice"
                      type="nsSAFT:InvoiceStructure" xdb:SQLType="INVOICESTRUCTURE_T"
                      xdb:SQLCollType="INVOICESTRUCTURE_V"/>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element name="PurchaseInvoices" xdb:SQLType="PURCHASEINVOICE_T">
                <xs:complexType xdb:SQLType="PURCHASEINVOICE_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element minOccurs="0" name="NumberOfEntries" type="xs:nonNegativeInteger"
                      xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg">Брой
												записи</xs:documentation>
                        <xs:documentation xml:lang="en">Number of
												entries</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element minOccurs="0" name="TotalDebit" type="nsSAFT:SAFmonetaryType"
                      xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> Общата сума на
												дебитите (в основна валута).</xs:documentation>
                        <xs:documentation xml:lang="en"> The total of all
												debit amounts in the header's default
												currency.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element minOccurs="0" name="TotalCredit" type="nsSAFT:SAFmonetaryType"
                      xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> Общата сума на
												кредитите (в основна валута).</xs:documentation>
                        <xs:documentation xml:lang="en"> The total of all
												credit amounts in the header's default
												currency.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="Invoice"
                      type="nsSAFT:InvoiceStructure" xdb:SQLType="INVOICESTRUCTURE_T"
                      xdb:SQLCollType="INVOICESTRUCTURE_V"/>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element name="Payments" xdb:SQLType="PAYMENTS_T">
                <xs:complexType xdb:SQLType="PAYMENTS_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element minOccurs="0" name="NumberOfEntries" type="xs:nonNegativeInteger"
                      xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg">Брой
												записи</xs:documentation>
                        <xs:documentation xml:lang="en">Number of
												entries</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element minOccurs="0" name="TotalDebit" type="nsSAFT:SAFmonetaryType"
                      xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> Обща сума на
												дебитите (в основна валута).</xs:documentation>
                        <xs:documentation xml:lang="en"> The total of all
												debit amounts in the header's default
												currency.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element minOccurs="0" name="TotalCredit" type="nsSAFT:SAFmonetaryType"
                      xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> Обща сума на
												кредитите (в основна валута).</xs:documentation>
                        <xs:documentation xml:lang="en"> The total of all
												credit amounts in the header's default
												currency.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="Payment"
                      xdb:SQLType="PAYMENT_T" xdb:SQLCollType="PAYMENT_V">
                      <xs:complexType xdb:SQLType="PAYMENT_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element name="PaymentRefNo" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Уникален референтен номер за плащането.</xs:documentation>
                              <xs:documentation xml:lang="en"> Unique reference number for payment.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="Period" type="xs:nonNegativeInteger"
                            xdb:SQLType="NUMBER">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Счетоводен
												период</xs:documentation>
                              <xs:documentation xml:lang="en">Accounting
												Period</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="PeriodYear" type="xs:nonNegativeInteger"
                            xdb:SQLType="NUMBER">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Година на
												счетоводния период.</xs:documentation>
                              <xs:documentation xml:lang="en">The year of the
												Accounting Period.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="TransactionID"
                            type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Идентификатор/референция към транзакцията. Може
												да съдържа разходни центрове, организация,
												подразделения, регион, група, клон/отдел и
												др.</xs:documentation>
                              <xs:documentation xml:lang="en"> Cross-reference
												to GL posting. It can contain many different
												levels to identify the transaction. It could
												include cost centres such as company, division,
												region, group and
												branch/department.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="TransactionDate" type="xs:date" xdb:SQLType="DATE">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Дата на документа</xs:documentation>
                              <xs:documentation xml:lang="en">Document
												date</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="PaymentMethod" type="nsSAFT:SAFshorttextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Метод на плащане
												съгласно предоставената номенклатура</xs:documentation>
                              <xs:documentation xml:lang="en">Payment method,
												according to the presented nomenclature.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="Description" type="nsSAFT:SAFlongtextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Описание на
												плащането.</xs:documentation>
                              <xs:documentation xml:lang="en">Description of the
												payment.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="BatchID" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Системно генериран идентификатор на пакета, с който е осчетоводено плащането.</xs:documentation>
                              <xs:documentation xml:lang="en"> Systems generated ID for batch.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="SystemID" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Уникален идентификатор,
												генериран от информационната система на данъкоплатеца.</xs:documentation>
                              <xs:documentation xml:lang="en"> Unique number
												created by the system for the
												document</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="SourceID" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Детайли за лицето
												или приложението, които са въвели/генерирали
												транзакцията</xs:documentation>
                              <xs:documentation xml:lang="en"> Details of person
												or application that entered the
												transaction</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element maxOccurs="unbounded" name="PaymentLine"
                            xdb:SQLType="PAYMENTLINE_T" xdb:SQLCollType="PAYMENTLINE_V">
                            <xs:complexType xdb:SQLType="PAYMENTLINE_T" xdb:SQLSchema="SYSTEM">
                              <xs:sequence>
                                <xs:element minOccurs="0" name="LineNumber"
                                  type="nsSAFT:SAFshorttextType" xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Номер на
												реда на плащането</xs:documentation>
                                    <xs:documentation xml:lang="en">Number of the
												paymentline</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="SourceDocumentID"
                                  type="nsSAFT:SAFmiddle1textType" xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> Номер на документ, източник на транзакцията, към който реферира реда(например - номер на платежен документ).</xs:documentation>
                                    <xs:documentation xml:lang="en"> The source document to which the line relates.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="AccountID" type="nsSAFT:SAFmiddle2textType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Код на аналитична
												счетоводна сметка, който трябва да съответства на
												предоставената номенклатура на сметки от НАП.</xs:documentation>
                                    <xs:documentation xml:lang="en"> This is the analytical account ID based on the nomenclature of accounts, provided by NRA .</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element maxOccurs="unbounded" minOccurs="0" name="Analysis"
                                  type="nsSAFT:AnalysisStructure" xdb:SQLType="ANALYSISSTRUCTURE_T"
                                  xdb:SQLCollType="ANALYSISSTRUCTURE_V">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Аналитични
												структури за Счетоводните
												записи</xs:documentation>
                                    <xs:documentation xml:lang="en">General Ledger
												analysis codes</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="CustomerID" type="nsSAFT:SAFmiddle1textType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Уникален номер
											 	за идентифициране на икономическия оператор, издаден от държавната администрация.</xs:documentation>
                                    <xs:documentation xml:lang="en">Unique number
											 	to identify the economic operator, issued by relevant authorities.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="SupplierID" type="nsSAFT:SAFmiddle1textType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Уникален номер
												за идентифициране на икономическия оператор, издаден от държавната администрация.</xs:documentation>
                                    <xs:documentation xml:lang="en">Unique number
												to identify the economic operator, issued by relevant authorities.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="TaxPointDate" type="xs:date"
                                  xdb:SQLType="DATE">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Дата на данъчното
												събитие</xs:documentation>
                                    <xs:documentation xml:lang="en"> Tax Point date
												where recorded or if not recorded then the Invoice
												date</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="Description"
                                  type="nsSAFT:SAFlongtextType" xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Описание на
												реда на плащането.</xs:documentation>
                                    <xs:documentation xml:lang="en">Description of the
												payment line.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="DebitCreditIndicator" xdb:SQLType="XDB$ENUM_T">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Показва дали
												сумите на ниво ред са дебитни или кредитни суми
												("D" или "C", съответно).</xs:documentation>
                                    <xs:documentation xml:lang="en"> Indicates whether
												the amount on line-level are debit or credit
												amounts ("D" or "C").</xs:documentation>
                                  </xs:annotation>
                                  <xs:simpleType>
                                    <xs:restriction base="nsSAFT:SAFcodeType">
                                      <xs:enumeration value="D"/>
                                      <xs:enumeration value="C"/>
                                    </xs:restriction>
                                  </xs:simpleType>
                                </xs:element>
                                <xs:element name="PaymentLineAmount" type="nsSAFT:AmountStructure"
                                  xdb:SQLType="AMOUNTSTRUCTURE_T">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Сума за
												транзакцията.</xs:documentation>
                                    <xs:documentation xml:lang="en"> Amount for
												transaction.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element maxOccurs="unbounded" name="TaxInformation"
                                  type="nsSAFT:TaxInformationStructure"
                                  xdb:SQLType="TAXINFORMATIONSTRUCTURE_T"
                                  xdb:SQLCollType="TAXINFORMATIONSTRUCTURE_V"/>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                          <xs:element minOccurs="0" name="PaymentSettlement"
                            xdb:SQLType="PAYMENTSETTLEMENT_T">
                            <xs:complexType xdb:SQLType="PAYMENTSETTLEMENT_T" xdb:SQLSchema="SYSTEM">
                              <xs:sequence>
                                <xs:element minOccurs="0" name="SettlementDiscount"
                                  type="nsSAFT:SAFmiddle1textType" xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> Описание на
												отстъпка при плащане.</xs:documentation>
                                    <xs:documentation xml:lang="en"> Description
												Settlement / Other Discount</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="SettlementAmount"
                                  type="nsSAFT:AmountStructure" xdb:SQLType="AMOUNTSTRUCTURE_T">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Сума на
												разплащането (сетълмент)</xs:documentation>
                                    <xs:documentation xml:lang="en">Settlement
												amount</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="SettlementDate" type="xs:date"
                                  xdb:SQLType="DATE">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Дата на разплащане
												(сетълмент)</xs:documentation>
                                    <xs:documentation xml:lang="en">Date
												settled</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="PaymentMechanism"
                                  type="nsSAFT:SAFcodeType" xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Механизъм на
												плащане</xs:documentation>
                                    <xs:documentation xml:lang="en">Payment
												mechanism</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                          <xs:element minOccurs="0" name="PaymentDocumentTotals"
                            xdb:SQLType="PAYMENTDOCUMENTTOTALS_T">
                            <xs:complexType xdb:SQLType="PAYMENTDOCUMENTTOTALS_T"
                              xdb:SQLSchema="SYSTEM">
                              <xs:sequence>
                                <xs:element maxOccurs="unbounded" minOccurs="0"
                                  name="TaxInformationTotals" type="nsSAFT:TaxInformationStructure"
                                  xdb:SQLType="TAXINFORMATIONSTRUCTURE_T"
                                  xdb:SQLCollType="TAXINFORMATIONSTRUCTURE_V">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Контролни суми за
												по вид данък и TaxCode.Тази структура е част от общите суми за плащането, ако по отделните редове на конкретното плащане има начислени данъци, то те следва да бъдат сумирани (TaxBase и TaxAmount) по вид в този елемент.</xs:documentation>
                                    <xs:documentation xml:lang="en"> Control totals
												tax payable information. Per TaxType/TaxCode the
												TaxBase and TaxAmount are
												summarised.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="NetTotal"
                                  type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Обща сума без
												данъци и такси (в основна валута).</xs:documentation>
                                    <xs:documentation xml:lang="en"> Total amount
												excluding tax in the header's default
												currency.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="GrossTotal" type="nsSAFT:SAFmonetaryType"
                                  xdb:SQLType="NUMBER">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Обща сума,
												включително данъци и такси (в основна
												валута).</xs:documentation>
                                    <xs:documentation xml:lang="en"> Total amount
												including tax in the header's default
												currency.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element name="MovementOfGoods" xdb:SQLType="MOVEMENTOFGOODS_T">
                <xs:complexType xdb:SQLType="MOVEMENTOFGOODS_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element minOccurs="0" name="NumberOfMovementLines"
                      type="xs:nonNegativeInteger" xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg">Брой на
												записи.</xs:documentation>
                        <xs:documentation xml:lang="en">Number of
												movement lines in selected
												period.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element minOccurs="0" name="TotalQuantityReceived"
                      type="nsSAFT:SAFquantityType" xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg">Обща сума на
												получени стоки (в количествено изражение)</xs:documentation>
                        <xs:documentation xml:lang="en">Quantity of goods
												received</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element minOccurs="0" name="TotalQuantityIssued"
                      type="nsSAFT:SAFquantityType" xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg"> Обща сума на изписани стоки (в количествено изражение).</xs:documentation>
                        <xs:documentation xml:lang="en"> Quantity of goods issued in selected period.</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="StockMovement"
                      xdb:SQLType="STOCKMOVEMENT_T" xdb:SQLCollType="STOCKMOVEMENT_V">
                      <xs:complexType xdb:SQLType="STOCKMOVEMENT_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element name="MovementReference" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Уникален
												идентификатор на материалното
												движение от информационната система на данъкоплатеца.</xs:documentation>
                              <xs:documentation xml:lang="en">Unique reference
												to the movement, from the taxpayer information system.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="MovementDate" type="xs:date" xdb:SQLType="DATE">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Дата на документа,
												с който е заведено материалното движение.</xs:documentation>
                              <xs:documentation xml:lang="en">Document
												date</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="MovementPostingDate" type="xs:date"
                            xdb:SQLType="DATE">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Дата на
												осчетоводяване на движението.</xs:documentation>
                              <xs:documentation xml:lang="en"> Date of posting
												of the movement.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="MovementPostingTime" type="xs:time"
                            xdb:SQLType="TIMESTAMP">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Час на
												осчетоводяване на движението</xs:documentation>
                              <xs:documentation xml:lang="en">Time of posting of
												the movement</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="TaxPointDate" type="xs:date"
                            xdb:SQLType="DATE">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Дата на данъчното събитие.</xs:documentation>
                              <xs:documentation xml:lang="en">Date of supply of	goods.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="MovementType" type="nsSAFT:SAFcodeType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Вид на движението съгласно предоставената таблица.</xs:documentation>
                              <xs:documentation xml:lang="en"> The movementtype
												expresses the type of the process for the
												underlaying lines. E.g. production, sales,
												purchase. Nomenclature to be used.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="SourceID" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Детайли за лицето или приложението, които са въвели/генерирали транзакцията.</xs:documentation>
                              <xs:documentation xml:lang="en"> Details of person
												or application that entered the
												transaction</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="SystemID" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Уникален идентификатор,
												генериран от информационната система на
												данъкоплатеца</xs:documentation>
                              <xs:documentation xml:lang="en"> Unique number
												created by the system for the
												document</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="DocumentReference"
                            xdb:SQLType="DOCUMENTREFERENCE_T">
                            <xs:complexType xdb:SQLType="DOCUMENTREFERENCE_T" xdb:SQLSchema="SYSTEM">
                              <xs:sequence>
                                <xs:element name="DocumentType" type="nsSAFT:SAFshorttextType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Вид документ,
												съгласно данните в системата на данъкоплатеца</xs:documentation>
                                    <xs:documentation xml:lang="en">Type of document,
												according to the taxpayers information system data</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="DocumentNumber" type="nsSAFT:SAFmiddle1textType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Референтен номер
												на документа</xs:documentation>
                                    <xs:documentation xml:lang="en">Reference number
												of the document</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="DocumentLine"
                                  type="nsSAFT:SAFshorttextType" xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Номер на ред на
												документа</xs:documentation>
                                    <xs:documentation xml:lang="en">Line number of the
												document</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                          <xs:element maxOccurs="unbounded" name="StockMovementLine"
                            xdb:SQLType="STOCKMOVEMENTLINE_T" xdb:SQLCollType="STOCKMOVEMENTLINE_V">
                            <xs:complexType xdb:SQLType="STOCKMOVEMENTLINE_T" xdb:SQLSchema="SYSTEM">
                              <xs:sequence>
                                <xs:element name="LineNumber" type="nsSAFT:SAFshorttextType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Номер на реда
												на материалното движение</xs:documentation>
                                    <xs:documentation xml:lang="en">Number of the
												movementline</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="AccountID" type="nsSAFT:SAFmiddle2textType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Код на аналитична
												счетоводна сметка, който трябва да съответства на
												предоставената номенклатура от сметки
												от НАП.</xs:documentation>
                                    <xs:documentation xml:lang="en"> This is the analytical
												account ID based on the nomenclature of accounts, provided by the NRA.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="TransactionID"
                                  type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Идентификатор/референция към транзакцията. Може
												да съдържа разходни центрове, организация,
												подразделения, регион, група, клон/отдел и
												др.</xs:documentation>
                                    <xs:documentation xml:lang="en"> Cross-reference
												to GL posting. It can contain many different
												levels to identify the transaction. It could
												include cost centres such as company, division,
												region, group and
												branch/department.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="CustomerID" type="nsSAFT:SAFmiddle1textType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Уникален номер
												за идентифициране на икономическия оператор, издаден от държавната администрация.</xs:documentation>
                                    <xs:documentation xml:lang="en">Unique number
												to identify the economic operator, issued by relevant authorities.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="SupplierID" type="nsSAFT:SAFmiddle1textType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Уникален номер
												за идентифициране на икономическия оператор, издаден от държавната администрация.</xs:documentation>
                                    <xs:documentation xml:lang="en">Unique number
												to identify the economic operator, issued by relevant authorities.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="ShipTo"
                                  type="nsSAFT:ShippingPointStructure"
                                  xdb:SQLType="SHIPPINGPOINTSTRUCTURE_T">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Доставка до
												(детайли)</xs:documentation>
                                    <xs:documentation xml:lang="en">Ship To
												details</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="ShipFrom"
                                  type="nsSAFT:ShippingPointStructure"
                                  xdb:SQLType="SHIPPINGPOINTSTRUCTURE_T">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Доставка от
												(детайли)</xs:documentation>
                                    <xs:documentation xml:lang="en">Ship from
												Details</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="ProductCode" type="nsSAFT:SAFmiddle2textType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Код на
												продукт</xs:documentation>
                                    <xs:documentation xml:lang="en">Product
												code</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="StockAccountNo"
                                  type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Партида, сериен
												номер, не се използва при точно 1
												физически запис от продуктовия код</xs:documentation>
                                    <xs:documentation xml:lang="en"> Stock batch, lot,
												serial identification. Not used when there is
												exactly 1 PhysicalStock entry per
												ProductCode</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="Quantity" type="nsSAFT:SAFquantityType"
                                  xdb:SQLType="NUMBER">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Количество на
												стоките</xs:documentation>
                                    <xs:documentation xml:lang="en">Quantity of
												goods</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:sequence>
                                <xs:element name="UnitOfMeasure" type="nsSAFT:SAFcodeType"
                                    xdb:SQLType="VARCHAR2">
                                    <xs:annotation>
                                      <xs:documentation xml:lang="bg"> Мерна
												единица.</xs:documentation>
                                      <xs:documentation xml:lang="en"> Quantity unit of
												measure.</xs:documentation>
                                    </xs:annotation>
                                  </xs:element>
                                  <xs:element name="UOMToUOMPhysicalStockConversionFactor"
                                    type="xs:decimal" xdb:SQLType="NUMBER">
                                    <xs:annotation>
                                      <xs:documentation xml:lang="bg">Коефициент на
												преобразуване а единицата за количествено измерване (UOM) в мерната единица (UOM) на физическия запас.</xs:documentation>
                                      <xs:documentation xml:lang="en"> Conversion factor
												of the UOM to UOM Physical
												Stock</xs:documentation>
                                    </xs:annotation>
                                  </xs:element>
                                </xs:sequence>
                                <xs:element minOccurs="0" name="BookValue"
                                  type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> Осчетоводена стойност на транзакцията ( в основна валута).</xs:documentation>
                                    <xs:documentation xml:lang="en"> Value of the
												transaction line as registrerd in the general
												ledger in the header's default
												currency.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="MovementSubType" type="nsSAFT:SAFcodeType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg"> Вид на движението на ниво линия/статия. Производство
												на движение (тип) съдържа например използване на
												компоненти, получаване на завършен продукт, загуба
												на ефективност като подвидове движения и
												т.н.</xs:documentation>
                                    <xs:documentation xml:lang="en"> Type of the movement on line / article level. A
												movement(type) production contains f.i. use of
												components, getting finished product,
												efficiencyloss as movementsubtypes.</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element minOccurs="0" name="MovementComments"
                                  type="nsSAFT:SAFlongtextType" xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Основание за материалното движение</xs:documentation>
                                    <xs:documentation xml:lang="en">A reason for the
												movement</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element maxOccurs="unbounded" minOccurs="0"
                                  name="TaxInformation" type="nsSAFT:TaxInformationStructure"
                                  xdb:SQLType="TAXINFORMATIONSTRUCTURE_T"
                                  xdb:SQLCollType="TAXINFORMATIONSTRUCTURE_V"/>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element minOccurs="0" name="AssetTransactions" xdb:SQLType="ASSETTRANSACTIONS_T">
                <xs:annotation>
                  <xs:documentation xml:lang="bg">Подробности за всички
										транзакции, свързани с активи за избрания период. Тази
										секция се подава само при поискване от
										администрацията.</xs:documentation>
                  <xs:documentation xml:lang="en"> Details of all transactions
										related to an asset during the
										Selectionperiod. Filed only upon request from
the tax administration </xs:documentation>
                </xs:annotation>
                <xs:complexType xdb:SQLType="ASSETTRANSACTIONS_T" xdb:SQLSchema="SYSTEM">
                  <xs:sequence>
                    <xs:element name="NumberOfAssetTransactions" type="xs:nonNegativeInteger"
                      xdb:SQLType="NUMBER">
                      <xs:annotation>
                        <xs:documentation xml:lang="bg">Брой записи</xs:documentation>
                        <xs:documentation xml:lang="en"> Number of
												movement lines during selected
												period</xs:documentation>
                      </xs:annotation>
                    </xs:element>
                    <xs:element maxOccurs="unbounded" minOccurs="0" name="AssetTransaction"
                      xdb:SQLType="ASSETTRANSACTION_T" xdb:SQLCollType="ASSETTRANSACTION_V">
                      <xs:complexType xdb:SQLType="ASSETTRANSACTION_T" xdb:SQLSchema="SYSTEM">
                        <xs:sequence>
                          <xs:element name="AssetTransactionID" type="nsSAFT:SAFmiddle2textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Уникален
												идентификатор на транзакцията, генериран от системата на данъкоплатеца.</xs:documentation>
                              <xs:documentation xml:lang="en"> Unique
												Identification of the
												transaction, generated by the taxpayers system.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="AssetID" type="nsSAFT:SAFmiddle1textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Уникален код
												на актива, присвоен от задълженото лице (системно или ръчно)</xs:documentation>
                              <xs:documentation xml:lang="en">Unique identifier
												of the asset, assigned by the taxpayer (automatically via information system or manually)</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="AssetTransactionType" type="nsSAFT:SAFcodeType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Код на тип на
												транзакцията</xs:documentation>
                              <xs:documentation xml:lang="en">Code for the type
												of the transaction</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="Description" type="nsSAFT:SAFlongtextType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Описание на
												транзакцията</xs:documentation>
                              <xs:documentation xml:lang="en"> Description of
												the type of the transaction.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="AssetTransactionDate" type="xs:date" xdb:SQLType="DATE">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Дата на
												транзакцията</xs:documentation>
                              <xs:documentation xml:lang="en"> Recording date of
												the transaction type</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element minOccurs="0" name="AssetSupplier"
                            xdb:SQLType="ASSETSUPPLIER_T">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg"> Доставчик</xs:documentation>
                              <xs:documentation xml:lang="en"> Information about
												the supplier of the asset</xs:documentation>
                            </xs:annotation>
                            <xs:complexType xdb:SQLType="ASSETSUPPLIER_T" xdb:SQLSchema="SYSTEM">
                              <xs:sequence>
                                <xs:element name="SupplierName" type="nsSAFT:SAFmiddle2textType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Име на доставчик</xs:documentation>
                                    <xs:documentation xml:lang="en"> Name of the
												supplier of the asset</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="SupplierID" type="nsSAFT:SAFmiddle1textType"
                                  xdb:SQLType="VARCHAR2">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Уникален номер
												за идентифициране на икономическия оператор, издаден от държавната администрация.</xs:documentation>
                                    <xs:documentation xml:lang="en">Unique number
												to identify the economic operator, issued by relevant authorities</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                                <xs:element name="PostalAddress" type="nsSAFT:AddressStructure"
                                  xdb:SQLType="ADRESSSTRUCTURE_T">
                                  <xs:annotation>
                                    <xs:documentation xml:lang="bg">Адрес на
												доставчика</xs:documentation>
                                    <xs:documentation xml:lang="en"> Address
												information of the supplier of the
												asset</xs:documentation>
                                  </xs:annotation>
                                </xs:element>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                          <xs:element name="TransactionID" type="nsSAFT:SAFmiddle2textType"
                            xdb:SQLType="VARCHAR2">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Идентификатор/референция към транзакцията в Счетоводните записвания (GeneralLedgerEntries).
												Обикновено буквено-цифров или цифров идентификатор, генериран от
												информационната система на данъкоплатеца за конкретната транзакция.</xs:documentation>
                              <xs:documentation xml:lang="en"> Cross-reference
												to GL posting.
												Typically an alpha-numeric, or numeric identifier,
												generated by the taxpayer intormation system.</xs:documentation>
                            </xs:annotation>
                          </xs:element>
                          <xs:element name="AssetTransactionValuations"
                            xdb:SQLType="ASSETTRANSACTIONVALUATIONS_T">
                            <xs:annotation>
                              <xs:documentation xml:lang="bg">Структура от
												стойности в транзакцията (в зависимост от типа на
												транзакцията)</xs:documentation>
                              <xs:documentation xml:lang="en"> These amounts of
												the transaction can differ per asset valuation
												type.</xs:documentation>
                            </xs:annotation>
                            <xs:complexType xdb:SQLType="ASSETTRANSACTIONVALUATIONS_T"
                              xdb:SQLSchema="SYSTEM">
                              <xs:sequence>
                                <xs:element maxOccurs="unbounded" name="AssetTransactionValuation"
                                  xdb:SQLType="ASSETTRANSACTIONVALUATION_T"
                                  xdb:SQLCollType="ASSETTRANSACTIONVALUATION_V">
                                  <xs:complexType xdb:SQLType="ASSETTRANSACTIONVALUATION_T"
                                    xdb:SQLSchema="SYSTEM">
                                    <xs:sequence>
                                      <xs:element minOccurs="0" name="AssetValuationType"
                                        type="nsSAFT:SAFshorttextType" xdb:SQLType="VARCHAR2">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg"> Вид на данните ("SAP" или "DAP" за Счетоводен амортизационен план и Данъчен амортизационен план съответно) или "Other" за други цели.</xs:documentation>
                                          <xs:documentation xml:lang="en"> Describes the purpose for the reporting: - SAP (for accounting depreciation plan) or DAP (for Tax Depreciation plan) or Other for any other purpose</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:element name="AcquisitionAndProductionCostsOnTransaction"
                                        type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg">Разходи за
												придобиване (вкл. по стопански начин) на актива (в основна валута).</xs:documentation>
                                          <xs:documentation xml:lang="en"> Costs of
												acquisition and/or production of related asset
												transaction on the header's default currency at
												date of transaction.</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:element name="BookValueOnTransaction"
                                        type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg"> Балансова стойност на актива (в основна валута) след транзакцията.</xs:documentation>
                                          <xs:documentation xml:lang="en"> Bookvalue of related asset transaction in the header’s default currency at date of transaction.</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                      <xs:element name="AssetTransactionAmount"
                                        type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
                                        <xs:annotation>
                                          <xs:documentation xml:lang="bg"> Стойност на транзакцията (в основна валута).</xs:documentation>
                                          <xs:documentation xml:lang="en"> Net amount of related asset transaction in the header’s default currency, for instance the net sale revenue.</xs:documentation>
                                        </xs:annotation>
                                      </xs:element>
                                    </xs:sequence>
                                  </xs:complexType>
                                </xs:element>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:complexType name="InvoiceStructure" xdb:SQLType="INVOICESTRUCTURE_T" xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Съдържа информация за структурата на фактури за продажби
				и фактури за доставки.</xs:documentation>
      <xs:documentation xml:lang="en"> Containing all information about sales invoices and
				suppliers invoices.</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="InvoiceNo" type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
       <xs:annotation>
                    <xs:documentation xml:lang="bg"> Номер на фактура.</xs:documentation>
                    <xs:documentation xml:lang="en">Invoice number.</xs:documentation>
                  </xs:annotation>
                 </xs:element>
      <xs:choice>
        <xs:element name="CustomerInfo" minOccurs="1" xdb:SQLType="CUSTOMERINFO_T">
          <xs:complexType xdb:SQLType="CUSTOMERINFO_T" xdb:SQLSchema="SYSTEM">
            <xs:sequence>
              <xs:choice>
                <xs:element name="CustomerID" type="nsSAFT:SAFmiddle1textType"
                  xdb:SQLType="VARCHAR2">
                  <xs:annotation>
                    <xs:documentation xml:lang="bg">Уникален номер за идентифициране на икономическия оператор, издаден от държавната администрация.</xs:documentation>
                    <xs:documentation xml:lang="en">Unique number to identify the economic operator, issued by relevant authorities </xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element minOccurs="0" name="Name" type="nsSAFT:SAFmiddle2textType"
                  xdb:SQLType="VARCHAR2">
                  <xs:annotation>
                    <xs:documentation xml:lang="bg">Име на
											клиента</xs:documentation>
                    <xs:documentation xml:lang="en">Name of the
											customer</xs:documentation>
                  </xs:annotation>
                </xs:element>
              </xs:choice>
              <xs:element name="BillingAddress" type="nsSAFT:AddressStructure"
                xdb:SQLType="ADRESSSTRUCTURE_T"/>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="SupplierInfo" xdb:SQLType="SUPPLIERINFO_T">
          <xs:complexType xdb:SQLType="SUPPLIERINFO_T" xdb:SQLSchema="SYSTEM">
            <xs:sequence>
              <xs:choice>
                <xs:element name="SupplierID" type="nsSAFT:SAFmiddle1textType"
                  xdb:SQLType="VARCHAR2">
                  <xs:annotation>
                    <xs:documentation xml:lang="bg"> Уникален номер за идентифициране на икономическия оператор, издаден от държавната администрация.</xs:documentation>
                    <xs:documentation xml:lang="en">Unique number to identify the economic operator, issued by relevant authorities</xs:documentation>
                  </xs:annotation>
                </xs:element>
                <xs:element minOccurs="1" name="Name" type="nsSAFT:SAFmiddle2textType"
                  xdb:SQLType="VARCHAR2">
                  <xs:annotation>
                    <xs:documentation xml:lang="bg">Име на
											доставчика</xs:documentation>
                    <xs:documentation xml:lang="en">Name of the
											supplier</xs:documentation>
                  </xs:annotation>
                </xs:element>
              </xs:choice>
              <xs:element name="BillingAddress" type="nsSAFT:AddressStructure"
                xdb:SQLType="ADRESSSTRUCTURE_T"/>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:choice>
      <xs:element name="AccountID" type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg"> Код на аналитична счетоводна сметка, който трябва да съответства на предоставената номенклатура на сметки от НАП.</xs:documentation>
          <xs:documentation xml:lang="en"> This is the analytical account ID based on the nomenclatures of accounts, provided by NRA.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="BranchStoreNumber" type="nsSAFT:SAFmiddle1textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Номер на клон или магазин.</xs:documentation>
          <xs:documentation xml:lang="en"> Branch or Store number.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="Period" type="xs:nonNegativeInteger" xdb:SQLType="NUMBER">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Счетоводен период</xs:documentation>
          <xs:documentation xml:lang="en">Accounting Period</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="PeriodYear" type="xs:nonNegativeInteger" xdb:SQLType="NUMBER">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Година на счетоводния период.</xs:documentation>
          <xs:documentation xml:lang="en">The year of the Accounting
						Period.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="InvoiceDate" type="xs:date" xdb:SQLType="DATE"/>
      <xs:element name="InvoiceType" type="nsSAFT:SAFcodeType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Вид на фактура: Фактура, Дебитно известие,
						Кредитно известие и т.н. (съгласно предоставената от НАП
						таблица)</xs:documentation>
          <xs:documentation xml:lang="en"> Type of invoice: Debit invoice, Credit invoice,
						Cash, Ticket, etc.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="ShipTo" type="nsSAFT:ShippingPointStructure"
        xdb:SQLType="SHIPPINGPOINTSTRUCTURE_T">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Структура за адрес на доставка - крайна точка / дестинация</xs:documentation>
          <xs:documentation xml:lang="en">Ship To details</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="ShipFrom" type="nsSAFT:ShippingPointStructure"
        xdb:SQLType="SHIPPINGPOINTSTRUCTURE_T">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Структура за адреса за доставка - начална точка</xs:documentation>
          <xs:documentation xml:lang="en">Ship from Details</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="PaymentTerms" type="nsSAFT:SAFmiddle2textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Условия за плащане на
						фактурата</xs:documentation>
          <xs:documentation xml:lang="en">Payments terms for this
						invoice</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="SelfBillingIndicator" type="nsSAFT:SAFcodeType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg"> Индикатор, показващ дали за тази фактура се използва самофактуриране.</xs:documentation>
          <xs:documentation xml:lang="en"> Indicator showing if self-billing is used for
						this invoice.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="SourceID" type="nsSAFT:SAFmiddle1textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg"> Детайли за лицето или приложението, които са въвели/генерирали транзакцият.
Код и/или описание на вътрешен модул или външна информационна система (приложение), което е генерирало/осчетоводило транзакцията. Алтернативно, се посочва код/име/номер на потребител на информационната система, ако транзакцията е въведена ръчно.</xs:documentation>
          <xs:documentation xml:lang="en"> Details of person or application that entered
						the transaction. Code and/or description of internal module or external information system (application) that generated/posted the transaction. Alternatively, an information system user code/name/number is provided if the transaction is entered manually.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="GLPostingDate" type="xs:date" xdb:SQLType="DATE">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Дата на осчетоводяване</xs:documentation>
          <xs:documentation xml:lang="en">Date posting to GL</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="BatchID" type="nsSAFT:SAFmiddle1textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Системно генериран идентификатор на
						пакет</xs:documentation>
          <xs:documentation xml:lang="en">Systems generated ID for
						batch</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="SystemID" type="nsSAFT:SAFmiddle1textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg"> Уникален идентификатор, генериран от информационната система на данъкоплатеца.</xs:documentation>
          <xs:documentation xml:lang="en">Unique number created by the system for the
						document</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="TransactionID" type="nsSAFT:SAFmiddle2textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Идентификатор/референция към транзакцията.</xs:documentation>
          <xs:documentation xml:lang="en">Cross-reference to GL posting.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="ReceiptNumbers" type="nsSAFT:SAFlongtextType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Номера на стокови разписки в този "консолидиран запис на фактурата". Може да бъде едно число, диапазон или списък. </xs:documentation>
          <xs:documentation xml:lang="en"> The number(s) of the receipt(s) on this “consolidated invoice record”. Can be a single number, a range or a list.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element maxOccurs="unbounded" name="InvoiceLine" xdb:SQLType="INVOICELINE_T"
        xdb:SQLCollType="INVOCELINE_V">
        <xs:complexType xdb:SQLType="INVOICELINE_T" xdb:SQLSchema="SYSTEM">
          <xs:sequence>
            <xs:element minOccurs="0" name="LineNumber" type="nsSAFT:SAFshorttextType"
              xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Номер на ред от
									фактура</xs:documentation>
                <xs:documentation xml:lang="en">Number of the
									invoice line</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element name="AccountID" type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Код на аналитична счетоводна сметка, който трябва да съответства на предоставената номенклатура на сметки от НАП </xs:documentation>
                <xs:documentation xml:lang="en"> This is the analytical account ID based on the nomenclatures of accounts, provided by NRA .</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element maxOccurs="unbounded" minOccurs="0" name="Analysis"
              type="nsSAFT:AnalysisStructure" xdb:SQLCollType="ANALYSISSTRUCTURE_V"
              xdb:SQLType="ANALYSISSTRUCTURE_T">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Аналитични структури за Счетоводните
									записи</xs:documentation>
                <xs:documentation xml:lang="en">General Ledger analysis
									codes</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element maxOccurs="unbounded" minOccurs="0" name="OrderReferences"
              xdb:SQLType="ORDERREFERENCES_T" xdb:SQLCollType="ORDERREFERENCES_V">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Референции към
									поръчки</xs:documentation>
                <xs:documentation xml:lang="en">Relevant order
									references</xs:documentation>
              </xs:annotation>
              <xs:complexType xdb:SQLType="ORDERREFERENCES_T" xdb:SQLSchema="SYSTEM">
                <xs:sequence>
                  <xs:element minOccurs="0" name="OriginatingON" type="nsSAFT:SAFmiddle2textType"
                    xdb:SQLType="VARCHAR2">
                    <xs:annotation>
                      <xs:documentation xml:lang="bg">Номер на начална
												поръчка</xs:documentation>
                      <xs:documentation xml:lang="en">Origination Order
												Number</xs:documentation>
                    </xs:annotation>
                  </xs:element>
                  <xs:element minOccurs="0" name="OrderDate" type="xs:date" xdb:SQLType="DATE">
                    <xs:annotation>
                      <xs:documentation xml:lang="bg">Дата на
												поръчка</xs:documentation>
                      <xs:documentation xml:lang="en">Date of
												order</xs:documentation>
                    </xs:annotation>
                  </xs:element>
                </xs:sequence>
              </xs:complexType>
            </xs:element>
            <xs:element minOccurs="0" name="ShipTo" type="nsSAFT:ShippingPointStructure"
              xdb:SQLType="SHIPPINGPOINTSTRUCTURE_T">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Доставка до
									(детайли)</xs:documentation>
                <xs:documentation xml:lang="en">Ship To details</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" name="ShipFrom" type="nsSAFT:ShippingPointStructure"
              xdb:SQLType="SHIPPINGPOINTSTRUCTURE_T">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Доставка от
									(детайли)</xs:documentation>
                <xs:documentation xml:lang="en">Ship from Details</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" name="GoodsServicesID" type="nsSAFT:SAFcodeType"
              xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Индикатор за стоки (01) или услуги
									(02)</xs:documentation>
                <xs:documentation xml:lang="en">Indicator showing if goods (01) or services (02)</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" name="ProductCode" type="nsSAFT:SAFmiddle2textType"
              xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Код на продукт</xs:documentation>
                <xs:documentation xml:lang="en">Product code</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" name="ProductDescription" type="nsSAFT:SAFlongtextType"
              xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Описание на
									продукта</xs:documentation>
                <xs:documentation xml:lang="en">Description of goods or
									services.</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" name="Delivery" xdb:SQLType="DELIVERY_T">
              <xs:annotation>
                <xs:documentation xml:lang="bg"> Информация за дата или времева рамка за доставката на стоките или услугите.</xs:documentation>
                <xs:documentation xml:lang="en"> Information about the date or timeframe of the delivery of goods or services.</xs:documentation>
              </xs:annotation>
              <xs:complexType xdb:SQLType="DELIVERY_T" xdb:SQLSchema="SYSTEM">
                <xs:choice>
                  <xs:element maxOccurs="unbounded" name="MovementReference"
                    type="nsSAFT:SAFmiddle1textType" xdb:SQLCollType="MOVEMENTREFERENCE_V"
                    xdb:SQLType="VARCHAR2">
                    <xs:annotation>
                      <xs:documentation xml:lang="bg"> Уникален идентификатор на материалното движение от информационната система на данъкоплатеца. </xs:documentation>
                      <xs:documentation xml:lang="en">Unique reference to the movement, from the taxpayer information system.</xs:documentation>
                    </xs:annotation>
                  </xs:element>
                  <xs:element name="DeliveryDate" type="xs:date" xdb:SQLType="DATE">
                    <xs:annotation>
                      <xs:documentation xml:lang="bg">Дата на доставка</xs:documentation>
                      <xs:documentation xml:lang="en">The date of the
												delivery</xs:documentation>
                    </xs:annotation>
                  </xs:element>
                  <xs:element name="DeliveryPeriod" xdb:SQLType="DELIVERYPERIOD_T">
                    <xs:annotation>
                      <xs:documentation xml:lang="bg">Времева рамка на
												доставка</xs:documentation>
                      <xs:documentation xml:lang="en">Timeframe of the
												deliveries</xs:documentation>
                    </xs:annotation>
                    <xs:complexType xdb:SQLType="DELIVERYPERIOD_T" xdb:SQLSchema="SYSTEM">
                      <xs:sequence>
                        <xs:element name="FromDate" type="xs:date" xdb:SQLType="DATE">
                          <xs:annotation>
                            <xs:documentation xml:lang="bg">Начална дата на
												доставките</xs:documentation>
                            <xs:documentation xml:lang="en">Startdate of the
												deliveries</xs:documentation>
                          </xs:annotation>
                        </xs:element>
                        <xs:element name="ToDate" type="xs:date" xdb:SQLType="DATE">
                          <xs:annotation>
                            <xs:documentation xml:lang="bg">Крайна дата на
												доставките</xs:documentation>
                            <xs:documentation xml:lang="en">End date of the
												deliveries</xs:documentation>
                          </xs:annotation>
                        </xs:element>
                      </xs:sequence>
                    </xs:complexType>
                  </xs:element>
                </xs:choice>
              </xs:complexType>
            </xs:element>
            <xs:element name="Quantity" type="nsSAFT:SAFquantityType" xdb:SQLType="NUMBER">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Количество на доставените стоки или
									услуги</xs:documentation>
                <xs:documentation xml:lang="en">Quantity of goods and services
									supplied.</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" name="InvoiceUOM" type="nsSAFT:SAFcodeType"
              xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Мерна единица</xs:documentation>
                <xs:documentation xml:lang="en">Quantity unit of measure e.g. pack
									of 12</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" name="UOMToUOMBaseConversionFactor" type="xs:decimal"
              xdb:SQLType="NUMBER">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Коефициент на преобразуване на InvoiceUOM в UOMBase. Необходимо е само когато се отчита InvoiceUOM и ако е различен от UOMBase.</xs:documentation>
                <xs:documentation xml:lang="en"> Conversion factor of the InvoiceUOM to UOMBase. Only needed when InvoiceUOM is reported and if different from the UOMBase.</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element name="UnitPrice" type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Единична цена за единица/група от
									единици за UOM (в основна валута).</xs:documentation>
                <xs:documentation xml:lang="en"> Unit price for the unit/group of
									units per UOM in the header's default
									currency.</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element name="TaxPointDate" type="xs:date" xdb:SQLType="DATE">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Дата на данъчното
									събитие</xs:documentation>
                <xs:documentation xml:lang="en"> Tax Point date where recorded or if
									not recorded then the Invoice date</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" name="References" xdb:SQLType="REFERENCES_T">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Референции към кредитни
									известия</xs:documentation>
                <xs:documentation xml:lang="en">Credit Note
									references</xs:documentation>
              </xs:annotation>
              <xs:complexType xdb:SQLType="REFERENCES_T" xdb:SQLSchema="SYSTEM">
                <xs:sequence>
                  <xs:element minOccurs="0" name="CreditNote" xdb:SQLType="CREDITNOTE_T">
                    <xs:complexType xdb:SQLType="CREDITNOTE_T" xdb:SQLSchema="SYSTEM">
                      <xs:sequence>
                        <xs:element minOccurs="0" name="Reference" type="nsSAFT:SAFmiddle1textType"
                          xdb:SQLType="VARCHAR2">
                          <xs:annotation>
                            <xs:documentation xml:lang="bg">Препратка (номер или друг идентификатор) към кредитното известие (ако е приложимо), издадено за тази фактура.</xs:documentation>
                            <xs:documentation xml:lang="en"> Credit note
												reference (where applicable) to original
												invoice</xs:documentation>
                          </xs:annotation>
                        </xs:element>
                        <xs:element minOccurs="0" name="Reason" type="nsSAFT:SAFlongtextType"
                          xdb:SQLType="VARCHAR2">
                          <xs:annotation>
                            <xs:documentation xml:lang="bg">Основание за
												кредитното известие</xs:documentation>
                            <xs:documentation xml:lang="en">Credit note reason
												or rationale</xs:documentation>
                          </xs:annotation>
                        </xs:element>
                      </xs:sequence>
                    </xs:complexType>
                  </xs:element>
                </xs:sequence>
              </xs:complexType>
            </xs:element>
            <xs:element name="Description" type="nsSAFT:SAFlongtextType" xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Описание на реда на
									фактурата</xs:documentation>
                <xs:documentation xml:lang="en">Description of Invoice
									Line.</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element name="InvoiceLineAmount" type="nsSAFT:AmountStructure"
              xdb:SQLType="AMOUNTSTRUCTURE_T">
              <xs:annotation>
                <xs:documentation xml:lang="bg"> Сума на реда, която не включва данъци, такси и транспортни разходи. </xs:documentation>
                <xs:documentation xml:lang="en"> Amount for transaction excluding taxes and freight charges.</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element name="DebitCreditIndicator" xdb:SQLType="XDB$ENUM_T">
              <xs:annotation>
                <xs:documentation xml:lang="bg"> Показва дали сумите на ниво ред са дебитни или кредитни суми. Записът трябва да съответства на записа, отразен в "Счетоводен запис" (GeneralLedgerEntries). Знакът на реда е свързан с този индикатор. Например връщане/сторно могат да са отрицателни суми. </xs:documentation>
                <xs:documentation xml:lang="en"> Indicates whether the amounts on line-level are debit or credit amounts. Entry must correspond to entry reflected in General Ledger Entry. Signing of lineamounts is relative to this indicator. E.g. a return can lead to a negative amount.</xs:documentation>
              </xs:annotation>
              <xs:simpleType>
                <xs:restriction base="nsSAFT:SAFcodeType">
                  <xs:enumeration value="D"/>
                  <xs:enumeration value="C"/>
                </xs:restriction>
              </xs:simpleType>
            </xs:element>
            <xs:element minOccurs="0" name="ShippingCostsAmount" type="nsSAFT:AmountStructure"
              xdb:SQLType="AMOUNTSTRUCTURE_T">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Сума на транспортни разходи.</xs:documentation>
                <xs:documentation xml:lang="en">Amount for shipping/freight
									charges.</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element maxOccurs="unbounded" name="TaxInformation"
              type="nsSAFT:TaxInformationStructure" xdb:SQLCollType="TAXINFORMATIONSTRUCTURE_V"
              xdb:SQLType="TAXINFORMATIONSTRUCTURE_T"/>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element minOccurs="0" name="InvoiceSettlement" xdb:SQLType="INVOICESETTLEMENT_T">
        <xs:complexType xdb:SQLType="INVOICESETTLEMENT_T" xdb:SQLSchema="SYSTEM">
          <xs:sequence>
            <xs:element minOccurs="0" name="SettlementDiscount" type="nsSAFT:SAFmiddle1textType"
              xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Описание на
									отстъпката</xs:documentation>
                <xs:documentation xml:lang="en">Description Settlement / Other
									Discount</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element name="SettlementAmount" type="nsSAFT:AmountStructure"
              xdb:SQLType="AMOUNTSTRUCTURE_T">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Сума на плащане по фактура.</xs:documentation>
                <xs:documentation xml:lang="en">Settlement amount</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" name="SettlementDate" type="xs:date" xdb:SQLType="DATE">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Дата на плащане</xs:documentation>
                <xs:documentation xml:lang="en">Date settled</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" name="PaymentMechanism" type="nsSAFT:SAFcodeType"
              xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Механизъм на плащане, съгласно предоставената номенклатура (Nom_PaymentMethod).</xs:documentation>
                <xs:documentation xml:lang="en">Payment mechanism, according ot the Nom_PaymentMethod. </xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element minOccurs="0" name="InvoiceDocumentTotals" xdb:SQLType="INVOICEDOCUMENTTOTALS_T">
        <xs:complexType xdb:SQLType="INVOICEDOCUMENTTOTALS_T" xdb:SQLSchema="SYSTEM">
          <xs:sequence>
            <xs:element maxOccurs="unbounded" minOccurs="0" name="TaxInformationTotals"
              type="nsSAFT:TaxInformationStructure" xdb:SQLType="TAXINFORMATIONSTRUCTURE_T"
              xdb:SQLCollType="TAXINFORMATIONSTRUCTURE_V">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Контролни суми по вид данък и
									TaxCode</xs:documentation>
                <xs:documentation xml:lang="en"> Control totals tax payable
									information. Per TaxType/TaxCode the TaxBase and TaxAmount are
									summarised.</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" name="ShippingCostsAmountTotal" type="nsSAFT:SAFmonetaryType"
              xdb:SQLType="NUMBER">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Контролни суми за транспортни
									разходи</xs:documentation>
                <xs:documentation xml:lang="en">Control total amount freight
									charges (i.e. sum of ShippingCostAmount)</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element name="NetTotal" type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Контролна сума за фактурата, без данъци, такси и транспортни разходи. Полето съдържа сума на InvoiceLineAmount от редовете на документа.</xs:documentation>
                <xs:documentation xml:lang="en"> Control total sales value excluding tax and shipping costs (i.e. sum of InvoiceLineAmount).</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element name="GrossTotal" type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Контролна сума за фактурата, включително данъци, такси и транспортни разходи. Обща сума на фактурата - следва да съдържа сума на InvoiceLineAmount, ShippingCostAmount и TaxAmount от всички редове на документа. </xs:documentation>
                <xs:documentation xml:lang="en">Control total amount including tax and shipping costs (comprising sum of all InvoiceLineAmount, ShippingCostAmount, TaxAmount).</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="ShippingPointStructure" xdb:SQLType="SHIPPINGPOINTSTRUCTURE_T"
    xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Структура, която съдържа цялата информация за точката на
				доставка.</xs:documentation>
      <xs:documentation xml:lang="en">A structure that holds all shipping point
				information.</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="DeliveryID" type="nsSAFT:SAFmiddle1textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Идентификатор на доставката</xs:documentation>
          <xs:documentation xml:lang="en">Identification of the
						delivery</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="DeliveryDate" type="xs:date" xdb:SQLType="DATE">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Дата на доставка на стоките</xs:documentation>
          <xs:documentation xml:lang="en">Date goods are delivered</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="WarehouseID" type="nsSAFT:SAFmiddle1textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Складът, в който се съхраняват стоките, следва
						да се включат складови или производствени помещения и площадки с незавършено
						производство, както и превозни средства или други, които съдържат стоки на
						път</xs:documentation>
          <xs:documentation xml:lang="en"> Warehouse where goods held - also to identify
						work-in-progress, or stock-in-transit</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="LocationID" type="nsSAFT:SAFshorttextType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Локация на стоките в склада</xs:documentation>
          <xs:documentation xml:lang="en">Location of goods in
						warehouse</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="UCR" type="nsSAFT:SAFmiddle1textType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Уникален идентификатор на консигнационна
						стока</xs:documentation>
          <xs:documentation xml:lang="en">Unique consignment reference
						number</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="Address" type="nsSAFT:AddressStructure"
        xdb:SQLCollType="ADDRESS_V" xdb:SQLType="ADRESSSTRUCTURE_T"/>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="AddressStructure" xdb:SQLType="ADRESSSTRUCTURE_T" xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Обща структура, използвана навсякъде, където се изисква
				адрес.</xs:documentation>
      <xs:documentation xml:lang="en">A common structure used wherever an address is
				required.</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="StreetName" type="nsSAFT:SAFmiddle2textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Адресен ред 1. Обикновено име на улица или
						пощенска кутия. Може да включва и номер на сграда.</xs:documentation>
          <xs:documentation xml:lang="en"> Address line 1. Normally street name or post
						box. Can also include house number.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="Number" type="nsSAFT:SAFshorttextType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Адрес на ред 1. Номер на сградата, ако има
						такъв.</xs:documentation>
          <xs:documentation xml:lang="en">Address line 1. House number if
						available.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="AdditionalAddressDetail" type="nsSAFT:SAFmiddle2textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Втори ред за адрес</xs:documentation>
          <xs:documentation xml:lang="en">Address line 2.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="Building" type="nsSAFT:SAFmiddle1textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Идентификатор на сграда (номер, буквено
						означение, и т.н.)</xs:documentation>
          <xs:documentation xml:lang="en">Identification of the building (e.g. Building A)</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="City" type="nsSAFT:SAFmiddle1textType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Населено място</xs:documentation>
          <xs:documentation xml:lang="en">Name of the city/post
						district.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="PostalCode" type="nsSAFT:SAFshorttextType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Пощенски код</xs:documentation>
          <xs:documentation xml:lang="en">Postal code for the relevant city/post
						district.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="Region" type="nsSAFT:SAFmiddle1textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Регион на съответната данъчна
						администрация</xs:documentation>
          <xs:documentation xml:lang="en"> Country specific code to indicate regions /
						provinces within the tax authority.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="Country" type="nsSAFT:ISOCountryCode" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Двубуквен код на държава съгласноl ISO 3166-2-CountryCodes.</xs:documentation>
          <xs:documentation xml:lang="en"> Two-letter country code according to ISO 3166-2-CountryCodes standard. Example BG for Bulgaria. </xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="AddressType" xdb:SQLType="XDB$ENUM_T">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Тип адрес. Изберете от списъка с примери:
						StreetAddress, PostalAddress, BillingAddress, ShipToAddress,
						ShipFromAddress.</xs:documentation>
          <xs:documentation xml:lang="en"> Field to differentiate between multiple
						addresses and to indicate the type of address. Choose from the predefined
						enumerations: StreetAddress, PostalAddress, BillingAddress, ShipToAddress,
						ShipFromAddress.</xs:documentation>
        </xs:annotation>
        <xs:simpleType>
          <xs:restriction base="xs:string">
            <xs:enumeration value="StreetAddress"/>
            <xs:enumeration value="PostalAddress"/>
            <xs:enumeration value="BillingAddress"/>
            <xs:enumeration value="ShipToAddress"/>
            <xs:enumeration value="ShipFromAddress"/>
          </xs:restriction>
        </xs:simpleType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="OwnershipStructure" xdb:SQLType="OWNERSHIPSTRUCTURE_T"
    xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Използва се за описание на собствеността на
				компанията</xs:documentation>
      <xs:documentation xml:lang="en">Used to describe the ownership of the
				company</xs:documentation>
    </xs:annotation>
    <!-- Main element -->
    <xs:sequence>
      <!-- Section 1 -->
      <xs:element name="IsPartOfGroup" xdb:SQLType="XDB$ENUM_T">
        <xs:simpleType>
          <xs:restriction base="nsSAFT:SAFmiddle1textType">
            <xs:enumeration value="Yes - HQ of local"/>
            <xs:enumeration value="Yes - HQ of multinational"/>
            <xs:enumeration value="Yes - part of local"/>
            <xs:enumeration value="Yes - part of multinational"/>
            <xs:enumeration value="No"/>
          </xs:restriction>
        </xs:simpleType>
      </xs:element>
      <xs:element minOccurs="0" name="UltimateOwnerNameCyrillic" type="nsSAFT:SAFmiddle2textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
                <xs:documentation xml:lang="bg">Наименование на действиетелния собственик на кирилица.</xs:documentation>
                <xs:documentation xml:lang="en">Utliamte owner name in Cyrillic.</xs:documentation>
              </xs:annotation>
                   </xs:element>
      <xs:element minOccurs="0" name="UltimateOwnerNameLatin" type="nsSAFT:SAFmiddle2textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
                <xs:documentation xml:lang="bg">Наименование на действиетелния собственик на латиница.</xs:documentation>
                <xs:documentation xml:lang="en"> Utliamte owner name in Latin.</xs:documentation>
              </xs:annotation>
                   </xs:element>
      <xs:element minOccurs="0" name="UltimateOwnerUIC" type="nsSAFT:SAFmiddle1textType"
        xdb:SQLType="VARCHAR2">
          <xs:annotation>
                <xs:documentation xml:lang="bg">ЕИК на действителния собственик (юридическо лице).</xs:documentation>
                <xs:documentation xml:lang="en"> Ultimate owner Unique Identification Number.</xs:documentation>
              </xs:annotation>
                   </xs:element>
      <xs:element minOccurs="0" name="UltimateOwnerEGN" type="nsSAFT:SAFmiddle1textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
                <xs:documentation xml:lang="bg">ЕГН на действителният собственик (физическо лице).</xs:documentation>
                <xs:documentation xml:lang="en"> Ultimate owner personal identification number (EGN).</xs:documentation>
              </xs:annotation>
                   </xs:element>
      <!-- Section 2 -->
      <xs:element name="GroupIdentification" xdb:SQLType="GROUPIDENTIFICATION_T">
        <xs:complexType xdb:SQLType="GROUPIDENTIFICATION_T" xdb:SQLSchema="SYSTEM">
          <xs:sequence minOccurs="0">
            <xs:element name="GroupNameCyrillic" type="nsSAFT:SAFmiddle2textType"
              xdb:SQLType="VARCHAR2">
               <xs:annotation>
                <xs:documentation xml:lang="bg">Наименование на ГП (кирилица).</xs:documentation>
                <xs:documentation xml:lang="en">Group name in cyrillic.</xs:documentation>
              </xs:annotation>
                   </xs:element>
            <xs:element name="GroupNameLatin" type="nsSAFT:SAFmiddle2textType"
              xdb:SQLType="VARCHAR2">
               <xs:annotation>
                <xs:documentation xml:lang="bg">Наименование на ГП (латиница).</xs:documentation>
                <xs:documentation xml:lang="en">Group name in latin.</xs:documentation>
              </xs:annotation>
                   </xs:element>
            <xs:element name="Country" type="nsSAFT:ISOCountryCode" xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Държава на регистрация на ГП (предприятие – майка), Код ISO.</xs:documentation>
                <xs:documentation xml:lang="en">Country code of the country where the group is registered. ISO. </xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <!-- Section 3 -->
      <xs:element name="DirectOwnerIdentification" xdb:SQLType="DIRECTOWNERIDENTIFICATION_T">
        <xs:complexType xdb:SQLType="DIRECTOWNERIDENTIFICATION_T" xdb:SQLSchema="SYSTEM">
          <xs:sequence minOccurs="0">
            <xs:element name="OwnerNameCyrillic" type="nsSAFT:SAFmiddle2textType"
              xdb:SQLType="VARCHAR2">
               <xs:annotation>
                <xs:documentation xml:lang="bg">Наименование на собственика (кирилица)
Пряк собственик с най-голям процент на притежание (може и по-малко от 50 % от собствения капитал, акции и др.).</xs:documentation>
                <xs:documentation xml:lang="en">Owner name in cyrillic.</xs:documentation>
              </xs:annotation>
                   </xs:element>
            <xs:element name="LegalFormCyrillic" type="nsSAFT:SAFmiddle2textType"
              xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Правна форма (кирилица).</xs:documentation>
                <xs:documentation xml:lang="en">Legal form in cyrillic.</xs:documentation>
              </xs:annotation>
                   </xs:element>
            <xs:element name="OwnerNameLatin" type="nsSAFT:SAFmiddle2textType"
              xdb:SQLType="VARCHAR2">
               <xs:annotation>
                <xs:documentation xml:lang="bg">Наименование на собственика (латиница)
пряк собственик с най-голям процент на притежание (може и по-малко от 50 % от собствения капитал, акции и др.).</xs:documentation>
                <xs:documentation xml:lang="en">Owner name in latin.</xs:documentation>
              </xs:annotation>
                   </xs:element>
            <xs:element name="LegalFormLatin" type="nsSAFT:SAFmiddle2textType"
              xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Правна форма (латиница).</xs:documentation>
                <xs:documentation xml:lang="en">Legal form in Latin.</xs:documentation>
              </xs:annotation>
                   </xs:element>
            <xs:element minOccurs="0" name="OwnerCountry" type="nsSAFT:ISOCountryCode"
              xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Държава на собственика, Код ISO.</xs:documentation>
                <xs:documentation xml:lang="en"> Country code of the owner.</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" name="OwnerUIC" type="nsSAFT:SAFmiddle1textType"
              xdb:SQLType="VARCHAR2">
               <xs:annotation>
                <xs:documentation xml:lang="bg">ЕИК на собственика (ако е българско юридическо лице).</xs:documentation>
                <xs:documentation xml:lang="en">Unique identification number of the owner (EIK), if the entity is registered in Bulgaria.</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" name="OwnershipPercentage" type="xs:decimal"
              xdb:SQLType="NUMBER"/>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <!-- Section 4 -->
      <xs:element name="UltimateOwnerIdentificationBG" xdb:SQLType="ULTIMATEOWNERIDENTIFICATIONBG_T">
        <xs:complexType xdb:SQLType="ULTIMATEOWNERIDENTIFICATIONBG_T" xdb:SQLSchema="SYSTEM">
          <xs:sequence minOccurs="0">
            <xs:element minOccurs="0" name="UltimateOwnerNameCyrillicBG"
              type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Наименование на ултимативния / крайния собственик на ГП (кирилица).</xs:documentation>
                <xs:documentation xml:lang="en">Ultimate Owner name in cyrillic (if registered in Bulgaria).</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" name="UltimateOwnerUICBG" type="nsSAFT:SAFmiddle1textType"
              xdb:SQLType="VARCHAR2">
                <xs:annotation>
                <xs:documentation xml:lang="bg">ЕИК на ултимативния собственик (юридическо лице), в случай на регистрирано в България юридическо лице.</xs:documentation>
                <xs:documentation xml:lang="en">Ultimate owner Unique Identification Number (EIK), if registered in Bulgaria.</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" name="UltimateOwnerEGNBG" type="nsSAFT:SAFmiddle1textType"
              xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">ЕГН на ултимативния собственик (физическо лице), ако е българско физическо лице.</xs:documentation>
                <xs:documentation xml:lang="en">Ultimate owner Personal identification number (EGN), if bulgarian natural person.</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <!-- Section 5 -->
      <xs:element name="UltimateOwnerIdentificationForeign"
        xdb:SQLType="ULTIMATEOWNERIDENTIFICATIONFOREIGN_T">
        <xs:complexType xdb:SQLType="ULTIMATEOWNERIDENTIFICATIONFOREIGN_T" xdb:SQLSchema="SYSTEM">
          <xs:sequence minOccurs="0">
            <xs:element name="UltimateOwnerNameCyrillicForeign" type="nsSAFT:SAFmiddle2textType"
              xdb:SQLType="VARCHAR2">
                <xs:annotation>
                <xs:documentation xml:lang="bg">Наименование на ултимативния собственик (кирилица).</xs:documentation>
                <xs:documentation xml:lang="en">Ultimate Owner name in cyrillic (if foreign entity, natural person).</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element name="UltimateOwnerNameLatinForeign" type="nsSAFT:SAFmiddle2textType"
              xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Наименование на ултимативния собственик (латиница).</xs:documentation>
                <xs:documentation xml:lang="en">Ultimate Owner name in latin (if foreign entity, natural person).</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element name="CountryForeign" type="nsSAFT:ISOCountryCode" minOccurs="0"
              xdb:SQLType="VARCHAR2">
              <xs:annotation>
                <xs:documentation xml:lang="bg">Държава на регистрация на ултимативния собственик на ГП, Код ISO.</xs:documentation>
                <xs:documentation xml:lang="en">Country of registration of the ultimate owner (if foreign entity or natural person).</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="AmountStructure" xdb:SQLType="AMOUNTSTRUCTURE_T" xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Обща структура, използвана навсякъде, където се изисква
				сума. Парична сума с незадължителна информация за обменния курс на чуждестранна
				валута.</xs:documentation>
      <xs:documentation xml:lang="en"> A common structure used wherever an amount is required.
				Monetary amount with optional foreign currency exchange rate
				information.</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="Amount" type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Сумата във валутата по подразбиране на заглавния
						блок на SAF-T файла (основна валута). Сумата се представя като десетично
						число с две десетични цифри след разделителя на десетичната точка (" . ")
						Тази сума може да бъде отрицателна или положителна, според случая.
						Отрицателните суми се предхождат със знак минус ("-")</xs:documentation>
          <xs:documentation xml:lang="en"> The amount in the header's default currency. Decimal number with two decimals separated by decimal point sign („ . ”)
This amount may be positive or negative amount. Negative amounts are prefixed with the minus („-”) sign.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="CurrencyCode" type="nsSAFT:ISOCurrencyCode" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Трибуквен код на валутата съгласно стандарта ISO
						4217. Пример: EUR за евро или USD за щатски долари.</xs:documentation>
          <xs:documentation xml:lang="en"> Three-letter currency code according to ISO
						4217 standard.  Example: EUR for the Euros or USD for American Dollars.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="CurrencyAmount" type="nsSAFT:SAFmonetaryType" xdb:SQLType="NUMBER">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Сумата в чуждестранна валута. Сумата се
						представя като десетично число с две десетични цифри след разделителя на
						десетичната точка (" . ") Тази сума може да бъде отрицателна или
						положителна, според случая. Отрицателните суми се предхождат със знак минус
						("-")</xs:documentation>
          <xs:documentation xml:lang="en"> Amount in foreign currency.
Decimal number with two decimals separated by decimal point sign („ . ”). This amount may be positive or negative amount. Negative amounts are prefixed with the minus („-”) sign .</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="ExchangeRate" type="nsSAFT:SAFexchangerateType"
        xdb:SQLType="NUMBER">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Използваният обменен курс. CurrencyAmount x
						ExchangeRate = Сума</xs:documentation>
          <xs:documentation xml:lang="en"> The exchange rate used. CurrencyAmount x
						ExchangeRate = Amount</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="AnalysisStructure" xdb:SQLType="ANALYSISSTRUCTURE_T" xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Аналитични структури за Счетоводните
				записи</xs:documentation>
      <xs:documentation xml:lang="en">General Ledger analysis codes.</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="AnalysisType" type="nsSAFT:SAFcodeType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg"> Идентификатор на кода за анализ: разходен център, разходна единица, тип разходи, проект и др. Отнася се за  MasterFile AnalysisTypeTable.</xs:documentation>
          <xs:documentation xml:lang="en"> Analysis code identifier: cost center, cost unit, cost type, project, etc. Refers to the MasterFile AnalysisTypeTable. </xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="AnalysisID" type="nsSAFT:SAFlongtextType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Стойност на AnalysisID, например: код (ИД) на
						разходен център</xs:documentation>
          <xs:documentation xml:lang="en">Value of the AnalysisID: f.i. which cost center applies.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="AnalysisAmount" type="nsSAFT:AmountStructure"
        xdb:SQLType="AMOUNTSTRUCTURE_T">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Сума за конкретния анализен код (например - сума
						по разходен център)</xs:documentation>
          <xs:documentation xml:lang="en"> Amount applying to the Analysis: f.i. the
						amount applying for this dimension.</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="BankAccountStructure" xdb:SQLType="BANKACCOUNTSTRUCTURE_T"
    xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Информация за номера на банковата сметка. IBAN номер или
				номер на сметка с незадължителна информация.</xs:documentation>
      <xs:documentation xml:lang="en"> Bank account number information. IBAN number, or
				account number with optional information.</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:choice>
        <xs:element name="IBANNumber" type="nsSAFT:SAFmiddle1textType" xdb:SQLType="VARCHAR2">
          <xs:annotation>
            <xs:documentation xml:lang="bg">Международен номер на банкова сметка, ISO
							13616</xs:documentation>
            <xs:documentation xml:lang="en">International Bank Account Number, ISO
							13616</xs:documentation>
          </xs:annotation>
        </xs:element>
        <xs:sequence>
          <xs:element name="BankAccountNumber" type="nsSAFT:SAFmiddle1textType"
            xdb:SQLType="VARCHAR2">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Номер на банкова сметка, присвоен от  банката - на физическото лице или компанията, в случаите, в които номера на банковата сметка не е IBAN.</xs:documentation>
              <xs:documentation xml:lang="en"> The number allocated to the account by the individual’s or company’s own bank, where the bank account number is not IBAN </xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element minOccurs="0" name="BankAccountName" type="nsSAFT:SAFmiddle2textType"
            xdb:SQLType="VARCHAR2">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Име на физическото лице или фирмата,
								титуляри на банковата сметка.</xs:documentation>
              <xs:documentation xml:lang="en"> The name of the individual or company
								holding the bank account.</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element minOccurs="0" name="SortCode" type="nsSAFT:SAFshorttextType"
            xdb:SQLType="VARCHAR2">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Идентификатор за банковия клон, в който
								се намира сметката. Използва се за еднозначна идентификация на
								сметката.</xs:documentation>
              <xs:documentation xml:lang="en"> Identifier for the bank branch at which
								the account is held. May be needed to uniquely identify the account.</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
      </xs:choice>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="CompanyHeaderStructure" xdb:SQLType="COMPANYHEADERSTRUCTURE_T"
    xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Фирмена структура със задължителен регистрационен номер
				и телефон (за контакт).</xs:documentation>
      <xs:documentation xml:lang="en"> CompanyStructure with mandatory RegistrationNumber and
				Telephone (Contact).</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:restriction base="nsSAFT:CompanyStructure">
        <xs:sequence>
          <xs:element name="RegistrationNumber" type="nsSAFT:SAFmiddle1textType"
            xdb:SQLType="VARCHAR2">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Уникален номер за идентифициране на икономическия оператор, издаден от държавната администрация.</xs:documentation>
              <xs:documentation xml:lang="en"> Unique number to identify the economic operator, issued by relevant authorities.</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="Name" type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Името на фирмата
								(кирилица).</xs:documentation>
              <xs:documentation xml:lang="en">The name of the company
								(cyrillic).</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="NameLatin" type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Името на фирмата
								(латиница).</xs:documentation>
              <xs:documentation xml:lang="en">The name of the company
								(latin).</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element maxOccurs="unbounded" name="Address" type="nsSAFT:AddressStructure"
            xdb:SQLCollType="ADDRESSSTRUCTURE_V" xdb:SQLType="ADRESSSTRUCTURE_T">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Адреси на фирмата.</xs:documentation>
              <xs:documentation xml:lang="en">Addresses of the
								company.</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element maxOccurs="unbounded" minOccurs="0" name="Contact"
            type="nsSAFT:ContactInformationStructure"
            xdb:SQLCollType="CONTACTINFORMATIONSTRUCTURE_V"
            xdb:SQLType="CONTACTINFORMATIONSTRUCTURE_T">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Контакти на фирмата.</xs:documentation>
              <xs:documentation xml:lang="en">Contacts of the
								company.</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element maxOccurs="unbounded" minOccurs="0" name="TaxRegistration"
            type="nsSAFT:TaxIDStructure" xdb:SQLType="TAXIDSTRUCTURE_T"
            xdb:SQLCollType="TAXIDSTRUCTURE_V">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Данъчна регистрация на
								фирмата.</xs:documentation>
              <xs:documentation xml:lang="en">Tax registration of the
								company.</xs:documentation>
                          </xs:annotation>
          </xs:element>
          <xs:element maxOccurs="unbounded" minOccurs="0" name="BankAccount"
            type="nsSAFT:BankAccountStructure" xdb:SQLCollType="BANKACCOUNTSTRUCTURE_V"
            xdb:SQLType="BANKACCOUNTSTRUCTURE_T">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Банкови сметки на
								фирмата.</xs:documentation>
              <xs:documentation xml:lang="en">Bank accounts of the
								company.</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="RelatedParty" xdb:SQLType="VARCHAR2">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Определя дали фирмата е свързано
								лице</xs:documentation>
              <xs:documentation xml:lang="en">Indicator whether the company is a
								related party</xs:documentation>
            </xs:annotation>
            <xs:simpleType>
              <xs:restriction base="nsSAFT:SAFshorttextType">
                <xs:enumeration value="Y"/>
                <xs:enumeration value="N"/>
              </xs:restriction>
            </xs:simpleType>
          </xs:element>
          <xs:element maxOccurs="1" minOccurs="0" name="RelatedPartyStartDate" type="xs:date"
            xdb:SQLType="DATE">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Начална дата от която компанията е
								свързано лице</xs:documentation>
              <xs:documentation xml:lang="en">Start Date of when the company started
								to be a related party</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element maxOccurs="1" minOccurs="0" name="RelatedPartyEndDate" type="xs:date"
            xdb:SQLType="DATE">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Крайна дата, на която компанията е
								свръзано лице</xs:documentation>
              <xs:documentation xml:lang="en">End Date of when the company ceased to
								be a related party</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
      </xs:restriction>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="CompanyStructure" xdb:SQLType="COMPANYSTRUCTURE_T" xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Име и адрес на компанията</xs:documentation>
      <xs:documentation xml:lang="en"> Name, address, contact and identification information
				of a company.</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="RegistrationNumber" type="nsSAFT:SAFmiddle1textType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Уникален номер за идентифициране на компанията в
						счетоводните записи, издаден от държавен орган или създаден от компанията за
						вътрешни цели за идентифициране на различни субекти в рамките на тяхната
						корпоративна група. В случай на частни лица може да се използва
						ЕГН.</xs:documentation>
          <xs:documentation xml:lang="en"> Unique number to identify the company in the
						accounting records, issued by a government body or created by the company
						for internal purposes to identify different entities within their corporate
						group. In case of private persons, the Personal Identification Number can be
						used.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="Name" type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Името на фирмата (кирилица).</xs:documentation>
          <xs:documentation xml:lang="en">The name of the company
						(cyrillic).</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="NameLatin" type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Името на фирмата (латиница).</xs:documentation>
          <xs:documentation xml:lang="en">The name of the company
						(latin).</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element maxOccurs="unbounded" name="Address" type="nsSAFT:AddressStructure"
        xdb:SQLCollType="ADDRESSSTRUCTURE_V" xdb:SQLType="ADRESSSTRUCTURE_T">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Адреси на фирмата.</xs:documentation>
          <xs:documentation xml:lang="en">Addresses of the company.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="Contact"
        type="nsSAFT:ContactInformationStructure" xdb:SQLCollType="CONTACTINFORMATIONSTRUCTURE_V"
        xdb:SQLType="CONTACTINFORMATIONSTRUCTURE_T">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Контакти на фирмата.</xs:documentation>
          <xs:documentation xml:lang="en">Contacts of the company.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="TaxRegistration"
        type="nsSAFT:TaxIDStructure" xdb:SQLCollType="TAXIDSTRUCTURE_V"
        xdb:SQLType="TAXIDSTRUCTURE_T">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Данъчна регистрация на
						фирмата.</xs:documentation>
          <xs:documentation xml:lang="en">Tax registration of the
						company.</xs:documentation>
          <xs:documentation xml:lang="en">??????? ??????????? ??
						??????????.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="BankAccount"
        type="nsSAFT:BankAccountStructure" xdb:SQLCollType="BANKACCOUNTSTRUCTURE_V"
        xdb:SQLType="BANKACCOUNTSTRUCTURE_T">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Банкови сметки на фирмата.</xs:documentation>
          <xs:documentation xml:lang="en">Bank accounts of the company.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="RelatedParty" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Индикатор дали фирмата е свързано
						лице</xs:documentation>
          <xs:documentation xml:lang="en">Indicator whether the company is a related
						party</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element maxOccurs="1" minOccurs="0" name="RelatedPartyStartDate" type="xs:date"
        xdb:SQLType="DATE">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Начална дата, когато компанията е започнала да
						бъде свързано лице</xs:documentation>
          <xs:documentation xml:lang="en">Start Date of when the company started to be a
						related party</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element maxOccurs="1" minOccurs="0" name="RelatedPartyEndDate" type="xs:date"
        xdb:SQLType="DATE">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Крайна дата, на която дружеството е престанало
						да бъде свързано лице</xs:documentation>
          <xs:documentation xml:lang="en">End Date of when the company ceased to be a
						related party</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="ContactHeaderStructure" xdb:SQLType="CONTACTHEADERSTRUCTURE_T"
    xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Структура на информация за контакт със задължителен
				телефонен номер.</xs:documentation>
      <xs:documentation xml:lang="en">ContactInformationStructure with madatory
				TelephoneNumber.</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:restriction base="nsSAFT:ContactInformationStructure">
        <xs:sequence>
          <xs:element name="ContactPerson" type="nsSAFT:PersonNameStructure"
            xdb:SQLType="PERSONNAMESTRUCTURE_T">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Името на лицето за
								контакт.</xs:documentation>
              <xs:documentation xml:lang="en">The name of the contact
								person.</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="Telephone" type="nsSAFT:SAFshorttextType" xdb:SQLType="VARCHAR2">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Телефонен номер.</xs:documentation>
              <xs:documentation xml:lang="en">Telephone number.</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element minOccurs="0" name="Fax" type="nsSAFT:SAFshorttextType" xdb:SQLType="VARCHAR2">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Номер на факс.</xs:documentation>
              <xs:documentation xml:lang="en">Fax number.</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element minOccurs="1" name="Email" type="nsSAFT:SAFmiddle2textType"
            xdb:SQLType="VARCHAR2">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Имейл адрес.</xs:documentation>
              <xs:documentation xml:lang="en">E-mail address.</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element minOccurs="0" name="Website" type="xs:anyURI" xdb:SQLType="VARCHAR2">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Адрес на сайт.</xs:documentation>
              <xs:documentation xml:lang="en">Website address.</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
      </xs:restriction>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="ContactInformationStructure" xdb:SQLType="CONTACTINFORMATIONSTRUCTURE_T"
    xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Информация за контакт</xs:documentation>
      <xs:documentation xml:lang="en">Contact information.</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="ContactPerson" type="nsSAFT:PersonNameStructure"
        xdb:SQLType="PERSONNAMESTRUCTURE_T">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Името на лицето за контакт.</xs:documentation>
          <xs:documentation xml:lang="en">The name of the contact
						person.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="Telephone" type="nsSAFT:SAFshorttextType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Телефонен номер.</xs:documentation>
          <xs:documentation xml:lang="en">Telephone number.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="Fax" type="nsSAFT:SAFshorttextType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Номер на факс.</xs:documentation>
          <xs:documentation xml:lang="en">Fax number.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="Email" type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Имейл адрес.</xs:documentation>
          <xs:documentation xml:lang="en">E-mail address.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="Website" type="xs:anyURI" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Адрес на сайт.</xs:documentation>
          <xs:documentation xml:lang="en">Website address.</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="HeaderStructure" xdb:SQLType="HEADERSTRUCTURE_T" xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Обща информация за този стандартен файл.</xs:documentation>
      <xs:documentation xml:lang="en">Overall information about this Standard
				Auditfile.</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="AuditFileVersion" type="nsSAFT:SAFcodeType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Идентификация на версията, използвана за стандартния одитен файл SAF-T.</xs:documentation>
          <xs:documentation xml:lang="en">Identification of the Standard Audit File SAF-T version being used.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="AuditFileCountry" type="nsSAFT:ISOCountryCode" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Двубуквен код на държавата съгласно стандарта
						ISO 3166-1 alpha 2.Пример NL за Холандия, BG за България.</xs:documentation>
          <xs:documentation xml:lang="en"> Two-letter country code according to ISO 3166-1
						alpha 2 standard.Example NL for the Netherlands, BG for Bulgaria. </xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="AuditFileRegion" type="nsSAFT:SAFcodeType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Специфичен за страната код за посочване на регионите / провинциите в рамките на данъчната администрация. За предпочитане е описано в съответствие с ISO3166-1A2.</xs:documentation>
          <xs:documentation xml:lang="en">Country specific code to indicate regions / provinces within the tax authority. Preferably described according to ISO3166-1A2.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="AuditFileDateCreated" type="xs:date" xdb:SQLType="DATE">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Дата на създаване на този SAF-T
						файл.</xs:documentation>
          <xs:documentation xml:lang="en">Date of production of this SAF-T.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="SoftwareCompanyName" type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Име на софтуерната компания, чийто продукт е
						създал този SAF-T файл.</xs:documentation>
          <xs:documentation xml:lang="en"> Name of the software company whose product
						created the audit file.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="SoftwareID" type="nsSAFT:SAFlongtextType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Име на софтуера, източник на данните за SAF-T.</xs:documentation>
          <xs:documentation xml:lang="en">Name of the Software that generated the SAF-T data.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="SoftwareVersion" type="nsSAFT:SAFshorttextType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Версия на софтуера, източник на данните за SAF-T.</xs:documentation>
          <xs:documentation xml:lang="en">Version of the software that created the SAF-T data.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="Company" type="nsSAFT:CompanyHeaderStructure"
        xdb:SQLType="COMPANYHEADERSTRUCTURE_T">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Име и адрес на компанията</xs:documentation>
          <xs:documentation xml:lang="en">Company's name and address
						details.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="Ownership" type="nsSAFT:OwnershipStructure"
        xdb:SQLType="OWNERSHIPSTRUCTURE_T">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Структура на собствеността на
						компанията.</xs:documentation>
          <xs:documentation xml:lang="en">Company's ownership
						structure.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="DefaultCurrencyCode" type="nsSAFT:ISOCurrencyCode" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Трибуквен код на валута (съгласно ISO 4217) / основната местна валута, която се използва по-подразбиране в SAF-T файла.</xs:documentation>
          <xs:documentation xml:lang="en"> Three letter Currency Code (ISO 4217) of local currency which is the default for the SAF-T.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="SelectionCriteria" type="nsSAFT:SelectionCriteriaStructure"
        xdb:SQLType="SELECTIONCRITERIASTRUCTURE_T">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Критерии, зададени от потребителя за попълване на SAF-T файла. За повече информация, виж описанието на SelectionCriteriaStructure </xs:documentation>
          <xs:documentation xml:lang="en">Criteria set by the user to populate the audit file. For more information, see SelectionCriteriaStructure description.  </xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="HeaderComment" type="nsSAFT:SAFlongtextType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Показва вида на подадения файл. Това може да бъде:  месечен / Monthly, годишен / annual или "при поискване"/on demand.</xs:documentation>
          <xs:documentation xml:lang="en">Indicates the type of return submitted. This can be: monthly, annual or on-demand return.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="SegmentIndex" type="nsSAFT:SAFcodeType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Индексът на този SAF-T документ в поредица от
						документи, които съставляват пълен отчет.Когато SAF-T се изпраща на сегменти (т.е. части), показва индекса на текущата част в последователността. </xs:documentation>
          <xs:documentation xml:lang="en"> The index of the segment in the sequence. Where SAF-T is submitted in segments (i.e. parts) shows the index of the current part in the sequence.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="TotalSegmentsInsequence" type="nsSAFT:SAFcodeType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Общият брой сегменти в последователността.</xs:documentation>
          <xs:documentation xml:lang="en">The total number of segments in the
						sequence.</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="PersonNameStructure" xdb:SQLType="PERSONNAMESTRUCTURE_T"
    xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Цялата информация за името на физическо
				лице.</xs:documentation>
      <xs:documentation xml:lang="en">All information about the name of a natural
				person.</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="Title" type="nsSAFT:SAFcodeType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Не се изисква.</xs:documentation>
          <xs:documentation xml:lang="en">Not necessary.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="FirstName" type="nsSAFT:SAFmiddle1textType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Първо име.</xs:documentation>
          <xs:documentation xml:lang="en"> First name of the person.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="Initials" type="nsSAFT:SAFshorttextType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Инициали.</xs:documentation>
          <xs:documentation xml:lang="en">Initials.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="LastNamePrefix" type="nsSAFT:SAFshorttextType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Текстов израз на префикс, който предхожда
						фамилното име на този човек, като Van, Von.</xs:documentation>
          <xs:documentation xml:lang="en"> A textual expression of a prefix that precedes
						this person's family name such as Van, Von.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="LastName" type="nsSAFT:SAFmiddle2textType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Фамилия на лицето.</xs:documentation>
          <xs:documentation xml:lang="en"> Last name of the person.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="BirthName" type="nsSAFT:SAFmiddle2textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Рождено име на лицето.</xs:documentation>
          <xs:documentation xml:lang="en">Birth name of the person.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="Salutation" type="nsSAFT:SAFshorttextType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Официален знак или обръщение</xs:documentation>
          <xs:documentation xml:lang="en"> A formal sign or expression of greeting, that is appropriate for this person.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element maxOccurs="unbounded" minOccurs="1" name="OtherTitles"
        type="nsSAFT:SAFshorttextType" xdb:SQLCollType="OTHERTITLES_V" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Длъжност.</xs:documentation>
          <xs:documentation xml:lang="en"> Position.</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="SelectionCriteriaStructure" xdb:SQLType="SELECTIONCRITERIASTRUCTURE_T"
    xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Критериите за избор, използвани за генериране на този
				стандартен файл за проверка.</xs:documentation>
      <xs:documentation xml:lang="en"> The selection criteria used to generate this Standard
				Auditfile.</xs:documentation>
    </xs:annotation>
    <xs:sequence minOccurs="0">
      <xs:element minOccurs="0" name="TaxReportingJurisdiction" type="nsSAFT:SAFmiddle1textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Не се попълва. Идентифицира данъчната юрисдикция, за чиято цел
						е създаден SAFT. Основно за употреба, когато един орган по приходите покрива
						повече от една територия.</xs:documentation>
          <xs:documentation xml:lang="en"> Not required for submission. Identifies the tax jurisdiction for whose
						purpose the SAFT has been created. Principally for use where a single Revenue
						body covers more than one territory.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="CompanyEntity" type="nsSAFT:SAFmiddle2textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">За използване, когато данните са извлечени от пълния набор от данни чрез филтриране на конкретно юридическо лице. В случаите, в които информационната система на данъкоплатеца съдържа информация за повече от едно юридически лица.</xs:documentation>
          <xs:documentation xml:lang="en"> For use where data has been extracted from the
						full data set by reference to a specific corporate
						entity.In cases where the taxpayer's information system contains information about more than one legal entity. </xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:choice>
        <xs:annotation>
          <xs:documentation xml:lang="bg">Позволява избор между избор на календарни дати или
						периоди според счетоводната система, напр. 1 до 12 за 12-месечна счетоводна
						система.</xs:documentation>
          <xs:documentation xml:lang="en"> Allows for a choice between selection on
						calendar dates or periods according to the accounting system, e.g. 1 to 12
						for a 12-months accounting system.</xs:documentation>
        </xs:annotation>
        <xs:sequence>
          <xs:element name="SelectionStartDate" type="xs:date" xdb:SQLType="DATE">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Началната дата за отчетния период,
								обхванат от SAF-T. Може да се попълни или този елемент или елементите PeriodStart, PeriodStartYear.</xs:documentation>
              <xs:documentation xml:lang="en"> The start date for the reporting period
								covered by the SAF-T.Either this element or the PeriodStart, PeriodStartYear elements can be populated.</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="SelectionEndDate" type="xs:date" xdb:SQLType="DATE">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Крайната дата за отчетния период,
								обхванат от SAF-T. Може да се попълни или този елемент или елементите PeriodEnd, PeriodEndYear. </xs:documentation>
              <xs:documentation xml:lang="en"> The end date for the reporting period
								covered by the SAF-T. Either this element or the PeriodEnd, PeriodEndYear elements can be populated.</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
        <xs:sequence>
          <xs:element name="PeriodStart" type="xs:nonNegativeInteger" xdb:SQLType="NUMBER">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Първият счетоводен период, обхванат от
								SAF-T.</xs:documentation>
              <xs:documentation xml:lang="en">The first Accounting Period covered by
								the SAF-T.</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="PeriodStartYear" type="xs:nonNegativeInteger" xdb:SQLType="NUMBER">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Година на счетоводният период, в който попада PeriodStart. </xs:documentation>
              <xs:documentation xml:lang="en">The Accounting Year in which the
								PeriodStart falls.</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="PeriodEnd" type="xs:nonNegativeInteger" xdb:SQLType="NUMBER">
            <xs:annotation>
              <xs:documentation xml:lang="bg"> Последен счетоводен период, обхванат от SAFТ.</xs:documentation>
              <xs:documentation xml:lang="en">The last Accounting Period covered by
								the SAF-T.</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="PeriodEndYear" type="xs:nonNegativeInteger" xdb:SQLType="NUMBER">
            <xs:annotation>
              <xs:documentation xml:lang="bg">Година на счетоводният период, в който попада PeriodEnd.</xs:documentation>
              <xs:documentation xml:lang="en">The Accounting Year in which the
								PeriodEnd falls.</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
      </xs:choice>
      <xs:element minOccurs="0" name="DocumentType" type="nsSAFT:SAFlongtextType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Тип на избраните документи. За използване, когато данните са ограничени по отношение на определен вид транзакция(например само фактури за продажба).</xs:documentation>
          <xs:documentation xml:lang="en"> Type of documents selected. For use where the
						data has been restricted by reference to particular transaction
						types.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="OtherCriteria"
        type="nsSAFT:SAFlongtextType" xdb:SQLCollType="OTHERCRITERIA_V" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Всякакви други критерии, използвани при избора на данни. Отделните органи по приходите могат да пожелаят да изготвят списък с критерии за подбор, които да се използват в рамките на тяхната юрисдикция.</xs:documentation>
          <xs:documentation xml:lang="en"> Any other criteria used in selecting data.
						Individual Revenue Bodies may wish to draw up a list of other acceptable
						selection criteria for use within their jurisdiction.</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="TaxIDStructure" xdb:SQLType="TAXIDSTRUCTURE_T" xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Данъчна информация за фирма.</xs:documentation>
      <xs:documentation xml:lang="en">Tax information of a company.</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="TaxRegistrationNumber" type="nsSAFT:SAFmiddle1textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Регистрационен номер по ДДС на
						дружеството</xs:documentation>
          <xs:documentation xml:lang="en"> The company’s tax registration number.
This is the unique number issued by NRA for use by the company.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="TaxType" type="nsSAFT:SAFcodeType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">За използване, когато информацията, отчетена в SAF-T, обхваща повече от един вид данъчен режим: да се идентифицира видът на данъчния режим, за който се отнася това вписване.</xs:documentation>
          <xs:documentation xml:lang="en"> For use where information reported in the SAF-T covers more than one type of tax regime: to identify the type of the tax regime to which this entry relates.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="TaxNumber" type="nsSAFT:SAFmiddle1textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Данъчен номер на дружеството </xs:documentation>
          <xs:documentation xml:lang="en"> The tax registration number </xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="TaxAuthority" xdb:SQLType="XDB$ENUM_T">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Идентификация на данъчния орган, за който се
						отнася този TaxType (НАП).</xs:documentation>
          <xs:documentation xml:lang="en"> Identification of the Revenue Body to which
						this TaxType refers (NRA).</xs:documentation>
        </xs:annotation>
        <xs:simpleType>
          <xs:restriction base="nsSAFT:SAFmiddle1textType">
            <xs:enumeration value="NRA"/>
          </xs:restriction>
        </xs:simpleType>
      </xs:element>
      <xs:element minOccurs="0" name="TaxVerificationDate" type="xs:date" xdb:SQLType="DATE">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Датата, на която данните за данъчната регистрация, посочени по-горе, са били последно проверени (дата на ДДС регистрация).</xs:documentation>
          <xs:documentation xml:lang="en"> The date that the tax registration details referred to above were last checked. e.g. date when the VAT registration number was assigned to taxpayer.</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="TaxInformationStructure" xdb:SQLType="TAXINFORMATIONSTRUCTURE_T"
    xdb:SQLSchema="SYSTEM">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Структура на информацията за размера на
				данъка.</xs:documentation>
      <xs:documentation xml:lang="en">Tax Amount information structure.</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="TaxType" type="nsSAFT:SAFcodeType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">TaxType референция към предоставената таблица (За да попълните полето, използвайте кодовете от номенклатурата  VAT_TaxType). </xs:documentation>
          <xs:documentation xml:lang="en">Tax type for look-up in
						tables.Nomenclature VAT_TaxType to be used. </xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="TaxCode" type="nsSAFT:SAFcodeType" xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">TaxCode референция. За да попълните полето, използвайте кодовете от номенклатурата  TAX-IMP.</xs:documentation>
          <xs:documentation xml:lang="en">Tax Code for lookup in
						tables. Nomenclature TAX-IMP to be used.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="TaxPercentage" type="xs:decimal" xdb:SQLType="NUMBER">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Данъчна ставка</xs:documentation>
          <xs:documentation xml:lang="en">Tax percentage.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="TaxBase" type="xs:decimal" xdb:SQLType="NUMBER">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Сума на основата, върху която се изчислява данъкът.</xs:documentation>
          <xs:documentation xml:lang="en"> The base on which the tax is calculated.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="TaxBaseDescription" type="nsSAFT:SAFmiddle2textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Описание на стойността в
						TaxBase</xs:documentation>
          <xs:documentation xml:lang="en"> Description of the value in the TaxBase.</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="TaxAmount" type="nsSAFT:AmountStructure" xdb:SQLType="AMOUNTSTRUCTURE_T">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Сума на
						данъка</xs:documentation>
          <xs:documentation xml:lang="en">Tax amount information</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="TaxExemptionReason" type="nsSAFT:SAFmiddle2textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Причина или обосновка за освобождаване от данък
						или намалена ставка</xs:documentation>
          <xs:documentation xml:lang="en">Tax exemption or reduction reason or
						rationale</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="TaxDeclarationPeriod" type="nsSAFT:SAFmiddle1textType"
        xdb:SQLType="VARCHAR2">
        <xs:annotation>
          <xs:documentation xml:lang="bg">Номер на декларацията, в която е бил отчетен данъка </xs:documentation>
          <xs:documentation xml:lang="en"> The identification of the declaration/return in
						which the taxamount is reported to the Revenue body.</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:simpleType name="SAFmonetaryType">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Парична сума. Максимум 18 цифри, от които 2 могат да
				бъдат дробни цифри.</xs:documentation>
      <xs:documentation xml:lang="en"> Monetary amount.18 digits max, of which 2 can be
				fractional digits.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:decimal">
      <xs:totalDigits value="18"/>
      <xs:fractionDigits value="2"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="SAFexchangerateType">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Парична сума. Максимум 18 цифри, от които 2 могат да бъдат дробни цифри.</xs:documentation>
      <xs:documentation xml:lang="en">Monetary amount. 18 digits max, of which 4 can be fractional digits.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:decimal">
      <xs:totalDigits value="18"/>
      <xs:fractionDigits value="4"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="SAFquantityType">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Използва се за описание на количество. Максимум 22
				цифри, от които 6 могат да бъдат дробни цифри.</xs:documentation>
      <xs:documentation xml:lang="en"> Used to describe a quantity. 22 digits max, of which 6
				can be fractional digits.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:decimal">
      <xs:totalDigits value="22"/>
      <xs:fractionDigits value="6"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="SAFweightType">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Описва тегло. Максимум 14 цифри, от които 3 могат да
				бъдат дробни цифри.</xs:documentation>
      <xs:documentation xml:lang="en"> Describes a weight. 14 digits max, of which 3 can be
				fractional digits.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:decimal">
      <xs:totalDigits value="14"/>
      <xs:fractionDigits value="3"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="SAFcodeType">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Текст от максимум 9 знака.</xs:documentation>
      <xs:documentation xml:lang="en">Text of max 9 characters.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:maxLength value="9"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="SAFshorttextType">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Текст от максимум 18 знака.</xs:documentation>
      <xs:documentation xml:lang="en">Text of max 18 characters.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:maxLength value="18"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="SAFmiddle1textType">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Текст от максимум 35 знака.</xs:documentation>
      <xs:documentation xml:lang="en">Text of max 35 characters.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:maxLength value="35"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="SAFmiddle2textType">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Текст от максимум 70 знака.</xs:documentation>
      <xs:documentation xml:lang="en">Text of max 70 characters.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:maxLength value="70"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="SAFlongtextType">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Текст от максимум 256 знака.</xs:documentation>
      <xs:documentation xml:lang="en">Text of max 256 characters.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:maxLength value="256"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="ISOCountryCode">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Двубуквен код на държавата съгласно стандарта ISO 3166-1
				alpha 2. Пример: БГ за България.</xs:documentation>
      <xs:documentation xml:lang="en"> Two-letter country code according to ISO 3166-1 alpha 2
				standard. Example: BG for Bulgaria.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:length value="2"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="ISOCurrencyCode">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Трибуквен код на валутата по стандарт ISO 4217. Пример:
				EUR за евро или BGN за български лев.</xs:documentation>
      <xs:documentation xml:lang="en"> Three-letter currency code according to ISO 4217
				standard. Example: EUR for the Euros or BGN for Bulgarian Lev.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:length value="3"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="Date">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Използваният формат е ГГГГ-ММ-ДД Примери: 2020-10-03, 2021-04-12.</xs:documentation>
      <xs:documentation xml:lang="en">The format used YYYY-MM-DD. Examples: 2020-10-03, 2021-04-12.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:date"/>
  </xs:simpleType>
  <xs:simpleType name="Decimal">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Десетични числа (рационално число) с произволна дължина. Позволява произволен брой начални и завършващи нули (след десетичната точка).</xs:documentation>
      <xs:documentation xml:lang="en"> Decimal number (rational number) with arbitrary lengths. Its lexical space allows any number of insignificant leading and trailing zeros (after the decimal point).</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:decimal"/>
  </xs:simpleType>
  <xs:simpleType name="SAFBaseRate">
    <xs:annotation>
      <xs:documentation xml:lang="bg"> Лимит: 0,0000-1,0000.</xs:documentation>
      <xs:documentation xml:lang="en">Restriction: 0.0000-1.0000.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:decimal">
      <xs:totalDigits value="5"/>
      <xs:fractionDigits value="4"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="Time">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Формат HH:MM 24h Пример: 01:25, 15:03.</xs:documentation>
      <xs:documentation xml:lang="en">HH:MM format 24h. Example: 01:25, 15:03.</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:time"/>
  </xs:simpleType>
  <xs:simpleType name="URI">
    <xs:annotation>
      <xs:documentation xml:lang="bg">Адрес (Uniform Resource Identifier)</xs:documentation>
      <xs:documentation xml:lang="en">Web Address</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:anyURI">
      <xs:length value="256"/>
    </xs:restriction>
  </xs:simpleType>
</xs:schema>
    `
  }


  function LoadSchema()
  {
		if (rootNodeIndex)
			return;

    var complexType = new Object();
    ComplexTypes = new Array();
    ComplexTypes.push(complexType);

    var mynode = new Object();
    Nodes = new Array();
    Nodes.push(mynode); // dummy node at the beginning --> first real item starts with index 1

    statusText.innerHTML = "Loading schema ...";

    var textarea = document.getElementById("schema-text");
    var parser = new DOMParser();

    try {
      var content = textarea.value.trim();
      xmlDoc = parser.parseFromString(content, "text/xml");
    } catch (e) {
      // if text is not well-formed, 
      statusText.innerHTML = "Not a valid xml document";
      alert("Not a valid xml document");
      return false;
    };

    statusText.innerHTML = "Schema source successfully loaded ...";

    //var schemaNode = xmlDoc.getElementsByTagName("xs:schema")[0];
    //var rootNode = xmlDoc.getElementsByTagName("/xs:schema/xs:element")[0];
    //var txt = "Root-Nodename: " + rootNode.nodeName + " (nodetype: " + rootNode.nodeType + ")";

    //tracePar.innerHTML = "Schema-Rootnode-Name: " + schemaNode.nodeName;
    //alert(txt);

    // Node-Types:
    // 1 ... Node
    // 3 ... Text
    // 8 ... Comment

    var schemaNode = GetFirstChildNode(xmlDoc, "xs:schema");
    //tracePar.innerHTML = "Schema-Rootnode-Name: " + schemaNode.nodeName;
    //ShowChildNodes(schemaNode);

    /*
    var nIncludes = LoadIncludes(sourcePath, schemaNode);
    statusText.innerHTML = "Processing main schema file '" + schemaURL + "' ...";
    tracePar.innerHTML = "Include files loaded: " + nIncludes + " - loading simple types of main schema file ...";
    */

    LoadSimpleTypes(schemaNode);
    tracePar.innerHTML = "Simple types loaded: " + SimpleTypes.length + " - loading complex types of main schema file ...";

    LoadComplexTypes(schemaNode);
    tracePar.innerHTML = "Complex types loaded: " + ComplexTypes.length + " - processing main tree ...";

    var rootNode = GetFirstChildNode(schemaNode, "xs:element");

    //tracePar.innerHTML = "Rootnode-Name: " + rootNode.getAttribute("name") + " (nodetype: " + rootNode.nodeType + ")";
    //tracePar.innerHTML += " - Rootnode-Type: " + rootNode.getAttribute("type");
    bResolveComplexTypes = true;
    rootNodeIndex = AddNode(rootNode);
    //ShowChildNodes(rootNode);

    statusText.innerHTML = ""; //"Ready";
    /*
    var txt = "Nodes:";
    for (i = 0; i < Nodes.length; i++)
    txt += "<br>Nodes[" + i + "]: parentIndex=" + Nodes[i].parentIndex + ", type='" + NodeTypeNames[Nodes[i].type] + "', name='" + ToString(Nodes[i].name) + "', typeName='" + ToString(Nodes[i].typeName) + "', baseTypeName='" + ToString(Nodes[i].baseTypeName) + "', minOccurs=" + ToString(Nodes[i].minOccurs) + ", maxOccurs=" + ToString(Nodes[i].maxOccurs) + ", firstChildIndex=" + ToString(Nodes[i].firstChildIndex) + ", annotation='" + ToString(Nodes[i].annotation) + "'";

    txt += "<br><br>ComplexTypes:";
    for (i = 0; i < ComplexTypes.length; i++)
    txt += "<br>ComplexTypes[" + i + "]: name='" + ComplexTypes[i].name + "', nodeIndex=" + ComplexTypes[i].nodeIndex;

    txt += "<br><br>SimpleTypes:";
    for (i = 0; i < SimpleTypes.length; i++)
    txt += "<br>SimpleTypes[" + i + "]: name='" + SimpleTypes[i].name + "', nodeIndex=" + SimpleTypes[i].nodeIndex;
    */

    var txt = "ComplexTypes: " + ComplexTypes.length + ", SimpleTypes: " + SimpleTypes.length + ", Nodes: " + Nodes.length + ", rootNodeIndex: " + rootNodeIndex;
    /*
    txt += "<br>";
    for (i = 0; i < Nodes.length; i++)
      txt += "<br>Nodes[" + i + "]: parentIndex=" + Nodes[i].parentIndex + ", firstChildIndex=" + ToString(Nodes[i].firstChildIndex) + ", nextIndex=" + ToString(Nodes[i].nextIndex) + ", type='" + NodeTypeNames[Nodes[i].type] + "', name='" + ToString(Nodes[i].name) + "', typeName='" + ToString(Nodes[i].typeName) + "', baseTypeName='" + ToString(Nodes[i].baseTypeName) + "', minOccurs=" + ToString(Nodes[i].minOccurs) + ", maxOccurs=" + ToString(Nodes[i].maxOccurs) + ", annotation='" + ToString(Nodes[i].annotation) + "'";

    txt += "<br>";
    for (i = 0; i < ComplexTypes.length; i++)
      txt += "<br>ComplexTypes[" + i + "]: name='" + ComplexTypes[i].name + "', nodeIndex=" + ComplexTypes[i].nodeIndex;
    */
    tracePar.innerHTML = txt;

    schemaOptions.style.display = 'block';
    statusText.style.display = 'block';
    canvasContainer.style.display = 'block';

    SetNodeSizes();

    SetNodesExpanded(rootNodeIndex, true, 2);

    CalcNodePositions();

    loadSchemaParagraph.style.display = 'none';

    DrawTree();
  }


  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Drawing functions

  var PIXEL_RATIO = (function () {
    var ctx = document.createElement("canvas").getContext("2d"),
        dpr = window.devicePixelRatio || 1,
        bsr = ctx.webkitBackingStorePixelRatio ||
              ctx.mozBackingStorePixelRatio ||
              ctx.msBackingStorePixelRatio ||
              ctx.oBackingStorePixelRatio ||
              ctx.backingStorePixelRatio || 1;
    return dpr / bsr;
  })();

  createHiDPICanvas = function (w, h, ratio) {
    if (!ratio) { ratio = PIXEL_RATIO; }
    var can = document.createElement("canvas");
    can.width = w * ratio;
    can.height = h * ratio;
    can.style.width = w + "px";
    can.style.height = h + "px";
    can.getContext("2d").setTransform(ratio, 0, 0, ratio, 0, 0);
    return can;
  }

  function SetCanvasSize (w, h, ratio) {
    if (!ratio) { ratio = PIXEL_RATIO; }
    var can = document.getElementById("tree");
    can.width = w * ratio;
    can.height = h * ratio;
    can.style.width = w + "px";
    can.style.height = h + "px";
    can.getContext("2d").setTransform(ratio, 0, 0, ratio, 0, 0);
  }

  var canvas = document.getElementById("tree");
  var nCanvasHeight = 4096;
  var nCanvasWidth = 4096;

  SetCanvasSize(nCanvasWidth, nCanvasHeight); //, 2); // 1.1041666

  var nSchemaBorder = 10;
  var nSchemaHeight = 0;
  var nSchemaWidth = 0;

	var canvasContainer = document.getElementById("canvas-container");
	var canvasContainerWidth = canvasContainer.clientWidth;
	var canvasContainerHeight = canvasContainer.clientHeight;
	var canvasContainerScrollLeft = canvasContainer.scrollLeft; //.scrollLeftMax
	var canvasContainerScrollTop = canvasContainer.scrollTop; //.scrollTopMax

	// set height of canvas container to window height (= full screen)
	//canvasContainer.style.height = window.innerHeight + "px"; //document.offsetHeight;

	var canvasHeight = window.innerHeight - (schemaOptions.offsetTop + schemaOptions.offsetHeight + searchResultDiv.offsetHeight + bottomLineParagraph.offsetHeight);
	canvasContainer.style.height = canvasHeight + "px";


	function MakeVisible(x, y)
	{
		if (x < canvasContainerScrollLeft)
			canvasContainerScrollLeft = x - 10;
		if (x > canvasContainerScrollLeft + canvasContainerWidth)
			canvasContainerScrollLeft = x + 10 - canvasContainerWidth;
		if (y < canvasContainerScrollTop)
			canvasContainerScrollTop = y - 10;
		if (y > canvasContainerScrollTop + canvasContainerHeight)
			canvasContainerScrollTop = y + 10 - canvasContainerHeight;
	}
	

  //var div = document.getElementById("canvas-container");
  //div.height = 700;

  //Create canvas with the device resolution.
  //var myCanvas = createHiDPICanvas(500, 250);
  //Create canvas with a custom resolution.
  //var myCustomCanvas = createHiDPICanvas(500, 200, 4);


  var sLineColor = "#000000"; //"#303030";
  var nLineWidth = 0.75;
  var nMultipleNodeOffset = 4;
  var nShadowOffset = 4;
  var sShadowColor = "#B0B0B0"; //"#C0C0C0"; "#C8C8C8";
  //var sSelectedShadowColor = "#3030C0"; //"#FFFFB0";

  var sNodeNameFont = "bold 10pt Arial"; //"bold 10pt Helvetica";"10pt Arial"
  var sNodeNameColor = "#000090"; //"#303030";
  var sNodeBackgroundColor = "#FFFFFF";
  var sSelectedNodeBackgroundColor = "#FFFFA0"; //"#E0E0FF"; //"#FFFFB0";
  var sMandatoryAttributeNameFont = "bold 11px Arial";
  var sOptionalAttributeNameFont = "11px Arial";
  var sAttributeNameColor = "#000080";
  var nAttributeVerPadding = 3;
  var nAttributeLineHeight = 13;
  var sTypeDescriptionFont = "bold 11px Arial";
  var sAnnotationFont = "11px Arial";
  var sAnnotationColor = "#000000"; //"black"
  var nAnnotationTextHeight = 10;
  var nAnnotationLineDistance = 3;
  var nMaxAnnotationWidth = 250;
  var nAnnotationDistance = 6;  // vertical distance to border of node

  var nNodeTextHeight = 10;
  var nNodeTextPadding = 7;
  var nNodeHeight = nNodeTextHeight + nNodeTextPadding * 2;
  var nHalfNodeHeight = nNodeHeight / 2;
  var nSequenceWidth = nNodeHeight * 1.5;
  var nSequenceHeight = Math.round(nNodeHeight * 0.833);  // 0.75
  var nSequenceCornerSize = Math.round(nSequenceHeight * 0.26);  // 0.28

  var sPointsColor = "#606060"; //"#303030";
  var nPointsDistance = 6;
  var nPointsSize = 4;
  var nPointsHalfSize = 2;

	var sSequenceBoxColor = "#606060";

  var nExpanderHalfSize = nSequenceCornerSize;
  var nExpanderSize = nExpanderHalfSize * 2;
  var nExpanderDistance = nExpanderHalfSize * 0.28;  //0.333;
  //var sPlusMinusColor = "#B000A0"; //"#e00000";
  //var nPlusMinusLineWidth = 0.85;
  var sArrowBackgroundColor = "#787878"; //"#808080"; //"#6060B0";
	var sArrowBorderColor = "#404040";
	var sArrowColor = "#B000A0";
  var nArrowLineWidth = 2.0;
	
  var nMinHorLineLength = 20;
  var nVerNodeDistance = 12;
	
	var sTextDelimeters = " .,;:-+*/=<>()&%$�\"!#'[]{}�`~^�";

	var nLastClickedNodeIndex;
	var nLastExpandedNodeIndex;
	var nLastCollapsedNodeIndex;

  var bShowAnnotations = true;
  var bShowTypeInfo = true;

  var cbAnnotations = document.getElementById("cbAnnotations");
  var cbTypeInfo = document.getElementById("cbTypeInfo");


  function AnnotationChanged()
  {
    bShowAnnotations = cbAnnotations.checked;
    SetVerNodePositions();
    DrawTree();
  }

  function TypeInfoChanged()
  {
    bShowTypeInfo = cbTypeInfo.checked;
    SetVerNodePositions();
    DrawTree();
  }


  function DrawExpander(ctx, px, py, bExpanded)
  {
    var left = px - nExpanderHalfSize;
    var right = px + nExpanderHalfSize;
    var top = py - nExpanderHalfSize;
    var bottom = py + nExpanderHalfSize;

    // clear background
    //ctx.clearRect(left, top, nExpanderSize, nExpanderSize);
    ctx.beginPath();
    ctx.fillStyle = sArrowBackgroundColor; //sNodeBackgroundColor; //"#FFFFFF";
    ctx.fillRect(left, top, nExpanderSize, nExpanderSize);
    ctx.stroke();

    // draw border square
    ctx.beginPath();
    ctx.lineWidth = nLineWidth;
    ctx.strokeStyle = sArrowBorderColor; //"#404040"; //sLineColor; //"black";
    ctx.rect(left - 0.5, top - 0.5, nExpanderSize + 1, nExpanderSize + 1);
    ctx.stroke();

    if (bExpanded) {
      // draw left arrow
      ctx.beginPath();
			ctx.fillStyle = sNodeBackgroundColor;
			//ctx.lineWidth = nArrowLineWidth;
			//ctx.strokeStyle = sArrowColor;
      ctx.moveTo(px + 2, top + 1.5);
      ctx.lineTo(px - 3, py);
			ctx.lineTo(px + 2, bottom - 1.5);
      //ctx.stroke();
			ctx.fill();
    }
    else {
      // draw right arrow
      ctx.beginPath();
			ctx.fillStyle = sNodeBackgroundColor;
			//ctx.lineWidth = nArrowLineWidth;
			//ctx.strokeStyle = sArrowColor;
      ctx.moveTo(px - 2, top + 1.5);
      ctx.lineTo(px + 3, py);
			ctx.lineTo(px - 2, bottom - 1.5);
      //ctx.stroke();
			ctx.fill();
    }

		/*
    // draw minus sign (horizontal line)
    ctx.beginPath();
    ctx.lineWidth = nPlusMinusLineWidth;
    ctx.strokeStyle = sPlusMinusColor; //"#e00000"; //"red"; "blue";
    ctx.moveTo(left + nExpanderDistance, py);
    ctx.lineTo(right + 0.2 - nExpanderDistance, py);
    ctx.stroke();

    if (!bExpanded) {
      // draw vertical line for plus sign
      ctx.beginPath();
      ctx.moveTo(px, top + nExpanderDistance);
      ctx.lineTo(px, bottom + 0.2 - nExpanderDistance);
      ctx.stroke();
    }
		*/
  }


  function DrawAttrExpander(ctx, px, py, bExpanded)
  {
    var left = px - nExpanderHalfSize;
    var right = px + nExpanderHalfSize;
    var top = py - nExpanderHalfSize;
    var bottom = py + nExpanderHalfSize;

    // clear background
    //ctx.clearRect(left, top, nExpanderSize, nExpanderSize);
    ctx.beginPath();
    ctx.fillStyle = sArrowBackgroundColor;
    ctx.fillRect(left, top, nExpanderSize, nExpanderSize);
    ctx.stroke();

    // draw border square
    ctx.beginPath();
    ctx.lineWidth = nLineWidth;
    ctx.strokeStyle = sArrowBorderColor;
    ctx.rect(left - 0.5, top - 0.5, nExpanderSize + 1, nExpanderSize + 1);
    ctx.stroke();

		if (bExpanded) {
      // draw up arrow
      ctx.beginPath();
			ctx.fillStyle = sNodeBackgroundColor;
			//ctx.lineWidth = nArrowLineWidth;
			//ctx.strokeStyle = sArrowColor;
      ctx.moveTo(left + 1.5, py + 2);
      ctx.lineTo(px, py - 3);
			ctx.lineTo(right - 1.5, py + 2);
      //ctx.stroke();
			ctx.fill();
    }
    else {
      // draw down arrow
      ctx.beginPath();
			ctx.fillStyle = sNodeBackgroundColor;
			//ctx.lineWidth = nArrowLineWidth;
			//ctx.strokeStyle = sArrowColor;
      ctx.moveTo(left + 1.5, py - 2);
      ctx.lineTo(px, py + 3);
			ctx.lineTo(right - 1.5, py - 2);
      //ctx.stroke();
			ctx.fill();
    }
  }


  function DrawSizeRuler(ctx, x, y, n)
  {
    var len;
    var xx = x;

    ctx.lineWidth = 0.25;
    ctx.strokeStyle = "black";

    ctx.beginPath();
    ctx.moveTo(x, y);
    ctx.lineTo(x + n * 2, y);
    ctx.stroke();

    for (i = 0; i < n; i++) {
      ctx.beginPath();
      ctx.moveTo(xx, y);
      len = 3;
      if (i % 5 == 0) len = 5;
      if (i % 10 == 0) len = 8;
      ctx.lineTo(xx, y + len);
      ctx.stroke();
      xx += 2;
    }
  }


  function DrawAnnotation(ctx, nodeIndex)
  {
    var node = Nodes[nodeIndex];
    var y = node.bottom + nAnnotationDistance;

    if (node.maxOccurs > 1 || node.maxOccurs < 0)
      y += nMultipleNodeOffset;

    /*
    var annotation = nodeIndex;
    if (node.annotation)
      annotation += ' ' + node.annotation;
    */
    var annotation = node.annotation;

    if (node.typeDescription && bShowTypeInfo) {
      //ctx.clearRect(node.left - 10, y - 1, node.totalWidth + 10, nAnnotationTextHeight + 5);
      ctx.beginPath();
      ctx.strokeStyle = "black";
      ctx.font = sTypeDescriptionFont;
      ctx.fillStyle = sAnnotationColor;
      ctx.fillText(node.typeDescription, node.left, y + nAnnotationTextHeight);
      ctx.stroke();
      y += nAnnotationTextHeight + nAnnotationLineDistance;
    }

    if (annotation && bShowAnnotations) {
			/*
      ctx.clearRect(node.left - 10, y - 1, 500 / *node.totalWidth* /, nAnnotationTextHeight + 5);
      ctx.beginPath();
      ctx.strokeStyle = "black";
      ctx.font = sAnnotationFont;
      ctx.fillStyle = sAnnotationColor;
      ctx.fillText(annotation, node.left, y + nAnnotationTextHeight);
      ctx.stroke();
			*/
			for (i = 0; i < Nodes[nodeIndex].annotationLines.length; i++) {
				ctx.beginPath();
				//ctx.strokeStyle = "black";
				ctx.font = sAnnotationFont;
				ctx.fillStyle = sAnnotationColor;
				ctx.fillText(Nodes[nodeIndex].annotationLines[i], node.left, y + nAnnotationTextHeight);
				ctx.stroke();
				y += nAnnotationTextHeight + nAnnotationLineDistance;
			}
    }
  }


  function DrawOctagonShape(ctx, left, top, width, height, corner)
  {
    var right = left + width;
    var bottom = top + height;

    ctx.moveTo(left + corner, top);
    ctx.lineTo(right - corner, top);
    ctx.lineTo(right, top + corner);
    ctx.lineTo(right, bottom - corner);
    ctx.lineTo(right - corner, bottom);
    ctx.lineTo(left + corner, bottom);
    ctx.lineTo(left, bottom - corner);
    ctx.lineTo(left, top + corner);
    ctx.lineTo(left + corner, top);
  }


  function DrawOctagonWithShadow(ctx, nodeIndex)
  {
    var node = Nodes[nodeIndex];

    ctx.beginPath();
    ctx.fillStyle = sShadowColor;
    DrawOctagonShape(ctx, node.left + nShadowOffset, node.top + nShadowOffset, nSequenceWidth, nSequenceHeight, nSequenceCornerSize);
    ctx.fill();

    ctx.beginPath();
    if (nodeIndex == nLastClickedNodeIndex)
      ctx.fillStyle = sSelectedNodeBackgroundColor;
    else
      ctx.fillStyle = sNodeBackgroundColor;
    DrawOctagonShape(ctx, node.left, node.top, nSequenceWidth, nSequenceHeight, nSequenceCornerSize);
    ctx.fill();

    ctx.beginPath();
    ctx.lineWidth = nLineWidth;
    ctx.strokeStyle = sLineColor; //"black";
    DrawOctagonShape(ctx, node.left, node.top, nSequenceWidth, nSequenceHeight, nSequenceCornerSize);
    ctx.stroke();
  }


  function DrawPoints(ctx, nodeIndex)
  {
    var node = Nodes[nodeIndex];
    var xx = node.right + nPointsDistance * 2;  // + nMinHorLineLength;
    var yy = node.verCenter - nPointsHalfSize;

    ctx.fillStyle = sPointsColor;

    for (i = 4; i > 0; i--) {
      ctx.beginPath();
      ctx.fillRect(xx, yy, nPointsSize, nPointsSize);
      ctx.stroke();
      xx += nPointsSize + nPointsDistance;
    }
  }


  function DrawSequenceNode(ctx, nodeIndex)
  {
    var node = Nodes[nodeIndex];
    var right = node.right;

    DrawOctagonWithShadow(ctx, nodeIndex);

	  var dx = nSequenceWidth / 7;
	  var yy = node.verCenter;
	
	  var d = dx * 0.40;
	  var dd = d * 2;
	  var xx = node.left + dx * 2;

	  ctx.fillStyle = sLineColor; //"black";
	  ctx.beginPath();
    ctx.arc(xx, yy, d, 0, 2*Math.PI);
    ctx.stroke();

  	xx += dx * 1.5;
    ctx.beginPath();
    ctx.arc(xx, yy, d, 0, 2*Math.PI);
    ctx.stroke();

  	xx += dx * 1.5;
    ctx.beginPath();
    ctx.arc(xx, yy, d, 0, 2*Math.PI);
    ctx.stroke();

    DrawAnnotation(ctx, nodeIndex);

    if (node.firstChildIndex) {
      DrawExpander(ctx, node.expHorCenter, node.verCenter, node.expanded);
      right += nExpanderSize;
    }

    return right;
  }


  function DrawChoiceNode(ctx, nodeIndex)
  {
    var node = Nodes[nodeIndex];
    var right = node.right;

    DrawOctagonWithShadow(ctx, nodeIndex);

    var dx = nSequenceWidth / 6;
    var dx2 = dx * 0.66;
    var xx = node.left + dx;
    var dy = Math.round(nSequenceHeight / 5) + 0.5;
    var yy = node.verCenter;
    var top2 = yy - dy;
    var bottom2 = yy + dy;

    ctx.beginPath();
    ctx.moveTo(xx, yy);
    xx += dx;
    ctx.lineTo(xx, yy);
    xx += dx;
    ctx.lineTo(xx, top2 + 0.5);
    ctx.stroke();

    var d = dx * 0.33;
    var dd = d * 2;

    xx += dx - 1;
    ctx.fillStyle = sLineColor;
    ctx.beginPath();
    ctx.arc(xx, top2 - 1, d, 0, 2*Math.PI);
    ctx.stroke();

    ctx.beginPath();
    ctx.arc(xx + dx2 - 0.5, yy, d, 0, 2*Math.PI);
    ctx.stroke();

    ctx.beginPath();
    ctx.arc(xx, bottom2 + 1, d, 0, 2*Math.PI);
    ctx.stroke();

    DrawAnnotation(ctx, nodeIndex);

    if (node.firstChildIndex) {
      DrawExpander(ctx, node.expHorCenter, node.verCenter, node.expanded);
      right += nExpanderSize;
    }

    return right;
  }


  /*
  Nodes[0].left = x;
  Nodes[0].top = y;
  Nodes[0].right = x + nNodeWidth;
  Nodes[0].bottom = y + nNodeHeight;
  Nodes[0].width = nNodeWidth; 
  Nodes[0].verCenter = y + nHalfNodeHeight;
  Nodes[0].name = "FundsXML4";
  Nodes[0].annotation = "Root element of FundsXML 4.0 schema";
  Nodes[0].expanded = true;
  */

  function DrawElementNode(ctx, nodeIndex)
  {
    var node = Nodes[nodeIndex];
    //var nNodeWidth = node.right - node.left;
    //var nNodeHeight = node.bottom - node.top;
    var right = node.right;
    var rectLeft = node.left + 0.5;
    var rectTop = node.top + 0.5;
    var rectHeight = node.height - 0.5; //nNodeHeight
    var rectWidth = node.width - 0.5;

    if (node.maxOccurs > 1 || node.maxOccurs < 0) {
      // draw shadow
      ctx.beginPath();
      ctx.fillStyle = sShadowColor;
      ctx.fillRect(node.left + nMultipleNodeOffset + nShadowOffset, node.top + nMultipleNodeOffset + nShadowOffset, node.width + 0.5, node.height);
      ctx.stroke();

      // draw background for main node rectangle
      ctx.beginPath();
      ctx.fillStyle = sNodeBackgroundColor; //"#FFFFFF";
      ctx.fillRect(rectLeft + nMultipleNodeOffset, rectTop + nMultipleNodeOffset, node.width, node.height);
      ctx.stroke();

      // draw main node rectangle
      ctx.beginPath();
      ctx.lineWidth = nLineWidth;
      ctx.strokeStyle = sLineColor; //"black";
      if (node.minOccurs == 0)
        ctx.setLineDash([4, 4]);  // [5,3] ... dashes are 5px and spaces are 3px
      ctx.rect(rectLeft + nMultipleNodeOffset, rectTop + nMultipleNodeOffset, rectWidth, rectHeight);
      ctx.stroke();
    }
    else {
      // draw shadow
      ctx.beginPath();
      /*if (nodeIndex == nLastClickedNodeIndex)
        ctx.fillStyle = sSelectedShadowColor;
      else*/
      ctx.fillStyle = sShadowColor;
      ctx.fillRect(node.left + nShadowOffset, node.top + nShadowOffset, node.width + 0.5, node.height);
      ctx.stroke();
    }

    // draw background for main node rectangle
    ctx.beginPath();
    if (nodeIndex == nLastClickedNodeIndex)
      ctx.fillStyle = sSelectedNodeBackgroundColor;
    else
      ctx.fillStyle = sNodeBackgroundColor; //"#FFFFFF";
    ctx.fillRect(rectLeft, rectTop, node.width, node.height);
    ctx.stroke();

    // draw main node rectangle
    ctx.beginPath();
    ctx.lineWidth = nLineWidth;
    ctx.strokeStyle = sLineColor; //"black";
    if (node.minOccurs == 0)
      ctx.setLineDash([4,4]);  // [5,3] ... dashes are 5px and spaces are 3px
    ctx.rect(rectLeft, rectTop, rectWidth, rectHeight);
    ctx.stroke();

    ctx.setLineDash([]);
    //ctx.shadowBlur = 0;

    ctx.beginPath();
    ctx.font = sNodeNameFont; //"10pt Arial";
    ctx.fillStyle = sNodeNameColor; //"black";
    ctx.fillText(node.name, node.left + nNodeTextPadding, node.top + nNodeTextHeight + nNodeTextPadding);
    ctx.stroke();

    if (Nodes[nodeIndex].attributes) {
      var i, yy = node.top + nNodeTextHeight + nNodeTextPadding * 2;
      if (node.showAttributes) {
        DrawLine(ctx, rectLeft, yy, node.right, yy);
				//DrawAttrExpander(ctx, node.right - nExpanderSize, yy, node.showAttributes);
        yy += nAttributeVerPadding;
        for (i = 0; i < Nodes[nodeIndex].attributes.length; i++) {
          ctx.beginPath();
          if (node.attributes[i].use == "required")
            ctx.font = sMandatoryAttributeNameFont;
          else
            ctx.font = sOptionalAttributeNameFont;
          ctx.fillStyle = sAttributeNameColor;
          ctx.fillText(node.attributes[i].name, node.left + nNodeTextPadding, yy + nNodeTextHeight);
          ctx.stroke();
          yy += nAttributeLineHeight;
        }
      }
			else
				DrawAttrExpander(ctx, node.right - nExpanderSize, yy, node.showAttributes);
    }

    // typeDescription

    DrawAnnotation(ctx, nodeIndex);

    if (node.firstChildIndex) {
      DrawExpander(ctx, node.right, node.verCenter, node.expanded);
      right += nExpanderHalfSize;
    }
    else {
      if (node.recursiveType || node.typeName == "xs:anyType" || node.baseTypeName == "xs:anyType")
        DrawPoints(ctx, nodeIndex);
    }

    return right;
  }


  function DrawLine(ctx, x1, y1, x2, y2)
  {
    ctx.beginPath();
    ctx.lineWidth = nLineWidth;
    ctx.strokeStyle = sLineColor; //"black";
    ctx.moveTo(x1, y1);
    ctx.lineTo(x2, y2);
    ctx.stroke();
  }


  function IsMultiple(maxOccurs)
  {
    return (maxOccurs > 1 || maxOccurs < 0);
  }


  function SetNodeSize(ctx, nodeIndex, recursive)
  {
    var typeWidth = 0;
    var annotationWidth = 0;

    //if (Nodes[nodeIndex].type == NodeTypeChoice || Nodes[nodeIndex].type == NodeTypeSequence) {
    if (!IsRealNode(Nodes[nodeIndex].type)) {
      Nodes[nodeIndex].height = nSequenceHeight;
      Nodes[nodeIndex].width = nSequenceWidth;
    }
    else {
      var height = nNodeHeight;
      ctx.font = sNodeNameFont;
      var width = ctx.measureText(Nodes[nodeIndex].name).width + nNodeTextPadding * 2;

      if (Nodes[nodeIndex].firstChildIndex)
        width += nExpanderHalfSize;

      if (Nodes[nodeIndex].attributes) {
        width += nExpanderSize;
        if (Nodes[nodeIndex].showAttributes) {
          var i, width2 = 0;
          for (i = 0; i < Nodes[nodeIndex].attributes.length; i++) {
            if (Nodes[nodeIndex].attributes[i].use == "required")
              ctx.font = sMandatoryAttributeNameFont;
            else
              ctx.font = sOptionalAttributeNameFont;
            width2 = Math.max(width2, ctx.measureText(Nodes[nodeIndex].attributes[i].name).width);
          }
          height += Nodes[nodeIndex].attributes.length * nAttributeLineHeight + nAttributeVerPadding * 2;
          width = Math.max(width, width2 + nNodeTextPadding * 2);
        }
      }

      Nodes[nodeIndex].height = Math.round(height);
      Nodes[nodeIndex].width = Math.round(width);
    }

    var sText = Nodes[nodeIndex].typeDescription;
    if (sText && sText.length > 0) {
      ctx.font = sTypeDescriptionFont;
      typeWidth = ctx.measureText(sText).width;
    }

    sText = Nodes[nodeIndex].annotation;
    if (sText && sText.length > 0) {
      ctx.font = sAnnotationFont;
			var totalTextWidth = ctx.measureText(sText).width;
			var annotationLines = new Array();
			var nChars = 0, nPartWidth = 0, nChars2 = 0, nPartWidth2 = 0;
			var sPart = "", sPart2 = "", chr = " ";

			while (totalTextWidth > nMaxAnnotationWidth) {
				nChars = Math.round((sText.length * nMaxAnnotationWidth) / totalTextWidth);
				sPart = sText.substr(0, nChars);
				nPartWidth = ctx.measureText(sPart).width;

				// find longest part of text fitting into maximum width
				if (nPartWidth < nMaxAnnotationWidth) {
					nChars2 = nChars + 1;
					sPart2 = sText.substr(0, nChars2);
					nPartWidth2 = ctx.measureText(sPart2).width;
					while (nPartWidth2 <= nMaxAnnotationWidth) {
						nChars = nChars2;
						sPart = sPart2;
						nPartWidth = nPartWidth2;
						nChars2 = nChars + 1;
						sPart2 = sText.substr(0, nChars2);
						nPartWidth2 = ctx.measureText(sPart2).width;
					}
				}

				if (nPartWidth > nMaxAnnotationWidth) {
					nChars2 = nChars - 1;
					sPart2 = sText.substr(0, nChars2);
					nPartWidth2 = ctx.measureText(sPart2).width;
					while (nPartWidth2 > nMaxAnnotationWidth) {
						nChars = nChars2;
						sPart = sPart2;
						nPartWidth = nPartWidth2;
						nChars2 = nChars - 1;
						sPart2 = sText.substr(0, nChars2);
						nPartWidth2 = ctx.measureText(sPart2).width;
					}
				}

				// search for delimiter
				nChars2 = nChars;
				chr = sText.substr(nChars, 1);
				while (nChars2 > 10 && sTextDelimeters.indexOf(chr) < 0) {
					nChars2--;
					chr = sText.substr(nChars2, 1);
				}
				
				if (sTextDelimeters.indexOf(chr) >= 0) {
					// cut at delimiter
					sPart = sText.substr(0, nChars2);
					annotationLines.push(sPart);
					sText = sText.substr(nChars2 + 1, 999);
				}
				else {
					// cut at maximum and insert minus sign
					nChars2 = nChars - 1;
					sPart = sText.substr(0, nChars2) + "-";
					annotationLines.push(sPart);
					sText = sText.substr(nChars2, 999);
				}

				totalTextWidth = ctx.measureText(sText).width;
			}

			annotationLines.push(sText);
			
			for (i = 0; i < annotationLines.length; i++)
				annotationWidth = Math.max(annotationWidth, ctx.measureText(annotationLines[i]).width);

			Nodes[nodeIndex].annotationLines = annotationLines;
			Nodes[nodeIndex].footerHeight = Math.round((nAnnotationTextHeight + nAnnotationLineDistance) * annotationLines.length);
		}
		else {
			Nodes[nodeIndex].footerHeight = 0;
			Nodes[nodeIndex].footerWidth = 0;
		}

  	Nodes[nodeIndex].footerWidth = Math.round(Math.max(typeWidth, annotationWidth));

	  var totalHeight = Nodes[nodeIndex].height + Nodes[nodeIndex].footerHeight;

  	if (IsMultiple(Nodes[nodeIndex].maxOccurs))
	    totalHeight += nMultipleNodeOffset;

  	if (Nodes[nodeIndex].typeDescription)
  	  totalHeight += nAnnotationTextHeight + nAnnotationLineDistance;

  	if (totalHeight > 0)
  	  totalHeight += nAnnotationDistance - nAnnotationLineDistance;

	  Nodes[nodeIndex].totalHeight = totalHeight;

	  if (recursive) {
      var nextNodeIndex = Nodes[nodeIndex].firstChildIndex;

      while (nextNodeIndex) {
        SetNodeSize(ctx, nextNodeIndex, recursive);
        nextNodeIndex = Nodes[nextNodeIndex].nextIndex;
      }
    }
	}


	function CurrentTotalHeight(nodeIndex)
  {
	  var bAddBaseDistance = false;
	  var totalHeight = Nodes[nodeIndex].height;

	  if (IsMultiple(Nodes[nodeIndex].maxOccurs))
	    totalHeight += nMultipleNodeOffset;

	  if (Nodes[nodeIndex].typeDescription && bShowTypeInfo) {
	    totalHeight += nAnnotationTextHeight + nAnnotationLineDistance;
	    bAddBaseDistance = true;
	  }

	  if (Nodes[nodeIndex].annotation && bShowAnnotations) {
	    totalHeight += Nodes[nodeIndex].footerHeight;
	    bAddBaseDistance = true;
	  }

	  if (bAddBaseDistance)
	    totalHeight += nAnnotationDistance - nAnnotationLineDistance;

	  return totalHeight;
	}


  function SetNodeSizes()
	{
    var canvas = document.getElementById("tree");
    var ctx = canvas.getContext("2d");

    ctx.font = sNodeNameFont;
		SetNodeSize(ctx, rootNodeIndex, true);
	}
	
	
	function GetTreeHeight(nodeIndex)
	{
	  var nodeHeight = CurrentTotalHeight(nodeIndex); //Nodes[nodeIndex].totalHeight;
		var childrenHeight = 0 - nVerNodeDistance;
		var result = nodeHeight;

		if (Nodes[nodeIndex].expanded) {
      var nextNodeIndex = Nodes[nodeIndex].firstChildIndex;

      while (nextNodeIndex) {
        childrenHeight += GetTreeHeight(nextNodeIndex) + nVerNodeDistance;
        nextNodeIndex = Nodes[nextNodeIndex].nextIndex;
      }
		}

		if (childrenHeight > 0) {
		  Nodes[nodeIndex].childrenHeight = childrenHeight;
			result = childrenHeight;
		}
			
		return result;
	}


	function SetVerNodePosition(nodeIndex, y)
	{
		var verPosition = y;
    var nHalfHeight = Nodes[nodeIndex].height / 2;
    var firstChildIndex = Nodes[nodeIndex].firstChildIndex;

		if (firstChildIndex && Nodes[nodeIndex].expanded) {
			var nextNodeIndex = firstChildIndex;
			var previousNodeIndex;
			var childNodes = 0;

			while (nextNodeIndex) {
			  childNodes++;
        verPosition = SetVerNodePosition(nextNodeIndex, verPosition);
				previousNodeIndex = nextNodeIndex;
        nextNodeIndex = Nodes[nextNodeIndex].nextIndex;
      }

		  Nodes[nodeIndex].verCenter = Math.round((Nodes[firstChildIndex].verCenter + Nodes[previousNodeIndex].verCenter) / 2);
		  Nodes[nodeIndex].top = Nodes[nodeIndex].verCenter - nHalfHeight;
		  Nodes[nodeIndex].bottom = Nodes[nodeIndex].top + Nodes[nodeIndex].height;

		  verPosition = Math.max(verPosition, Nodes[nodeIndex].top + CurrentTotalHeight(nodeIndex)/*Nodes[nodeIndex].totalHeight*/ + nVerNodeDistance);
		}
		else {
		  Nodes[nodeIndex].top = y;
		  Nodes[nodeIndex].verCenter = y + nHalfHeight;
		  Nodes[nodeIndex].bottom = y + Nodes[nodeIndex].height;
		  verPosition += CurrentTotalHeight(nodeIndex)/*Nodes[nodeIndex].totalHeight*/ + nVerNodeDistance;
		  nSchemaWidth = Math.max(nSchemaWidth, Nodes[nodeIndex].left + Nodes[nodeIndex].totalWidth);
		}

		return verPosition;
	}


	function SetVerNodePositions()
  {
    nSchemaHeight = 0;
    nSchemaWidth = 0;

    nSchemaHeight = SetVerNodePosition(rootNodeIndex, nSchemaBorder);
	}


	function ChildNodeCount(nodeIndex)
  {
	  var result = 0;
	  var nextNodeIndex = Nodes[nodeIndex].firstChildIndex;

	  while (nextNodeIndex) {
	    result++;
	    nextNodeIndex = Nodes[nextNodeIndex].nextIndex;
	  }

	  return result;
	}
	

	function SetHorNodePosition(nodeIndex, x, recursive, visible)
	{
	  var nodeType = Nodes[nodeIndex].type;
	  var firstChildIndex = Nodes[nodeIndex].firstChildIndex;

	  Nodes[nodeIndex].left = x;
	  var width = Nodes[nodeIndex].width;
	  var right = x + width;
	  Nodes[nodeIndex].right = right;
	  Nodes[nodeIndex].expHorCenter = -999;
	  Nodes[nodeIndex].visible = visible;

	  if (firstChildIndex)
	    if (nodeType == NodeTypeChoice || nodeType == NodeTypeSequence) {
	      Nodes[nodeIndex].expHorCenter = right + nExpanderHalfSize;
	      width += nExpanderSize;
	    }
	    else {
	      Nodes[nodeIndex].expHorCenter = right;
	      width += nExpanderHalfSize;
	    }

		Nodes[nodeIndex].totalWidth = Math.max(width + nMinHorLineLength, Nodes[nodeIndex].footerWidth - nSequenceWidth);

		if ((nodeType == NodeTypeChoice || nodeType == NodeTypeSequence) && ChildNodeCount(nodeIndex) > 1)
		  Nodes[nodeIndex].totalWidth += nMinHorLineLength;

		var nextHorPos = x + Nodes[nodeIndex].totalWidth;
		
		//if (Nodes[nodeIndex].expanded) {
		var nextNodeIndex = firstChildIndex;
		var childrenVisible = visible && Nodes[nodeIndex].expanded;

    while (nextNodeIndex) {
      SetHorNodePosition(nextNodeIndex, nextHorPos, recursive, childrenVisible);
      nextNodeIndex = Nodes[nextNodeIndex].nextIndex;
    }
		//}
  }


  function CalcNodePositions()
	{
	  nSchemaHeight = 0;
	  nSchemaWidth = 0;

	  // Calculate height of all visible nodes including their visible child nodes
		GetTreeHeight(rootNodeIndex);

		// Calculate vertical position of all visible nodes
		SetVerNodePositions();

		// Calculate horizontal position of all visible nodes
		SetHorNodePosition(rootNodeIndex, nSchemaBorder, true);

  }


  function DrawNode(ctx, nodeIndex, recursive)
  {
    var node = Nodes[nodeIndex];
    var nodeName = node.name;
    var nodeType = node.type;
    var right = node.right;

    if (nodeType == NodeTypeChoice)
      right = DrawChoiceNode(ctx, nodeIndex);
    else
      if (nodeType == NodeTypeSequence)
        right = DrawSequenceNode(ctx, nodeIndex);
      else
        right = DrawElementNode(ctx, nodeIndex);

    if (recursive && node.expanded) {
      var childNodes = ChildNodeCount(nodeIndex);
      var nextNodeIndex = node.firstChildIndex;
      var x = node.left + node.totalWidth;
      var y1 = node.verCenter;
      var y2 = node.verCenter;
      if (childNodes > 1)
        x -= nMinHorLineLength;
      DrawLine(ctx, right, node.verCenter, x, node.verCenter);

      while (nextNodeIndex) {
        if (childNodes > 1) {
          var y = Nodes[nextNodeIndex].verCenter;
          DrawLine(ctx, x, y, Nodes[nextNodeIndex].left, y);
          y1 = Math.min(y1, y);
          y2 = Math.max(y2, y);
        }
        DrawNode(ctx, nextNodeIndex, recursive);
        nextNodeIndex = Nodes[nextNodeIndex].nextIndex;
      }

      if (childNodes > 1)
        DrawLine(ctx, x, y1, x, y2);
    }
  }
	
	
	function GetMaxChildWidth(nodeIndex)
	{
		var result = 0;
		var nextNodeIndex = Nodes[nodeIndex].firstChildIndex;

		while (nextNodeIndex) {
			result = Math.max(result, Nodes[nextNodeIndex].totalWidth);
			nextNodeIndex = Nodes[nextNodeIndex].nextIndex;
		}
	
		return result;
	}


	function ExpandChoiceNodes(nodeIndex)
  {
		var nextNodeIndex = Nodes[nodeIndex].firstChildIndex;

		while (nextNodeIndex) {
		  if (Nodes[nextNodeIndex].type == NodeTypeChoice)
		    Nodes[nextNodeIndex].expanded = true;
			nextNodeIndex = Nodes[nextNodeIndex].nextIndex;
		}
  }


  function MakeVisibleAndUpdate(x, y)
  {
    canvasContainerScrollLeft = canvasContainer.scrollLeft; //.scrollLeftMax
    canvasContainerScrollTop = canvasContainer.scrollTop; //.scrollTopMax

    MakeVisible(x, y);

    canvasContainer.scrollLeft = Math.min(canvasContainerScrollLeft, canvas.width - canvasContainerWidth);
    canvasContainer.scrollTop = Math.min(canvasContainerScrollTop, canvas.height - canvasContainerHeight);
  }


  function MoveNodeToCenter(nodeIndex)
  {
    canvasContainerScrollLeft = Nodes[nodeIndex].left + Nodes[nodeIndex].width - canvasContainerWidth * 0.8;
    canvasContainerScrollTop = Nodes[nodeIndex].top + Nodes[nodeIndex].height - canvasContainerHeight * 0.5;

    canvasContainer.scrollLeft = Math.max(Math.min(canvasContainerScrollLeft, canvas.width - canvasContainerWidth), 0);
    canvasContainer.scrollTop = Math.max(Math.min(canvasContainerScrollTop, canvas.height - canvasContainerHeight), 0);
  }


  function DrawTree()
  {
    // set height of canvas container to window height (= full screen)
    var canvasHeight = window.innerHeight - (schemaOptions.offsetHeight + searchResultDiv.offsetHeight + bottomLineParagraph.offsetHeight);
    canvasContainer.style.height = canvasHeight + "px"; //document.offsetHeight;
		// make complete canvas container visible
		//document.body.scrollTop = canvasContainer.offsetTop + 1;
		document.body.scrollTop = schemaOptions.offsetTop + 1;

		canvasContainerWidth = canvasContainer.clientWidth;
		canvasContainerHeight = canvasContainer.clientHeight;

    //var canvas = document.getElementById("tree");
    var ctx = canvas.getContext("2d");

    ctx.imageSmoothingEnabled = false;
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    //DrawSizeRuler(ctx, 5, 5, 50);

    DrawNode(ctx, rootNodeIndex, true);
		
		// make sure last clicked/expanded node is visible
		canvasContainerScrollLeft = canvasContainer.scrollLeft; //.scrollLeftMax
		canvasContainerScrollTop = canvasContainer.scrollTop; //.scrollTopMax

		if (nSchemaWidth <= canvasContainerWidth) {
		  canvasContainerScrollLeft = 0;
		  canvasContainer.scrollLeft = canvasContainerScrollLeft;
		}

		if (nSchemaHeight <= canvasContainerHeight) {
		  canvasContainerScrollTop = 0;
		  canvasContainer.scrollTop = canvasContainerScrollTop;
		}

		if (nLastClickedNodeIndex) {
			if (nLastExpandedNodeIndex) {
				var maxChildWidth = GetMaxChildWidth(nLastExpandedNodeIndex) + 40;
				var halfTreeHeight = Math.min(GetTreeHeight(nLastExpandedNodeIndex), canvasContainerHeight) / 2;
				//var halfTreeHeight = Math.min(Nodes[nLastExpandedNodeIndex].childrenHeight, canvasContainerHeight) / 2;
				var x = Nodes[nLastExpandedNodeIndex].left + Nodes[nLastExpandedNodeIndex].totalWidth + maxChildWidth;
				MakeVisible(x, Nodes[nLastExpandedNodeIndex].verCenter + halfTreeHeight + 80);
				MakeVisible(x, Nodes[nLastExpandedNodeIndex].verCenter - halfTreeHeight);
				nLastExpandedNodeIndex = null;
			}
			if (nLastCollapsedNodeIndex) {
				var x = Nodes[nLastClickedNodeIndex].left + Nodes[nLastClickedNodeIndex].totalWidth - canvasContainerWidth * 0.8;
				MakeVisible(x, Nodes[nLastClickedNodeIndex].top - canvasContainerHeight * 0.5);
				MakeVisible(x, Nodes[nLastClickedNodeIndex].top + CurrentTotalHeight(nLastClickedNodeIndex)/*Nodes[nLastClickedNodeIndex].totalHeight*/ + 80);
				nLastCollapsedNodeIndex = null;
		  }
			
			MakeVisible(Nodes[nLastClickedNodeIndex].left, Nodes[nLastClickedNodeIndex].top);

			canvasContainer.scrollLeft = Math.min(canvasContainerScrollLeft, canvas.width - canvasContainerWidth);
			canvasContainer.scrollTop = Math.min(canvasContainerScrollTop, canvas.height - canvasContainerHeight);
		}

		/*
	  var container = document.getElementById("canvas-container");
    var rect = canvas.getBoundingClientRect();  // 10/48/10012/5050
		
		var scrollTop = container.scrollTop;

    tracePar.innerHTML = "BoundingClientRect=" + rect.left + "/" + rect.top;
    tracePar.innerHTML = tracePar.innerHTML + "/" + rect.right + "/" + rect.bottom;
    tracePar.innerHTML = tracePar.innerHTML + " ,  ScrollPosition=" + container.scrollLeft + "/" + container.scrollTop;
    tracePar.innerHTML = tracePar.innerHTML + " ,  ContainerSize=" + container.clientWidth + "/" + container.clientHeight;
		// ContainerSize=1228/733
    tracePar.innerHTML = tracePar.innerHTML + " ,  CanvasSize=" + canvas.clientWidth + "/" + canvas.clientHeight;
		
		if (nLastClickedNodeIndex) {
		  var node = Nodes[nLastClickedNodeIndex];
			tracePar.innerHTML = tracePar.innerHTML + " ,  LastClickedNode=" + node.left + "/" + node.top + "/" + node.right + "/" + node.bottom;
		}

		// BoundingClientRect=-1264/-1296.5/1238/1205.5 , ScrollPosition=1274/1275.5 , ContainerSize=1228/733 ,
		// CanvasSize=2500/2500 , LastClickedNode=2358/1772/2458/1796
		
		//window.scrollTo(300, 500);
		*/

    /*
    var x = 20.0;
    var y = 20.0;

    ctx.font = "bold 10pt Arial";
    var sText = "FundsXML4";
    var nTextHeight = nNodeTextHeight; // ctx.measureText(sText).height;
    var nTextWidth = ctx.measureText(sText).width;
    //alert("nTextWidth=" + nTextWidth + " ,  nTextHeight=" + nTextHeight);
    var nNodeWidth = Math.round(nTextWidth + nNodeTextPadding * 2 + nExpanderHalfSize);
    ctx.fillText(sText, x + nNodeTextPadding, y + nTextHeight + nNodeTextPadding);

    ctx.lineWidth = nLineWidth; // 0.75; // 0.5; // "1";
    / * if (bRootNodeExpanded)
      ctx.strokeStyle = "red";
    else * /
    ctx.strokeStyle = sLineColor; //"blue";
    ctx.rect(x + 0.5, y + 0.5, nNodeWidth - 0.5, nNodeHeight - 0.5);  // nTextHeight + nNodeTextPadding * 2 - 0.5);
    ctx.stroke();

    Nodes[0].left = x;
    Nodes[0].top = y;
    Nodes[0].right = x + nNodeWidth;
    Nodes[0].bottom = y + nNodeHeight;
    Nodes[0].width = nNodeWidth; 
    Nodes[0].verCenter = y + nHalfNodeHeight;
    Nodes[0].name = "FundsXML4";
    Nodes[0].annotation = "Root element of FundsXML 4.0 schema";
    Nodes[0].expanded = true;

    var yy = Nodes[0].bottom + nNodeTextPadding;
    sText = "Root element of FundsXML 4.0 schema";
    nTextHeight = nNodeTextHeight;
    nTextWidth = ctx.measureText(sText).width;
    //alert("nTextWidth=" + nTextWidth + " ,  nTextHeight=" + nTextHeight);

    ctx.beginPath();
    ctx.strokeStyle = "black";
    //ctx.font = "8pt Arial";
    ctx.font = "11px Arial";
    ctx.fillText(sText, x, yy + nTextHeight);
    ctx.stroke();

  	x += nNodeWidth;
  	y += nHalfNodeHeight;

  	DrawExpander(ctx, x, y, false);
  	x += nExpanderHalfSize;

  	var nLineLength = 50;
    / *
    ctx.beginPath();
    ctx.lineWidth = nLineWidth;
    ctx.strokeStyle = "black";
	  ctx.moveTo(x, y);
	  ctx.lineTo(x + nLineLength, y);
    ctx.stroke();
    * /
    DrawLine(ctx, x, y, x + nLineLength, y);
    x += nLineLength;

	  DrawSequenceNode(ctx, x, y);
	  x += nSequenceWidth + nExpanderHalfSize;
	  DrawExpander(ctx, x, y, true);
	  x += nExpanderHalfSize;

	  DrawLine(ctx, x, y, x + nLineLength, y);
	  x += nLineLength;

	  Nodes.push({});
	  Nodes[1].left = x;
	  Nodes[1].top = y - nHalfNodeHeight;
	  Nodes[1].right = x + nNodeWidth;
	  Nodes[1].bottom = y + nHalfNodeHeight;
	  Nodes[1].width = nNodeWidth;
	  Nodes[1].verCenter = y;
	  Nodes[1].name = "ControlData";
	  Nodes[1].annotation = "Attributes of the xml document";
	  Nodes[1].expanded = true;
	  DrawNode(ctx, Nodes[1]);
	  x += nNodeWidth + nExpanderHalfSize;

	  DrawLine(ctx, x, y, x + nLineLength, y);
	  x += nLineLength;

	  DrawChoiceNode(ctx, x, y);
	  x += nSequenceWidth + nExpanderHalfSize;
	  DrawExpander(ctx, x, y, false);
	  x += nExpanderHalfSize;
    */
	}


	function getCursorPosition(canvas, event)
  {
    var rect = canvas.getBoundingClientRect();
    var x = event.clientX - rect.left;
    var y = event.clientY - rect.top;
    //console.log("x: " + x + " y: " + y);
    alert("x: " + x + " [" + Nodes[0].left + " - " + Nodes[0].right + "]  /  y: " + y + " [" + Nodes[0].top + " - " + Nodes[0].bottom + "]");
  }


  function getObjectAtCursor(canvas, event)
  {
    var result;
    var rect = canvas.getBoundingClientRect();
    var x = event.clientX - rect.left;
    var y = event.clientY - rect.top;

    //console.log("x: " + x + " y: " + y);
    for (i = 0; i < Nodes.length; i++)
      if (x >= Nodes[i].left && x <= Nodes[i].right + nExpanderHalfSize && y >= Nodes[i].top && y <= Nodes[i].bottom + nExpanderHalfSize)
        result = i;

    return result;
  }


  var nodeDetails = document.getElementById('node-details');
  var NodeDetailsName = document.getElementById("nd-name");
  var NodeDetailsAttr = document.getElementById("nd-attr");
  var NodeDetailsType = document.getElementById("nd-type");
  var NodeDetailsPattern = document.getElementById("nd-pattern");
  var NodeDetailsAnno = document.getElementById("nd-anno");
  var NodeDetailsEnum = document.getElementById("nd-enum");
  var NodeDetailsXPath = document.getElementById("nd-xpath");


  function ShowNodeDetails(nodeIndex)
  {
    var node = Nodes[nodeIndex];
    var clientRect = canvas.getBoundingClientRect();
    var i, txt;

    var xOffset = -20;
    var yOffset = nNodeTextHeight + nNodeTextPadding + 2;
    var x = node.left + xOffset + clientRect.left;
    var y = node.top + yOffset + clientRect.top + document.body.scrollTop;
    //var y = node.top + node.bottom + clientRect.top - 5;
    nodeDetails.style.left = x + "px";
    nodeDetails.style.top = y + "px";

    /*
		document.body.scrollTop = canvasContainer.offsetTop + 1;
    <tr><td class="node-column">Name</td><td class="node-name" id="nd-name">SampleNodeName</td></tr>
    <tr><td class="node-column">Attr</td><td class="attributes" id="nd-attr"><b>AttrOne:</b> TypeInfo<br/><b>AttributeTwo:</b> TypeInfo</td></tr>
    <tr><td class="node-column">Type</td><td class="type-description" id="nd-type">Type Description</td></tr>
    <tr><td class="node-column">Descr</td><td class="annotation" id="nd-anno">First line of annotation text<br/>second line of annotation text<br/>third line</td></tr>
    <tr><td class="node-column">Enum</td><td class="enumeration" id="nd-enum">FIRST<br/>SECOND<br/>THIRD<br/>FOURTH</td></tr>
    <tr><td class="node-column">XPath</td><td class="xpath" id="nd-xpath">/FundsXML4/Funds/Fund/FundDynamicData/TotalAssetValues/TotalAssetValue</td></tr>
    */
    NodeDetailsName.innerHTML = node.name;

    if (Nodes[nodeIndex].attributes) {
      txt = "<b>" + node.attributes[0].name + ": </b>" + node.attributes[0].type + " [" + node.attributes[0].use + "]";
      for (i = 1; i < node.attributes.length; i++) {
        txt += "<br/><b>" + node.attributes[i].name + ": </b> " + node.attributes[i].type;
      if (node.attributes[i].use)
        txt += " <b>[" + node.attributes[i].use + "]</b>";
      }
    }
    else
      txt = "";
    NodeDetailsAttr.innerHTML = txt;

    NodeDetailsType.innerHTML = node.typeDescription;

    if (node.pattern)
      txt = node.pattern;
    else
      txt = "";
    NodeDetailsPattern.innerHTML = txt;

    if (node.annotation) {
      txt = node.annotationLines[0];
      for (i = 1; i < node.annotationLines.length; i++) {
        txt += "<br/>" + node.annotationLines[i];
      }
    }
    else
      txt = "";
    NodeDetailsAnno.innerHTML = txt;

    if (node.enumeration && node.enumeration[0]) {
      // calculate average length of enumerations
      var len = node.enumeration[0].length;
      for (i = 1; i < node.enumeration.length; i++)
        len += node.enumeration[i].length;
      len = len / node.enumeration.length;

      if (len > 5) {
        // fill enumeration block
        txt = node.enumeration[0];
        for (i = 1; i < node.enumeration.length; i++) {
          txt += "<br/>" + node.enumeration[i];
        }
      }
      else {
        txt = node.enumeration[0];
        len = txt.length;
        for (i = 1; i < node.enumeration.length; i++) {
          if (len + node.enumeration[i].length > 40) {
            txt += "<br/>" + node.enumeration[i];
            len = node.enumeration[i].length;
          }
          else {
            txt += ", " + node.enumeration[i];
            len += 2 + node.enumeration[i].length;
          }
        }
      }
    }
    else
      txt = "";
    NodeDetailsEnum.innerHTML = txt;

    //txt = "/FundsXML4/.../" + node.name;
    txt = XPath(nodeIndex);
    NodeDetailsXPath.innerHTML = txt;

    nodeDetails.style.display = "block";

    var xx = x + nodeDetails.offsetWidth - clientRect.left;
    var yy = y + nodeDetails.offsetHeight - clientRect.top;
    MakeVisibleAndUpdate(xx, yy);

    // make sure node details window is displayed completely
    clientRect = canvas.getBoundingClientRect();
    x = node.left + xOffset + clientRect.left;
    y = node.top + yOffset + clientRect.top + document.body.scrollTop;
    nodeDetails.style.left = x + "px";
    nodeDetails.style.top = y + "px";

    //nodeDetails.style.display = "block";
    setTimeout(function () { nodeDetails.style.display = "block"; }, 50);
  }


  function NodeClicked(nodeIndex, showNodeDetails)
  {
		nLastClickedNodeIndex = nodeIndex;
		nLastExpandedNodeIndex = null;

    if (nodeIndex) {
      var firstChildIndex = Nodes[nodeIndex].firstChildIndex;
      if (firstChildIndex) {
        if (Nodes[nodeIndex].expanded) {
          Nodes[nodeIndex].expanded = false;
          nLastCollapsedNodeIndex = nodeIndex;
        }
        else {
          Nodes[nodeIndex].expanded = true;
          nLastExpandedNodeIndex = nodeIndex;
          var nodeType = Nodes[firstChildIndex].type;
          if ((nodeType == NodeTypeChoice || nodeType == NodeTypeSequence) && Nodes[firstChildIndex].firstChildIndex) {
            Nodes[firstChildIndex].expanded = true;
            nLastExpandedNodeIndex = firstChildIndex;
          }
          ExpandChoiceNodes(nLastExpandedNodeIndex);
        }
        SetVerNodePositions();
        //DrawTree();
      }
      else {
        if (nodeDetails.style.display == "none" && showNodeDetails)
          ShowNodeDetails(nodeIndex);
        else
          nodeDetails.style.display = "none";
      }
    }
    else
      nodeDetails.style.display = "none";

    DrawTree();
  }


  function ClickDetected(event)
  {
    var nodeIndex = getObjectAtCursor(canvas, event);
    NodeClicked(nodeIndex, true);
  }

  /*
  function RightClickDetected(event)
  {
    var canvas = document.getElementById("tree");
    //getCursorPosition(canvas, event);
    var nodeIndex = getObjectAtCursor(canvas, event);
		nLastClickedNodeIndex = nodeIndex;

		if (nodeIndex) {

		  nodeDetails.style.left = event.clientX + "px"; // "600px";
		  nodeDetails.style.top = event.clientY + "px";
		  nodeDetails.style.display = "block";

		}
		else
		  nodeDetails.style.display = "none";
  }

  function openModal() {
    document.getElementById('node-details').style.display = "block";
  }

  function closeModal() {
    document.getElementById('node-details').style.display = "none";
  }
  */

  function ContainerOnScroll()
  {
	  nodeDetails.style.display = "none";
  }

  /*
  function myFunction(value1,value2,value3)
  {
    var ResultObject = {};
    ResultObject["result1"] = value1 + value2;
    ResultObject["result2"] = value1 * value3;
    return ResultObject;
  }

  var ResultObject = myFunction(1,2,3);
  */

  //DrawTree();

  var elem = document.getElementById('tree');
  elem.addEventListener('click', ClickDetected);
  //elem.addEventListener('contextmenu', RightClickDetected);
  //elem.addEventListener('dblclick', RightClickDetected);

  elem = document.getElementById('canvas-container');
  elem.addEventListener('scroll', ContainerOnScroll);

  //oncontextmenu = "javascript:alert('success!');return false;"


  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Search functions


  function SearchSubTree(nodeIndex)
  {
    var matching = false;

    if (IsRealNode(Nodes[nodeIndex].type)) {
      var nodeName = Nodes[nodeIndex].name;
      if (nodeName && nodeName.toLowerCase().search(lastSearchText) >= 0)
        matching = true;
    }

    var annotation = Nodes[nodeIndex].annotation;
    if (!matching && annotation)
      if (annotation.toLowerCase().search(lastSearchText) >= 0)
        matching = true;

    if (matching) {
      if (SearchResults.length >= nMaxSearchResults)
        bTooManySearchResults = true;
      else
        SearchResults.push(nodeIndex);
    }

    var nextNodeIndex = Nodes[nodeIndex].firstChildIndex;

    while (nextNodeIndex && !bTooManySearchResults) {
      SearchSubTree(nextNodeIndex);
      nextNodeIndex = Nodes[nextNodeIndex].nextIndex;
    }
  }


  function SearchButtonPressed()
  {
    var searchResultElement;
    var nodeIndex, i;
    var bDisplayResultTable = false;

    lastSearchText = searchText.value.trim().toLowerCase();

    SearchResults = new Array();
    bTooManySearchResults = false;
    searchResultDiv.scrollTop = 0;

    if (lastSearchText.length > 2) {
      SearchSubTree(rootNodeIndex);
      bDisplayResultTable = true;
    }

    for (i = 0; i < SearchResults.length; i++) {
      searchResultElement = document.getElementById('SearchResult' + (i + 1));
      nodeIndex = SearchResults[i];
      searchResultElement.innerHTML = '' + XPath(nodeIndex).replace(/\//g, ' / ');  // + ' [' + nodeIndex + ']';
    }

    for (i = SearchResults.length; i < nMaxSearchResults; i++) {
      searchResultElement = document.getElementById('SearchResult' + (i + 1));
      searchResultElement.innerHTML = '';
    }

    if (bTooManySearchResults)
      tooManyResults.innerHTML = 'Too many results found';
    else
      tooManyResults.innerHTML = '';

    if (bDisplayResultTable) {
      if (SearchResults.length == 0)
        firstSearchResult.innerHTML = 'No results found for this search text ...';
      searchResultDiv.style.display = "block";
      searchResetButton.style.display = "inline-block";
    }
    else {
      searchResultDiv.style.display = "none";
      searchResetButton.style.display = "none";
    }

    DrawTree();
  }


  // Detect enter key pressed within search text input field
  searchText.addEventListener("keyup", function (event) {
    event.preventDefault();
    if (event.keyCode == 13)
      SearchButtonPressed();
  });


  function SetAllNodesCollapsed(nodeIndex)
  {
    Nodes[nodeIndex].expanded = false;

    var nextNodeIndex = Nodes[nodeIndex].firstChildIndex;

    while (nextNodeIndex) {
      SetAllNodesCollapsed(nextNodeIndex);
      nextNodeIndex = Nodes[nextNodeIndex].nextIndex;
    }
  }


  function SetPathExpanded(nodeIndex)
  {
    if (Nodes[nodeIndex].firstChildIndex)
      Nodes[nodeIndex].expanded = true;
    var parentIndex = Nodes[nodeIndex].parentIndex;
    if (parentIndex)
      SetPathExpanded(parentIndex);
  }


  function SearchResultClicked(index)
  {
    if (index >= 0 && index < SearchResults.length) {
      var nodeIndex = SearchResults[index];
      SetAllNodesCollapsed(rootNodeIndex);
      SetPathExpanded(nodeIndex);

      SetVerNodePositions();
      MoveNodeToCenter(nodeIndex);

      if (Nodes[nodeIndex].firstChildIndex)
        Nodes[nodeIndex].expanded = false;

      SetVerNodePositions();
      NodeClicked(nodeIndex, false);
    }
  }


  function SearchResetPressed()
  {
    searchText.value = '';
    SearchResults = new Array();
    searchResultDiv.style.display = "none";
    searchResetButton.style.display = "none";
    DrawTree();
  }

</script>

</html>
